2020-03-27 17:46:20
Text:	 SELECT   * FROM [TbRawMaterialMonthDemandSupplyPlan]  WHERE [TbRawMaterialMonthDemandSupplyPlan].[DemandPlanCode] IN (@DemandPlanCode674,@DemandPlanCode675) 	
Parameters:
@DemandPlanCode674[String] = XQJH202000003
@DemandPlanCode675[String] = XQJH202000006


-----------------------------------------------------------------------------
2020-03-27 17:46:20
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 17:46:20
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 17:46:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 17:46:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:46:22
Text:	 SELECT   [TbFactoryBatchNeedPlan].[RawMaterialDemandNum] AS [DemandPlanCode],[TbFactoryBatchNeedPlan].[BatchPlanNum],[TbFactoryBatchNeedPlan].[SteelsTypeCode] AS [RebarType],[TbFactoryBatchNeedPlan].[BatchPlanTotal] AS [TotalWeight] FROM [TbFactoryBatchNeedPlan]  WHERE (([TbFactoryBatchNeedPlan].[Examinestatus] = @Examinestatus677) AND ([TbFactoryBatchNeedPlan].[RawMaterialDemandNum] IN (@RawMaterialDemandNum678,@RawMaterialDemandNum679))) 	
Parameters:
@Examinestatus677[String] = 审核完成
@RawMaterialDemandNum678[String] = XQJH202000003
@RawMaterialDemandNum679[String] = XQJH202000006


-----------------------------------------------------------------------------
2020-03-27 17:46:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:46:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 17:46:22
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode])  WHERE ((([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode676) AND ([TbRawMaterialStockRecord].[WorkAreaCode] IN (@WorkAreaCode692))) AND ([TbRawMaterialStockRecord].[RebarType] = @RebarType693)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode676[String] = 6386683729561128960
@WorkAreaCode692[String] = 6276140381243441152
@RebarType693[String] = BuildingSteel


-----------------------------------------------------------------------------
2020-03-27 17:46:22
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode691) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode694,@SiteCode695,@SiteCode696,@SiteCode697,@SiteCode698,@SiteCode699))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus700)) 	
Parameters:
@ProcessFactoryCode691[String] = 6386683729561128960
@SiteCode694[String] = 6276140742482067456
@SiteCode695[String] = 6276141050964738048
@SiteCode696[String] = 6276141450283450368
@SiteCode697[String] = 6276141737463250944
@SiteCode698[String] = 6276141926932545536
@SiteCode699[String] = 6308426901824208896
@Examinestatus700[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 17:46:22
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode681) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode701))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus702)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode681[String] = 6386683729561128960
@WorkAreaCode701[String] = 6276140381243441152
@Examinestatus702[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 17:46:22
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE ((1=2) AND (YEAR(FinishTime)=2020)) 	


-----------------------------------------------------------------------------
2020-03-27 17:46:22
Text:	 SELECT   * FROM [TbRawMaterialMonthDemandSupplyPlan]  WHERE [TbRawMaterialMonthDemandSupplyPlan].[DemandPlanCode] IN (@DemandPlanCode703,@DemandPlanCode704) 	
Parameters:
@DemandPlanCode703[String] = XQJH202000003
@DemandPlanCode704[String] = XQJH202000006


-----------------------------------------------------------------------------
2020-03-27 17:46:22
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE ((((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode680)) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode682,@SiteCode683,@SiteCode684,@SiteCode685,@SiteCode686,@SiteCode687))) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState688,@ProcessingState689,@ProcessingState690))) 	
Parameters:
@ProcessFactoryCode680[String] = 6386683729561128960
@SiteCode682[String] = 6276140742482067456
@SiteCode683[String] = 6276141050964738048
@SiteCode684[String] = 6276141450283450368
@SiteCode685[String] = 6276141737463250944
@SiteCode686[String] = 6276141926932545536
@SiteCode687[String] = 6308426901824208896
@ProcessingState688[String] = Processing
@ProcessingState689[String] = Received
@ProcessingState690[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 17:46:23
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:46:23
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat706) 	
Parameters:
@DaetailWorkStrat706[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 17:46:23
Text:	 SELECT   [TbSupplyList].[BatchPlanTotal],[TbSupplyList].[HasSupplierTotal],[TbSupplyList].[StateCode],[TbSupplyList].[SteelsTypeCode],[TbSupplyList].[SupplyCompleteTime],[TbSupplyList].[SupplyDate] FROM [TbSupplyList]  WHERE ([TbSupplyList].[RawMaterialDemandNum] IN (@RawMaterialDemandNum707,@RawMaterialDemandNum708,@RawMaterialDemandNum709,@RawMaterialDemandNum710)) 	
Parameters:
@RawMaterialDemandNum707[String] = XQJH202000003
@RawMaterialDemandNum708[String] = XQJH202000006
@RawMaterialDemandNum709[String] = BCJH202000003
@RawMaterialDemandNum710[String] = BCJH202000006


-----------------------------------------------------------------------------
2020-03-27 17:46:23
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode])  WHERE ((([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode705) AND ([TbRawMaterialStockRecord].[WorkAreaCode] IN (@WorkAreaCode711))) AND ([TbRawMaterialStockRecord].[RebarType] = @RebarType712)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode705[String] = 6386683729561128960
@WorkAreaCode711[String] = 6276140381243441152
@RebarType712[String] = SectionSteel


-----------------------------------------------------------------------------
2020-03-27 17:46:23
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE ((1=2) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime713)))) 	
Parameters:
@DistributionTime713[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 17:47:02
Text:	select TbAll.EarlyWarningCode,TbAll.BranchCode,TbAll.BranchName,TbAll.WorkAreaCode,TbAll.WorkAreaName,TbAll.SiteCode,TbAll.SiteName,TbAll.ProjectId,TbAll.YjMonth,TbAll.MenuCode,TbAll.EWNodeCode,TbAll.EWNodeName,TbAll.PersonnelCode,TbAll.PersonnelSource,TbAll.BegEwTiemNew from (select Tb.*,case when Tb.EWTimeType='年' then DATEADD(YEAR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='月' then DATEADD(MONTH,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='天' then DATEADD(DAY,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='时' then DATEADD(HOUR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='分' then DATEADD(MINUTE,Tb.EWTime,Tb.BegEwTiem) end as BegEwTiemNew,TbYjInfo.EarlyWarningCode as YjCode from (select ewt.EarlyWarningCode,DATENAME(year,GETDATE())+'-'+ DATENAME(MONTH,GETDATE())+'-'+ CONVERT(varchar(20),ewt.EWBegDay)+' '+CONVERT(varchar(20),ewt.EWBegHour)+':'+CONVERT(varchar(20),ewt.EWBegMinute)+':00' as BegEwTiem,ewt.BranchCode,cp1.CompanyFullName as BranchName,ewt.WorkAreaCode,cp2.CompanyFullName as WorkAreaName,ewt.SiteCode,cp3.CompanyFullName as SiteName,ewt.ProjectId,MONTH(GETDATE()) as YjMonth,ewt.MenuCode,ewn.EWNodeCode,ewn.EWNodeName,ewn.EWTimeType,ewn.EWTime,ewnp.PersonnelCode,ewnp.PersonnelSource,ewnp.DeptId,ewnp.RoleId from TbFormEarlyWarningBegTime ewt 
left join TbFormEarlyWarningNode ewn on ewt.EarlyWarningCode=ewn.EarlyWarningCode and ewt.ProjectId=ewn.ProjectId and ewt.MenuCode=ewn.MenuCode
left join TbFormEarlyWarningNodePersonnel ewnp on ewn.EarlyWarningCode=ewnp.EarlyWarningCode and ewn.EWNodeCode=ewnp.EWNodeCode and  ewn.MenuCode=ewnp.MenuCode and ewn.ProjectId=ewnp.ProjectId
left join TbCompany cp1 on ewt.BranchCode=cp1.CompanyCode
left join TbCompany cp2 on ewt.WorkAreaCode=cp2.CompanyCode
left join TbCompany cp3 on ewt.SiteCode=cp3.CompanyCode
where ewt.MenuCode='RawMonthDemandPlan') Tb 
left join (select EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId from TbFormEarlyWarningNodeInfo ewni
where ewni.EWFormDataCode=MONTH(GETDATE()) group by EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId) TbYjInfo on Tb.EarlyWarningCode=TbYjInfo.EarlyWarningCode and Tb.EWNodeCode=TbYjInfo.EWNodeCode and Tb.MenuCode=TbYjInfo.MenuCode and  Tb.YjMonth=TbYjInfo.EWFormDataCode and Tb.WorkAreaCode=TbYjInfo.WorkArea and Tb.ProjectId=TbYjInfo.ProjectId
where GETDATE()>=BegEwTiem and Tb.WorkAreaCode not in(select rmdp.WorkAreaCode from TbRawMaterialMonthDemandPlan rmdp where MONTH(InsertTime)=MONTH(GETDATE())
group by rmdp.WorkAreaCode)) TbAll where TbAll.YjCode is null and TbAll.PersonnelCode is not null and GETDATE()>=TbAll.BegEwTiemNew	


-----------------------------------------------------------------------------
2020-03-27 17:48:01
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
left join TbFlowDefine d on p.FlowCode=d.FlowCode
where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
union all
select COUNT(1) as MsgCount from TbFlowPerformMessage m 
LEFT JOIN TbUser tu ON m.UserCode=tu.UserCode
where (m.usercode=@UserCode OR tu.UserId=@UserCode)and IsRead=-1
union all
select SUM(Tb.earlywarningcount) as earlywarningcount from (
select COUNT(1) as earlywarningcount from TbFlowEarlyWarningInfo where EarlyWarningBTUser=@UserCode and EarlyWarningStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)
union all
select COUNT(1) as earlywarningcount from TbFormEarlyWarningNodeInfo where EWUserCode=@UserCode and EWStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 17:51:01
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
left join TbFlowDefine d on p.FlowCode=d.FlowCode
where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
union all
select COUNT(1) as MsgCount from TbFlowPerformMessage m 
LEFT JOIN TbUser tu ON m.UserCode=tu.UserCode
where (m.usercode=@UserCode OR tu.UserId=@UserCode)and IsRead=-1
union all
select SUM(Tb.earlywarningcount) as earlywarningcount from (
select COUNT(1) as earlywarningcount from TbFlowEarlyWarningInfo where EarlyWarningBTUser=@UserCode and EarlyWarningStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)
union all
select COUNT(1) as earlywarningcount from TbFormEarlyWarningNodeInfo where EWUserCode=@UserCode and EWStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 17:52:02
Text:	select TbAll.EarlyWarningCode,TbAll.BranchCode,TbAll.BranchName,TbAll.WorkAreaCode,TbAll.WorkAreaName,TbAll.SiteCode,TbAll.SiteName,TbAll.ProjectId,TbAll.YjMonth,TbAll.MenuCode,TbAll.EWNodeCode,TbAll.EWNodeName,TbAll.PersonnelCode,TbAll.PersonnelSource,TbAll.BegEwTiemNew from (select Tb.*,case when Tb.EWTimeType='年' then DATEADD(YEAR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='月' then DATEADD(MONTH,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='天' then DATEADD(DAY,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='时' then DATEADD(HOUR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='分' then DATEADD(MINUTE,Tb.EWTime,Tb.BegEwTiem) end as BegEwTiemNew,TbYjInfo.EarlyWarningCode as YjCode from (select ewt.EarlyWarningCode,DATENAME(year,GETDATE())+'-'+ DATENAME(MONTH,GETDATE())+'-'+ CONVERT(varchar(20),ewt.EWBegDay)+' '+CONVERT(varchar(20),ewt.EWBegHour)+':'+CONVERT(varchar(20),ewt.EWBegMinute)+':00' as BegEwTiem,ewt.BranchCode,cp1.CompanyFullName as BranchName,ewt.WorkAreaCode,cp2.CompanyFullName as WorkAreaName,ewt.SiteCode,cp3.CompanyFullName as SiteName,ewt.ProjectId,MONTH(GETDATE()) as YjMonth,ewt.MenuCode,ewn.EWNodeCode,ewn.EWNodeName,ewn.EWTimeType,ewn.EWTime,ewnp.PersonnelCode,ewnp.PersonnelSource,ewnp.DeptId,ewnp.RoleId from TbFormEarlyWarningBegTime ewt 
left join TbFormEarlyWarningNode ewn on ewt.EarlyWarningCode=ewn.EarlyWarningCode and ewt.ProjectId=ewn.ProjectId and ewt.MenuCode=ewn.MenuCode
left join TbFormEarlyWarningNodePersonnel ewnp on ewn.EarlyWarningCode=ewnp.EarlyWarningCode and ewn.EWNodeCode=ewnp.EWNodeCode and  ewn.MenuCode=ewnp.MenuCode and ewn.ProjectId=ewnp.ProjectId
left join TbCompany cp1 on ewt.BranchCode=cp1.CompanyCode
left join TbCompany cp2 on ewt.WorkAreaCode=cp2.CompanyCode
left join TbCompany cp3 on ewt.SiteCode=cp3.CompanyCode
where ewt.MenuCode='RawMonthDemandPlan') Tb 
left join (select EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId from TbFormEarlyWarningNodeInfo ewni
where ewni.EWFormDataCode=MONTH(GETDATE()) group by EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId) TbYjInfo on Tb.EarlyWarningCode=TbYjInfo.EarlyWarningCode and Tb.EWNodeCode=TbYjInfo.EWNodeCode and Tb.MenuCode=TbYjInfo.MenuCode and  Tb.YjMonth=TbYjInfo.EWFormDataCode and Tb.WorkAreaCode=TbYjInfo.WorkArea and Tb.ProjectId=TbYjInfo.ProjectId
where GETDATE()>=BegEwTiem and Tb.WorkAreaCode not in(select rmdp.WorkAreaCode from TbRawMaterialMonthDemandPlan rmdp where MONTH(InsertTime)=MONTH(GETDATE())
group by rmdp.WorkAreaCode)) TbAll where TbAll.YjCode is null and TbAll.PersonnelCode is not null and GETDATE()>=TbAll.BegEwTiemNew	


-----------------------------------------------------------------------------
2020-03-27 17:54:01
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
left join TbFlowDefine d on p.FlowCode=d.FlowCode
where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
union all
select COUNT(1) as MsgCount from TbFlowPerformMessage m 
LEFT JOIN TbUser tu ON m.UserCode=tu.UserCode
where (m.usercode=@UserCode OR tu.UserId=@UserCode)and IsRead=-1
union all
select SUM(Tb.earlywarningcount) as earlywarningcount from (
select COUNT(1) as earlywarningcount from TbFlowEarlyWarningInfo where EarlyWarningBTUser=@UserCode and EarlyWarningStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)
union all
select COUNT(1) as earlywarningcount from TbFormEarlyWarningNodeInfo where EWUserCode=@UserCode and EWStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 17:54:29
Text:	select TbAll.EarlyWarningCode,TbAll.BranchCode,TbAll.BranchName,TbAll.WorkAreaCode,TbAll.WorkAreaName,TbAll.SiteCode,TbAll.SiteName,TbAll.ProjectId,TbAll.YjMonth,TbAll.MenuCode,TbAll.EWNodeCode,TbAll.EWNodeName,TbAll.PersonnelCode,TbAll.PersonnelSource,TbAll.BegEwTiemNew from (select Tb.*,case when Tb.EWTimeType='年' then DATEADD(YEAR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='月' then DATEADD(MONTH,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='天' then DATEADD(DAY,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='时' then DATEADD(HOUR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='分' then DATEADD(MINUTE,Tb.EWTime,Tb.BegEwTiem) end as BegEwTiemNew,TbYjInfo.EarlyWarningCode as YjCode from (select ewt.EarlyWarningCode,DATENAME(year,GETDATE())+'-'+ DATENAME(MONTH,GETDATE())+'-'+ CONVERT(varchar(20),ewt.EWBegDay)+' '+CONVERT(varchar(20),ewt.EWBegHour)+':'+CONVERT(varchar(20),ewt.EWBegMinute)+':00' as BegEwTiem,ewt.BranchCode,cp1.CompanyFullName as BranchName,ewt.WorkAreaCode,cp2.CompanyFullName as WorkAreaName,ewt.SiteCode,cp3.CompanyFullName as SiteName,ewt.ProjectId,MONTH(GETDATE()) as YjMonth,ewt.MenuCode,ewn.EWNodeCode,ewn.EWNodeName,ewn.EWTimeType,ewn.EWTime,ewnp.PersonnelCode,ewnp.PersonnelSource,ewnp.DeptId,ewnp.RoleId from TbFormEarlyWarningBegTime ewt 
left join TbFormEarlyWarningNode ewn on ewt.EarlyWarningCode=ewn.EarlyWarningCode and ewt.ProjectId=ewn.ProjectId and ewt.MenuCode=ewn.MenuCode
left join TbFormEarlyWarningNodePersonnel ewnp on ewn.EarlyWarningCode=ewnp.EarlyWarningCode and ewn.EWNodeCode=ewnp.EWNodeCode and  ewn.MenuCode=ewnp.MenuCode and ewn.ProjectId=ewnp.ProjectId
left join TbCompany cp1 on ewt.BranchCode=cp1.CompanyCode
left join TbCompany cp2 on ewt.WorkAreaCode=cp2.CompanyCode
left join TbCompany cp3 on ewt.SiteCode=cp3.CompanyCode
where ewt.MenuCode='RawMonthDemandPlan') Tb 
left join (select EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId from TbFormEarlyWarningNodeInfo ewni
where ewni.EWFormDataCode=MONTH(GETDATE()) group by EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId) TbYjInfo on Tb.EarlyWarningCode=TbYjInfo.EarlyWarningCode and Tb.EWNodeCode=TbYjInfo.EWNodeCode and Tb.MenuCode=TbYjInfo.MenuCode and  Tb.YjMonth=TbYjInfo.EWFormDataCode and Tb.WorkAreaCode=TbYjInfo.WorkArea and Tb.ProjectId=TbYjInfo.ProjectId
where GETDATE()>=BegEwTiem and Tb.WorkAreaCode not in(select rmdp.WorkAreaCode from TbRawMaterialMonthDemandPlan rmdp where MONTH(InsertTime)=MONTH(GETDATE())
group by rmdp.WorkAreaCode)) TbAll where TbAll.YjCode is null and TbAll.PersonnelCode is not null and GETDATE()>=TbAll.BegEwTiemNew	


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode19) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode20,@SiteCode21,@SiteCode22,@SiteCode23,@SiteCode24,@SiteCode25))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus26)) 	
Parameters:
@ProcessFactoryCode19[String] = 6386683729561128960
@SiteCode20[String] = 6276140742482067456
@SiteCode21[String] = 6276141050964738048
@SiteCode22[String] = 6276141450283450368
@SiteCode23[String] = 6276141737463250944
@SiteCode24[String] = 6276141926932545536
@SiteCode25[String] = 6308426901824208896
@Examinestatus26[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode1) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode9,@SiteCode10,@SiteCode11,@SiteCode12,@SiteCode13,@SiteCode14))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus15)) 	
Parameters:
@ProcessFactoryCode1[String] = 6386683729561128960
@SiteCode9[String] = 6276140742482067456
@SiteCode10[String] = 6276141050964738048
@SiteCode11[String] = 6276141450283450368
@SiteCode12[String] = 6276141737463250944
@SiteCode13[String] = 6276141926932545536
@SiteCode14[String] = 6308426901824208896
@Examinestatus15[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE ((1=2) AND (YEAR(FinishTime)=2020)) 	


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE ((1=2) AND (YEAR(FinishTime)=2020)) 	


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE ((((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode2)) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode3,@SiteCode4,@SiteCode5,@SiteCode6,@SiteCode7,@SiteCode8))) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState16,@ProcessingState17,@ProcessingState18))) 	
Parameters:
@ProcessFactoryCode2[String] = 6386683729561128960
@SiteCode3[String] = 6276140742482067456
@SiteCode4[String] = 6276141050964738048
@SiteCode5[String] = 6276141450283450368
@SiteCode6[String] = 6276141737463250944
@SiteCode7[String] = 6276141926932545536
@SiteCode8[String] = 6308426901824208896
@ProcessingState16[String] = Processing
@ProcessingState17[String] = Received
@ProcessingState18[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat27) 	
Parameters:
@DaetailWorkStrat27[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE ((1=2) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime28)))) 	
Parameters:
@DistributionTime28[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   [TbOrderProgress].[ProcessingState],[TbOrderProgress].[FinishProcessingDateTime],[TbOrderProgress].[DistributionTime],[TbOrderProgress].[SiteCode] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[SiteCode] IN (@SiteCode30,@SiteCode31,@SiteCode32,@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50,@SiteCode51,@SiteCode52,@SiteCode53,@SiteCode54,@SiteCode55,@SiteCode56,@SiteCode57,@SiteCode58,@SiteCode59,@SiteCode60,@SiteCode61,@SiteCode62,@SiteCode63,@SiteCode64,@SiteCode65,@SiteCode66,@SiteCode67,@SiteCode68,@SiteCode69,@SiteCode70,@SiteCode71,@SiteCode72,@SiteCode73,@SiteCode74,@SiteCode75,@SiteCode76,@SiteCode77,@SiteCode78,@SiteCode79,@SiteCode80,@SiteCode81,@SiteCode82,@SiteCode83,@SiteCode84,@SiteCode85,@SiteCode86,@SiteCode87,@SiteCode88,@SiteCode89,@SiteCode90,@SiteCode91,@SiteCode92,@SiteCode93,@SiteCode94,@SiteCode95,@SiteCode96,@SiteCode97,@SiteCode98,@SiteCode99,@SiteCode100)) AND (YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=3)) 	
Parameters:
@SiteCode30[String] = 6274027775095472128
@SiteCode31[String] = 6274027929433276416
@SiteCode32[String] = 6417410523612188672
@SiteCode33[String] = 6274028333340557312
@SiteCode34[String] = 6274028829845487616
@SiteCode35[String] = 6274029086029381632
@SiteCode36[String] = 6274029528142577664
@SiteCode37[String] = 6274029966388625408
@SiteCode38[String] = 6274030152053686272
@SiteCode39[String] = 6274030373047369728
@SiteCode40[String] = 6274030913332445184
@SiteCode41[String] = 6267789807737372672
@SiteCode42[String] = 6267790255894560768
@SiteCode43[String] = 6267790460492709888
@SiteCode44[String] = 6267790574804271104
@SiteCode45[String] = 6267791036517449728
@SiteCode46[String] = 6267791338536697856
@SiteCode47[String] = 6267791654132908032
@SiteCode48[String] = 6267790081113718784
@SiteCode49[String] = 6267790783294734336
@SiteCode50[String] = 6267791210027417600
@SiteCode51[String] = 6267791528110850048
@SiteCode52[String] = 6437059801301262336
@SiteCode53[String] = 6308426901824208896
@SiteCode54[String] = 6276140742482067456
@SiteCode55[String] = 6276141050964738048
@SiteCode56[String] = 6276141450283450368
@SiteCode57[String] = 6276141737463250944
@SiteCode58[String] = 6276141926932545536
@SiteCode59[String] = 6267796592825204736
@SiteCode60[String] = 6267796864196673536
@SiteCode61[String] = 6267797037211713536
@SiteCode62[String] = 6267797181319610368
@SiteCode63[String] = 6276760608893304832
@SiteCode64[String] = 6267798187931598848
@SiteCode65[String] = 6267798388054425600
@SiteCode66[String] = 6267749616851091456
@SiteCode67[String] = 6267750471750909952
@SiteCode68[String] = 6267750709144322048
@SiteCode69[String] = 6267750895786655744
@SiteCode70[String] = 6267751010588950528
@SiteCode71[String] = 6267753037104676864
@SiteCode72[String] = 6267754200801738752
@SiteCode73[String] = 6267754324688896000
@SiteCode74[String] = 6267797518566817792
@SiteCode75[String] = 6267783175129268224
@SiteCode76[String] = 6267783320914886656
@SiteCode77[String] = 6267783444885929984
@SiteCode78[String] = 6267783577954418688
@SiteCode79[String] = 6267784612617912320
@SiteCode80[String] = 6267785016667799552
@SiteCode81[String] = 6267785185136214016
@SiteCode82[String] = 6267785381991677952
@SiteCode83[String] = 6267785590951903232
@SiteCode84[String] = 6267785762842869760
@SiteCode85[String] = 6267793585479876608
@SiteCode86[String] = 6267793380881727488
@SiteCode87[String] = 6437060915425845248
@SiteCode88[String] = 6284878460246556672
@SiteCode89[String] = 6284879065547538432
@SiteCode90[String] = 6285119541664022528
@SiteCode91[String] = 6285120302351384576
@SiteCode92[String] = 6285181647230861312
@SiteCode93[String] = 6285120520983674880
@SiteCode94[String] = 6285120866493661184
@SiteCode95[String] = 6285121357168508928
@SiteCode96[String] = 6285122203776188416
@SiteCode97[String] = 6437059163368595456
@SiteCode98[String] = 6374383547544903680
@SiteCode99[String] = 6374384032955899904
@SiteCode100[String] = 6374384202665828352


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode101) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode102))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus103)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode101[String] = 6386683729561128960
@WorkAreaCode102[String] = 6276140381243441152
@Examinestatus103[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   * FROM [TbRawMaterialMonthDemandSupplyPlan]  WHERE [TbRawMaterialMonthDemandSupplyPlan].[DemandPlanCode] IN (@DemandPlanCode104,@DemandPlanCode105) 	
Parameters:
@DemandPlanCode104[String] = XQJH202000003
@DemandPlanCode105[String] = XQJH202000006


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   [TbFactoryBatchNeedPlan].[RawMaterialDemandNum] AS [DemandPlanCode],[TbFactoryBatchNeedPlan].[BatchPlanNum],[TbFactoryBatchNeedPlan].[SteelsTypeCode] AS [RebarType],[TbFactoryBatchNeedPlan].[BatchPlanTotal] AS [TotalWeight] FROM [TbFactoryBatchNeedPlan]  WHERE (([TbFactoryBatchNeedPlan].[Examinestatus] = @Examinestatus106) AND ([TbFactoryBatchNeedPlan].[RawMaterialDemandNum] IN (@RawMaterialDemandNum107,@RawMaterialDemandNum108,@RawMaterialDemandNum109,@RawMaterialDemandNum110))) 	
Parameters:
@Examinestatus106[String] = 审核完成
@RawMaterialDemandNum107[String] = XQJH202000003
@RawMaterialDemandNum108[String] = XQJH202000006
@RawMaterialDemandNum109[String] = BCJH202000003
@RawMaterialDemandNum110[String] = BCJH202000006


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   [TbSupplyList].[SteelsTypeCode] AS [RebarType],[TbSupplyList].[HasSupplierTotal] AS [TotalWeight] FROM [TbSupplyList]  WHERE (([TbSupplyList].[StateCode] <> @StateCode29) AND ([TbSupplyList].[BatchPlanNum] IN (@BatchPlanNum111,@BatchPlanNum112,@BatchPlanNum113))) 	
Parameters:
@StateCode29[String] = 未供货
@BatchPlanNum111[String] = PCJH202000004
@BatchPlanNum112[String] = PCJH202000006
@BatchPlanNum113[String] = PCJH202000007


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode116) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode120))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus121)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode116[String] = 6386683729561128960
@WorkAreaCode120[String] = 6276140381243441152
@Examinestatus121[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode118) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode132))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus133)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode118[String] = 6386683729561128960
@WorkAreaCode132[String] = 6276140381243441152
@Examinestatus133[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   * FROM [TbRawMaterialMonthDemandSupplyPlan]  WHERE [TbRawMaterialMonthDemandSupplyPlan].[DemandPlanCode] IN (@DemandPlanCode134,@DemandPlanCode135) 	
Parameters:
@DemandPlanCode134[String] = XQJH202000003
@DemandPlanCode135[String] = XQJH202000006


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode131) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode136,@SiteCode137,@SiteCode138,@SiteCode139,@SiteCode140,@SiteCode141))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus142)) 	
Parameters:
@ProcessFactoryCode131[String] = 6386683729561128960
@SiteCode136[String] = 6276140742482067456
@SiteCode137[String] = 6276141050964738048
@SiteCode138[String] = 6276141450283450368
@SiteCode139[String] = 6276141737463250944
@SiteCode140[String] = 6276141926932545536
@SiteCode141[String] = 6308426901824208896
@Examinestatus142[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE ((([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode114) AND ([TbRawMaterialStockRecord].[WorkAreaCode] IN (@WorkAreaCode117))) AND ([TbRawMaterialArchives].[RebarType] = @RebarType119)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode114[String] = 6386683729561128960
@WorkAreaCode117[String] = 6276140381243441152
@RebarType119[String] = BuildingSteel


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   [TbFactoryBatchNeedPlan].[RawMaterialDemandNum] AS [DemandPlanCode],[TbFactoryBatchNeedPlan].[BatchPlanNum],[TbFactoryBatchNeedPlan].[SteelsTypeCode] AS [RebarType],[TbFactoryBatchNeedPlan].[BatchPlanTotal] AS [TotalWeight] FROM [TbFactoryBatchNeedPlan]  WHERE (([TbFactoryBatchNeedPlan].[Examinestatus] = @Examinestatus145) AND ([TbFactoryBatchNeedPlan].[RawMaterialDemandNum] IN (@RawMaterialDemandNum146,@RawMaterialDemandNum147))) 	
Parameters:
@Examinestatus145[String] = 审核完成
@RawMaterialDemandNum146[String] = XQJH202000003
@RawMaterialDemandNum147[String] = XQJH202000006


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE ((1=2) AND (YEAR(FinishTime)=2020)) 	


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE ((((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode115)) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode122,@SiteCode123,@SiteCode124,@SiteCode125,@SiteCode126,@SiteCode127))) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState128,@ProcessingState129,@ProcessingState130))) 	
Parameters:
@ProcessFactoryCode115[String] = 6386683729561128960
@SiteCode122[String] = 6276140742482067456
@SiteCode123[String] = 6276141050964738048
@SiteCode124[String] = 6276141450283450368
@SiteCode125[String] = 6276141737463250944
@SiteCode126[String] = 6276141926932545536
@SiteCode127[String] = 6308426901824208896
@ProcessingState128[String] = Processing
@ProcessingState129[String] = Received
@ProcessingState130[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   * FROM [TbRawMaterialMonthDemandSupplyPlan]  WHERE [TbRawMaterialMonthDemandSupplyPlan].[DemandPlanCode] IN (@DemandPlanCode143,@DemandPlanCode144) 	
Parameters:
@DemandPlanCode143[String] = XQJH202000003
@DemandPlanCode144[String] = XQJH202000006


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat148) 	
Parameters:
@DaetailWorkStrat148[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   [TbSupplyList].[BatchPlanTotal],[TbSupplyList].[HasSupplierTotal],[TbSupplyList].[StateCode],[TbSupplyList].[SteelsTypeCode],[TbSupplyList].[SupplyCompleteTime],[TbSupplyList].[SupplyDate] FROM [TbSupplyList]  WHERE ([TbSupplyList].[RawMaterialDemandNum] IN (@RawMaterialDemandNum149,@RawMaterialDemandNum150,@RawMaterialDemandNum151,@RawMaterialDemandNum152)) 	
Parameters:
@RawMaterialDemandNum149[String] = XQJH202000003
@RawMaterialDemandNum150[String] = XQJH202000006
@RawMaterialDemandNum151[String] = BCJH202000003
@RawMaterialDemandNum152[String] = BCJH202000006


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE ((1=2) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime154)))) 	
Parameters:
@DistributionTime154[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 17:54:30
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE ((([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode153) AND ([TbRawMaterialStockRecord].[WorkAreaCode] IN (@WorkAreaCode155))) AND ([TbRawMaterialArchives].[RebarType] = @RebarType156)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode153[String] = 6386683729561128960
@WorkAreaCode155[String] = 6276140381243441152
@RebarType156[String] = SectionSteel


-----------------------------------------------------------------------------
2020-03-27 17:57:02
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
left join TbFlowDefine d on p.FlowCode=d.FlowCode
where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
union all
select COUNT(1) as MsgCount from TbFlowPerformMessage m 
LEFT JOIN TbUser tu ON m.UserCode=tu.UserCode
where (m.usercode=@UserCode OR tu.UserId=@UserCode)and IsRead=-1
union all
select SUM(Tb.earlywarningcount) as earlywarningcount from (
select COUNT(1) as earlywarningcount from TbFlowEarlyWarningInfo where EarlyWarningBTUser=@UserCode and EarlyWarningStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)
union all
select COUNT(1) as earlywarningcount from TbFormEarlyWarningNodeInfo where EWUserCode=@UserCode and EWStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 17:58:38
Text:	SELECT MaterialName FROM TbRawMaterialArchives
                                GROUP BY MaterialName	


-----------------------------------------------------------------------------
2020-03-27 17:58:38
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6337324142387400704','6352967650544590848')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 102787
@menuURI[String] = /RawMaterial/FactoryBatchNeedPlan/Index


-----------------------------------------------------------------------------
2020-03-27 17:58:38
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  and T.OrgType!=5 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 17:58:38
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 and T.OrgType!=5 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 17:58:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:58:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 17:58:38
Text:	select TbStateCode.StateCode,isnull(Tb.StateCount,0) as StateCount,isnull(Tb.BatchPlanTotal,0) as BatchPlanTotal from (select '未供货' as StateCode
                            union all
                            select '超期未供货' as StateCode
                            union all
                            select '供货不足' as StateCode
                            union all
                            select '供货完成' as StateCode
                            union all
                            select '供货过多' as StateCode) TbStateCode
                            left join (select TbGh.StateCode,Count(1) as StateCount,isnull(sum(TbGh.BatchPlanTotal),0) as BatchPlanTotal from (select a.BatchPlanNum,a.BatchPlanTotal,DATEADD(DAY,4,A.InsertTime) as SupplyDate,isnull(b.HasSupplierTotal,0) as HasSupplierTotal,b.SupplyCompleteTime,'未供货' as StateCode from TbFactoryBatchNeedPlan a
                            left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum
                            where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688') and a.SteelsTypeCode='BuildingSteel' and CONVERT(varchar(100),GETDATE(),23)<=CONVERT(varchar(100), DATEADD(DAY,4,A.InsertTime), 23) and b.SupplyCompleteTime is null and ISNULL(b.HasSupplierTotal,0)=0
                            union all
                            select a.BatchPlanNum,a.BatchPlanTotal,DATEADD(DAY,4,A.InsertTime) as SupplyDate,isnull(b.HasSupplierTotal,0) as HasSupplierTotal,b.SupplyCompleteTime,'超期未供货' as StateCode from TbFactoryBatchNeedPlan a
                            left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum
                            where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688') and a.SteelsTypeCode='BuildingSteel' and CONVERT(varchar(100),GETDATE(),23)>CONVERT(varchar(100), DATEADD(DAY,4,A.InsertTime), 23) and b.SupplyCompleteTime is null and ISNULL(b.HasSupplierTotal,0)=0
                            union all
                            select a.BatchPlanNum,a.BatchPlanTotal,DATEADD(DAY,4,A.InsertTime) as SupplyDate,isnull(b.HasSupplierTotal,0) as HasSupplierTotal,b.SupplyCompleteTime,'供货不足' as StateCode from TbFactoryBatchNeedPlan a
                            left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum
                            where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688') and a.SteelsTypeCode='BuildingSteel' and ISNULL(b.HasSupplierTotal,0)>0 and b.StateCode='部分供货'
                            union all
                            select a.BatchPlanNum,a.BatchPlanTotal,DATEADD(DAY,4,A.InsertTime) as SupplyDate,isnull(b.HasSupplierTotal,0) as HasSupplierTotal,b.SupplyCompleteTime,'供货过多' as StateCode from TbFactoryBatchNeedPlan a
                            left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum
                            where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688') and a.SteelsTypeCode='BuildingSteel' and ISNULL(b.HasSupplierTotal,0)>0 and b.StateCode='已供货' and b.BatchPlanTotal+(Isnull(b.BatchPlanTotal,0)*0.05)<b.HasSupplierTotal
                            union all
                            select a.BatchPlanNum,a.BatchPlanTotal,DATEADD(DAY,4,A.InsertTime) as SupplyDate,isnull(b.HasSupplierTotal,0) as HasSupplierTotal,b.SupplyCompleteTime,'供货完成' as StateCode from TbFactoryBatchNeedPlan a
                            left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum
                            where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688') and a.SteelsTypeCode='BuildingSteel' and ISNULL(b.HasSupplierTotal,0)>0 and b.StateCode='已供货' and b.BatchPlanTotal+(Isnull(b.BatchPlanTotal,0)*0.05)>=b.HasSupplierTotal
                            ) TbGh group by TbGh.StateCode) Tb on TbStateCode.StateCode=Tb.StateCode	


-----------------------------------------------------------------------------
2020-03-27 17:58:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:58:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:58:38
Text:	select 
                               a.*,b.CompanyFullName BranchName,
                               c.CompanyFullName SiteName,d.CompanyFullName ProcessFactoryName,f.CompanyFullName as WorkAreaName,
                               e.UserName AcceptorName,g.DictionaryText RebarTypeNew,
                               h.UserName,ISNULL(i.StateCode,'未供货') as StateCode,i.ID as SupId,
                               ISNULL(i.SupplyDate, DATEADD(DAY,4,A.InsertTime)) as SupplyDate,isnull(i.HasSupplierTotal,0) as HasSupplierTotal,i.SupplyCompleteTime,case when j.DemandPlanCode is null then a.RawMaterialDemandNum else j.DemandPlanCode end DemandPlanCode,k.NoPassTotal,r.QyBhgCount,ghrk.BatchPlanNum as IsAdd,TbGhHg.PassCount
                               from TbFactoryBatchNeedPlan a
                               left join TbCompany b on a.BranchCode = b.CompanyCode 
                               left join TbCompany c on a.SiteCode=c.CompanyCode 
                               left join TbCompany d on a.ProcessFactoryCode=d.CompanyCode 
                               left join TbCompany f on a.WorkAreaCode=f.CompanyCode 
                               left join TbUser e on a.Acceptor=e.UserCode  
                               left join TbSysDictionaryData g on a.SteelsTypeCode=g.DictionaryCode and g.FDictionaryCode='RebarType' 
                               left join TbUser h on a.InsertUserCode=h.UserCode
                               LEFT JOIN TbSupplyList i ON a.BatchPlanNum=i.BatchPlanNum
							   left join TbRawMaterialMonthDemandSupplyPlan j on a.RawMaterialDemandNum=j.SupplyPlanCode
							   left join (select BatchPlanCode,sum(NoPassTotal) as NoPassTotal from TbInOrder group by BatchPlanCode) k on  a.BatchPlanNum=k.BatchPlanCode
                               left join (select io.BatchPlanCode,sum(ioi.PassCount) as QyBhgCount from TbSampleOrder  so
                               left join TbSampleOrderItem soi on so.SampleOrderCode=soi.SampleOrderCode
                               left join TbInOrderItem ioi on soi.InOrderItemId=ioi.ID
                               left join TbInOrder io on so.InOrderCode=io.InOrderCode
                               where (so.ChackResult=2 or so.ChackResult=3) and soi.ChackState=2
                               group by io.BatchPlanCode) r on a.BatchPlanNum=r.BatchPlanCode 
							   left join(select a.BatchPlanNum from TbSupplyListDetailHistory a
							   left join TbInOrderItem b on a.BatchPlanItemNewCode=b.BatchPlanItemNewCode where b.BatchPlanItemNewCode is null group by a.BatchPlanNum) ghrk on a.BatchPlanNum=ghrk.BatchPlanNum
							   left join(select TbGhHg.BatchPlanCode,sum(TbGhHg.PassCount) as PassCount from (select a.BatchPlanCode,case when c.ChackState=2 then 0 else b.PassCount end PassCount from TbInOrder a
                               left join TbInOrderItem b on a.InOrderCode=b.InOrderCode
                               left join TbSampleOrderItem c on b.ID=c.InOrderItemId) TbGhHg  group by TbGhHg.BatchPlanCode) TbGhHg on a.BatchPlanNum=TbGhHg.BatchPlanCode
							   where 1=1  and a.ProcessFactoryCode='6386683729561128960' and a.ProjectId='6245721945602523136' and (a.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') or a.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688'))	


-----------------------------------------------------------------------------
2020-03-27 17:58:38
Text:	select isnull(a.BatchPlanTotal,0) as Pcl,isnull(b.HasSupplierTotal,0) as Ygh,isnull(a.BatchPlanTotal,0) as Wgh,'未供货' as GhType from TbFactoryBatchNeedPlan a
                           left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum
                           where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688') and a.SteelsTypeCode='BuildingSteel' and CONVERT(varchar(100),GETDATE(),23)<=CONVERT(varchar(100), DATEADD(DAY,4,A.InsertTime), 23) and b.SupplyCompleteTime is null and ISNULL(b.HasSupplierTotal,0)=0
                           union all
                           select isnull(a.BatchPlanTotal,0) as Pcl,isnull(b.HasSupplierTotal,0) as Ygh,isnull(a.BatchPlanTotal,0) as Wgh,'超期未供货' as GhType from TbFactoryBatchNeedPlan a
                           left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum
                           where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688') and a.SteelsTypeCode='BuildingSteel' and CONVERT(varchar(100),GETDATE(),23)>CONVERT(varchar(100), DATEADD(DAY,4,A.InsertTime), 23) and b.SupplyCompleteTime is null and ISNULL(b.HasSupplierTotal,0)=0
                           union all
                           select isnull(b.BatchPlanTotal,0) as Pcl,isnull(b.HasSupplierTotal,0) as Ygh,0 as Wgh,'按时供货' as GhType from TbFactoryBatchNeedPlan a 
                           left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688') and a.SteelsTypeCode='BuildingSteel' and b.StateCode='已供货' and CONVERT(varchar(100), b.SupplyCompleteTime, 23)<=CONVERT(varchar(100), b.SupplyDate, 23) 
                           union all
                           select isnull(b.BatchPlanTotal,0) as Pcl,isnull(b.HasSupplierTotal,0) as Ygh,0 as Wgh,'超时供货' as GhType from TbFactoryBatchNeedPlan a 
                           left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688') and a.SteelsTypeCode='BuildingSteel' and b.StateCode='已供货' and CONVERT(varchar(100), b.SupplyCompleteTime, 23)>CONVERT(varchar(100), b.SupplyDate, 23) 
                           union all
                           select sum(Tb.BatchPlanQuantity) Pcl,sum(Tb.HasSupplier) as Ygh,Sum(Tb.Wghl) as Wgh,Tb.GhType from (select Tb.BatchPlanNum,sud.BatchPlanQuantity,sud.HasSupplier,case when (isnull(sud.BatchPlanQuantity,0)-isnull(sud.HasSupplier,0))<0 then 0 when (isnull(sud.BatchPlanQuantity,0)-isnull(sud.HasSupplier,0))>0 then (isnull(sud.BatchPlanQuantity,0)-isnull(sud.HasSupplier,0)) end Wghl,Tb.SupplyDate,Tb.SupplyCompleteTime,Tb.GhType from (
                           select b.BatchPlanNum,b.BatchPlanTotal,b.HasSupplierTotal,b.StateCode,b.SupplyDate,b.SupplyCompleteTime,'超时部分供货' as GhType from TbFactoryBatchNeedPlan a
                           left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688') and a.SteelsTypeCode='BuildingSteel' and b.StateCode='部分供货' and CONVERT(varchar(100), b.SupplyDate, 23)<= CONVERT(varchar(100), GETDATE(), 23) 
                           union all
                           select b.BatchPlanNum,b.BatchPlanTotal,b.HasSupplierTotal,b.StateCode,b.SupplyDate,b.SupplyCompleteTime,'按时部分供货' as GhType from TbFactoryBatchNeedPlan a
                           left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688') and a.SteelsTypeCode='BuildingSteel' and b.StateCode='部分供货' and CONVERT(varchar(100), b.SupplyDate, 23)>CONVERT(varchar(100), GETDATE(), 23) ) Tb
                           left join TbSupplyListDetail sud on Tb.BatchPlanNum=sud.BatchPlanNum) Tb group by Tb.GhType	


-----------------------------------------------------------------------------
2020-03-27 17:58:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:58:39
Text:	select Tb.GhType,sum(Tb.GhWeight) as GhWeight,sum(tb.GhCount) as GhCount from (select TbGhType.GhType,isnull(TbGhInfo.HasSupplier,0) as GhWeight,isnull(TbGhInfo.GhCount,0) as GhCount from (select '供货' as GhType
                            union all
                            select '验收不合格' as GhType
                            union all
                            select '检测不合格' as GhType) TbGhType
                            left join(
                            --供货次数、总量
                            select isnull(sum(Tb.HasSupplier),0) as HasSupplier,isnull(sum(Tb.GhCount),0) as GhCount,'供货' as GhType from (select a.HasSupplier,isnull(b.GhCount,0) as GhCount from (select a.BatchPlanNum,sum(a.HasSupplier) as HasSupplier from TbSupplyListDetail a 
                            left join TbSupplyList s on a.BatchPlanNum=s.BatchPlanNum where 1=1  and s.ProjectId='6245721945602523136' and s.ProcessFactoryCode='6386683729561128960' and s.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688') and s.SteelsTypeCode='BuildingSteel'
                            GROUP BY a.BatchPlanNum) a
                            left join(select Tb.BatchPlanNum,count(1) as GhCount from (select BatchPlanNum,ThisTime from TbSupplyListDetailHistory
                            group by BatchPlanNum,ThisTime) Tb group by Tb.BatchPlanNum) b on a.BatchPlanNum=b.BatchPlanNum) Tb 
                            union all
                            --验收不合格次数、验收不合格重量
                            select sum(TbSum.NoPass) as NoPass,sum(TbSum.YsNoPassCount) as YsNoPassCount,'验收不合格' as GhType from (select count(1) as YsNoPassCount,sum(Tb.NoPass) as NoPass from (select b.BatchPlanCode,c.ThisTime,sum(a.NoPass) as NoPass from TbInOrderItem a
                            left join TbInOrder b on a.InOrderCode=b.InOrderCode
                            left join TbSupplyList s on b.BatchPlanCode=s.BatchPlanNum
                            left join TbSupplyListDetailHistory c on a.BatchPlanItemNewCode=c.BatchPlanItemNewCode
                            where 1=1  and s.ProjectId='6245721945602523136' and s.ProcessFactoryCode='6386683729561128960' and s.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688') and s.SteelsTypeCode='BuildingSteel' and a.BatchPlanItemNewCode is not null and a.NoPass>0 
                            group by b.BatchPlanCode,c.ThisTime) Tb group by Tb.BatchPlanCode) TbSum
                            union all
                            --检测不合格次数、重量
                            select isnull(sum(Tb.JcNoPass),0) as JcNoPass,count(1) as JcNoPassCount,'检测不合格' as GhType from (select b.BatchPlanCode,d.ThisTime,Isnull(sum(c.PassCount),0) as JcNoPass from TbSampleOrderItem a
                            left join TbSampleOrder e on a.SampleOrderCode=e.SampleOrderCode
                            left join TbInOrderItem c on a.InOrderItemId=c.ID
                            left join TbSupplyListDetailHistory d on c.BatchPlanItemNewCode=d.BatchPlanItemNewCode
                            left join TbInOrder b on c.InOrderCode=b.InOrderCode
                            left join TbSupplyList s on b.BatchPlanCode=s.BatchPlanNum
                            where 1=1  and s.ProjectId='6245721945602523136' and s.ProcessFactoryCode='6386683729561128960' and s.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688') and s.SteelsTypeCode='BuildingSteel'  and a.ChackState=2 and c.BatchPlanItemNewCode is not null
                            group by b.BatchPlanCode,d.ThisTime) Tb group by Tb.BatchPlanCode) TbGhInfo on TbGhType.GhType=TbGhInfo.GhType) Tb group by Tb.GhType	


-----------------------------------------------------------------------------
2020-03-27 17:58:39
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by BatchPlanNum desc)AS Row, * from (select 
                               a.*,b.CompanyFullName BranchName,
                               c.CompanyFullName SiteName,d.CompanyFullName ProcessFactoryName,f.CompanyFullName as WorkAreaName,
                               e.UserName AcceptorName,g.DictionaryText RebarTypeNew,
                               h.UserName,ISNULL(i.StateCode,'未供货') as StateCode,i.ID as SupId,
                               ISNULL(i.SupplyDate, DATEADD(DAY,4,A.InsertTime)) as SupplyDate,isnull(i.HasSupplierTotal,0) as HasSupplierTotal,i.SupplyCompleteTime,case when j.DemandPlanCode is null then a.RawMaterialDemandNum else j.DemandPlanCode end DemandPlanCode,k.NoPassTotal,r.QyBhgCount,ghrk.BatchPlanNum as IsAdd,TbGhHg.PassCount
                               from TbFactoryBatchNeedPlan a
                               left join TbCompany b on a.BranchCode = b.CompanyCode 
                               left join TbCompany c on a.SiteCode=c.CompanyCode 
                               left join TbCompany d on a.ProcessFactoryCode=d.CompanyCode 
                               left join TbCompany f on a.WorkAreaCode=f.CompanyCode 
                               left join TbUser e on a.Acceptor=e.UserCode  
                               left join TbSysDictionaryData g on a.SteelsTypeCode=g.DictionaryCode and g.FDictionaryCode='RebarType' 
                               left join TbUser h on a.InsertUserCode=h.UserCode
                               LEFT JOIN TbSupplyList i ON a.BatchPlanNum=i.BatchPlanNum
							   left join TbRawMaterialMonthDemandSupplyPlan j on a.RawMaterialDemandNum=j.SupplyPlanCode
							   left join (select BatchPlanCode,sum(NoPassTotal) as NoPassTotal from TbInOrder group by BatchPlanCode) k on  a.BatchPlanNum=k.BatchPlanCode
                               left join (select io.BatchPlanCode,sum(ioi.PassCount) as QyBhgCount from TbSampleOrder  so
                               left join TbSampleOrderItem soi on so.SampleOrderCode=soi.SampleOrderCode
                               left join TbInOrderItem ioi on soi.InOrderItemId=ioi.ID
                               left join TbInOrder io on so.InOrderCode=io.InOrderCode
                               where (so.ChackResult=2 or so.ChackResult=3) and soi.ChackState=2
                               group by io.BatchPlanCode) r on a.BatchPlanNum=r.BatchPlanCode 
							   left join(select a.BatchPlanNum from TbSupplyListDetailHistory a
							   left join TbInOrderItem b on a.BatchPlanItemNewCode=b.BatchPlanItemNewCode where b.BatchPlanItemNewCode is null group by a.BatchPlanNum) ghrk on a.BatchPlanNum=ghrk.BatchPlanNum
							   left join(select TbGhHg.BatchPlanCode,sum(TbGhHg.PassCount) as PassCount from (select a.BatchPlanCode,case when c.ChackState=2 then 0 else b.PassCount end PassCount from TbInOrder a
                               left join TbInOrderItem b on a.InOrderCode=b.InOrderCode
                               left join TbSampleOrderItem c on b.ID=c.InOrderItemId) TbGhHg  group by TbGhHg.BatchPlanCode) TbGhHg on a.BatchPlanNum=TbGhHg.BatchPlanCode
							   where 1=1  and a.ProcessFactoryCode='6386683729561128960' and a.ProjectId='6245721945602523136' and (a.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') or a.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688'))) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-03-27 17:58:41
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025587078070272
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 17:58:41
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025587078070272
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:58:41
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025587078070272
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:58:41
Text:	select TbStateCode.StateCode,isnull(Tb.StateCount,0) as StateCount,isnull(Tb.BatchPlanTotal,0) as BatchPlanTotal from (select '未供货' as StateCode
                            union all
                            select '超期未供货' as StateCode
                            union all
                            select '供货不足' as StateCode
                            union all
                            select '供货完成' as StateCode
                            union all
                            select '供货过多' as StateCode) TbStateCode
                            left join (select TbGh.StateCode,Count(1) as StateCount,isnull(sum(TbGh.BatchPlanTotal),0) as BatchPlanTotal from (select a.BatchPlanNum,a.BatchPlanTotal,DATEADD(DAY,4,A.InsertTime) as SupplyDate,isnull(b.HasSupplierTotal,0) as HasSupplierTotal,b.SupplyCompleteTime,'未供货' as StateCode from TbFactoryBatchNeedPlan a
                            left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum
                            where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6274025879437836288','6274026095054422016') and a.SteelsTypeCode='BuildingSteel' and CONVERT(varchar(100),GETDATE(),23)<=CONVERT(varchar(100), DATEADD(DAY,4,A.InsertTime), 23) and b.SupplyCompleteTime is null and ISNULL(b.HasSupplierTotal,0)=0
                            union all
                            select a.BatchPlanNum,a.BatchPlanTotal,DATEADD(DAY,4,A.InsertTime) as SupplyDate,isnull(b.HasSupplierTotal,0) as HasSupplierTotal,b.SupplyCompleteTime,'超期未供货' as StateCode from TbFactoryBatchNeedPlan a
                            left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum
                            where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6274025879437836288','6274026095054422016') and a.SteelsTypeCode='BuildingSteel' and CONVERT(varchar(100),GETDATE(),23)>CONVERT(varchar(100), DATEADD(DAY,4,A.InsertTime), 23) and b.SupplyCompleteTime is null and ISNULL(b.HasSupplierTotal,0)=0
                            union all
                            select a.BatchPlanNum,a.BatchPlanTotal,DATEADD(DAY,4,A.InsertTime) as SupplyDate,isnull(b.HasSupplierTotal,0) as HasSupplierTotal,b.SupplyCompleteTime,'供货不足' as StateCode from TbFactoryBatchNeedPlan a
                            left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum
                            where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6274025879437836288','6274026095054422016') and a.SteelsTypeCode='BuildingSteel' and ISNULL(b.HasSupplierTotal,0)>0 and b.StateCode='部分供货'
                            union all
                            select a.BatchPlanNum,a.BatchPlanTotal,DATEADD(DAY,4,A.InsertTime) as SupplyDate,isnull(b.HasSupplierTotal,0) as HasSupplierTotal,b.SupplyCompleteTime,'供货过多' as StateCode from TbFactoryBatchNeedPlan a
                            left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum
                            where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6274025879437836288','6274026095054422016') and a.SteelsTypeCode='BuildingSteel' and ISNULL(b.HasSupplierTotal,0)>0 and b.StateCode='已供货' and b.BatchPlanTotal+(Isnull(b.BatchPlanTotal,0)*0.05)<b.HasSupplierTotal
                            union all
                            select a.BatchPlanNum,a.BatchPlanTotal,DATEADD(DAY,4,A.InsertTime) as SupplyDate,isnull(b.HasSupplierTotal,0) as HasSupplierTotal,b.SupplyCompleteTime,'供货完成' as StateCode from TbFactoryBatchNeedPlan a
                            left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum
                            where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6274025879437836288','6274026095054422016') and a.SteelsTypeCode='BuildingSteel' and ISNULL(b.HasSupplierTotal,0)>0 and b.StateCode='已供货' and b.BatchPlanTotal+(Isnull(b.BatchPlanTotal,0)*0.05)>=b.HasSupplierTotal
                            ) TbGh group by TbGh.StateCode) Tb on TbStateCode.StateCode=Tb.StateCode	


-----------------------------------------------------------------------------
2020-03-27 17:58:41
Text:	select 
                               a.*,b.CompanyFullName BranchName,
                               c.CompanyFullName SiteName,d.CompanyFullName ProcessFactoryName,f.CompanyFullName as WorkAreaName,
                               e.UserName AcceptorName,g.DictionaryText RebarTypeNew,
                               h.UserName,ISNULL(i.StateCode,'未供货') as StateCode,i.ID as SupId,
                               ISNULL(i.SupplyDate, DATEADD(DAY,4,A.InsertTime)) as SupplyDate,isnull(i.HasSupplierTotal,0) as HasSupplierTotal,i.SupplyCompleteTime,case when j.DemandPlanCode is null then a.RawMaterialDemandNum else j.DemandPlanCode end DemandPlanCode,k.NoPassTotal,r.QyBhgCount,ghrk.BatchPlanNum as IsAdd,TbGhHg.PassCount
                               from TbFactoryBatchNeedPlan a
                               left join TbCompany b on a.BranchCode = b.CompanyCode 
                               left join TbCompany c on a.SiteCode=c.CompanyCode 
                               left join TbCompany d on a.ProcessFactoryCode=d.CompanyCode 
                               left join TbCompany f on a.WorkAreaCode=f.CompanyCode 
                               left join TbUser e on a.Acceptor=e.UserCode  
                               left join TbSysDictionaryData g on a.SteelsTypeCode=g.DictionaryCode and g.FDictionaryCode='RebarType' 
                               left join TbUser h on a.InsertUserCode=h.UserCode
                               LEFT JOIN TbSupplyList i ON a.BatchPlanNum=i.BatchPlanNum
							   left join TbRawMaterialMonthDemandSupplyPlan j on a.RawMaterialDemandNum=j.SupplyPlanCode
							   left join (select BatchPlanCode,sum(NoPassTotal) as NoPassTotal from TbInOrder group by BatchPlanCode) k on  a.BatchPlanNum=k.BatchPlanCode
                               left join (select io.BatchPlanCode,sum(ioi.PassCount) as QyBhgCount from TbSampleOrder  so
                               left join TbSampleOrderItem soi on so.SampleOrderCode=soi.SampleOrderCode
                               left join TbInOrderItem ioi on soi.InOrderItemId=ioi.ID
                               left join TbInOrder io on so.InOrderCode=io.InOrderCode
                               where (so.ChackResult=2 or so.ChackResult=3) and soi.ChackState=2
                               group by io.BatchPlanCode) r on a.BatchPlanNum=r.BatchPlanCode 
							   left join(select a.BatchPlanNum from TbSupplyListDetailHistory a
							   left join TbInOrderItem b on a.BatchPlanItemNewCode=b.BatchPlanItemNewCode where b.BatchPlanItemNewCode is null group by a.BatchPlanNum) ghrk on a.BatchPlanNum=ghrk.BatchPlanNum
							   left join(select TbGhHg.BatchPlanCode,sum(TbGhHg.PassCount) as PassCount from (select a.BatchPlanCode,case when c.ChackState=2 then 0 else b.PassCount end PassCount from TbInOrder a
                               left join TbInOrderItem b on a.InOrderCode=b.InOrderCode
                               left join TbSampleOrderItem c on b.ID=c.InOrderItemId) TbGhHg  group by TbGhHg.BatchPlanCode) TbGhHg on a.BatchPlanNum=TbGhHg.BatchPlanCode
							   where 1=1  and a.ProcessFactoryCode='6386683729561128960' and a.ProjectId='6245721945602523136' and (a.SiteCode in('6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672') or a.WorkAreaCode in('6274025879437836288','6274026095054422016'))	


-----------------------------------------------------------------------------
2020-03-27 17:58:41
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by BatchPlanNum desc)AS Row, * from (select 
                               a.*,b.CompanyFullName BranchName,
                               c.CompanyFullName SiteName,d.CompanyFullName ProcessFactoryName,f.CompanyFullName as WorkAreaName,
                               e.UserName AcceptorName,g.DictionaryText RebarTypeNew,
                               h.UserName,ISNULL(i.StateCode,'未供货') as StateCode,i.ID as SupId,
                               ISNULL(i.SupplyDate, DATEADD(DAY,4,A.InsertTime)) as SupplyDate,isnull(i.HasSupplierTotal,0) as HasSupplierTotal,i.SupplyCompleteTime,case when j.DemandPlanCode is null then a.RawMaterialDemandNum else j.DemandPlanCode end DemandPlanCode,k.NoPassTotal,r.QyBhgCount,ghrk.BatchPlanNum as IsAdd,TbGhHg.PassCount
                               from TbFactoryBatchNeedPlan a
                               left join TbCompany b on a.BranchCode = b.CompanyCode 
                               left join TbCompany c on a.SiteCode=c.CompanyCode 
                               left join TbCompany d on a.ProcessFactoryCode=d.CompanyCode 
                               left join TbCompany f on a.WorkAreaCode=f.CompanyCode 
                               left join TbUser e on a.Acceptor=e.UserCode  
                               left join TbSysDictionaryData g on a.SteelsTypeCode=g.DictionaryCode and g.FDictionaryCode='RebarType' 
                               left join TbUser h on a.InsertUserCode=h.UserCode
                               LEFT JOIN TbSupplyList i ON a.BatchPlanNum=i.BatchPlanNum
							   left join TbRawMaterialMonthDemandSupplyPlan j on a.RawMaterialDemandNum=j.SupplyPlanCode
							   left join (select BatchPlanCode,sum(NoPassTotal) as NoPassTotal from TbInOrder group by BatchPlanCode) k on  a.BatchPlanNum=k.BatchPlanCode
                               left join (select io.BatchPlanCode,sum(ioi.PassCount) as QyBhgCount from TbSampleOrder  so
                               left join TbSampleOrderItem soi on so.SampleOrderCode=soi.SampleOrderCode
                               left join TbInOrderItem ioi on soi.InOrderItemId=ioi.ID
                               left join TbInOrder io on so.InOrderCode=io.InOrderCode
                               where (so.ChackResult=2 or so.ChackResult=3) and soi.ChackState=2
                               group by io.BatchPlanCode) r on a.BatchPlanNum=r.BatchPlanCode 
							   left join(select a.BatchPlanNum from TbSupplyListDetailHistory a
							   left join TbInOrderItem b on a.BatchPlanItemNewCode=b.BatchPlanItemNewCode where b.BatchPlanItemNewCode is null group by a.BatchPlanNum) ghrk on a.BatchPlanNum=ghrk.BatchPlanNum
							   left join(select TbGhHg.BatchPlanCode,sum(TbGhHg.PassCount) as PassCount from (select a.BatchPlanCode,case when c.ChackState=2 then 0 else b.PassCount end PassCount from TbInOrder a
                               left join TbInOrderItem b on a.InOrderCode=b.InOrderCode
                               left join TbSampleOrderItem c on b.ID=c.InOrderItemId) TbGhHg  group by TbGhHg.BatchPlanCode) TbGhHg on a.BatchPlanNum=TbGhHg.BatchPlanCode
							   where 1=1  and a.ProcessFactoryCode='6386683729561128960' and a.ProjectId='6245721945602523136' and (a.SiteCode in('6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672') or a.WorkAreaCode in('6274025879437836288','6274026095054422016'))) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-03-27 17:58:41
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025587078070272
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:58:41
Text:	select isnull(a.BatchPlanTotal,0) as Pcl,isnull(b.HasSupplierTotal,0) as Ygh,isnull(a.BatchPlanTotal,0) as Wgh,'未供货' as GhType from TbFactoryBatchNeedPlan a
                           left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum
                           where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6274025879437836288','6274026095054422016') and a.SteelsTypeCode='BuildingSteel' and CONVERT(varchar(100),GETDATE(),23)<=CONVERT(varchar(100), DATEADD(DAY,4,A.InsertTime), 23) and b.SupplyCompleteTime is null and ISNULL(b.HasSupplierTotal,0)=0
                           union all
                           select isnull(a.BatchPlanTotal,0) as Pcl,isnull(b.HasSupplierTotal,0) as Ygh,isnull(a.BatchPlanTotal,0) as Wgh,'超期未供货' as GhType from TbFactoryBatchNeedPlan a
                           left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum
                           where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6274025879437836288','6274026095054422016') and a.SteelsTypeCode='BuildingSteel' and CONVERT(varchar(100),GETDATE(),23)>CONVERT(varchar(100), DATEADD(DAY,4,A.InsertTime), 23) and b.SupplyCompleteTime is null and ISNULL(b.HasSupplierTotal,0)=0
                           union all
                           select isnull(b.BatchPlanTotal,0) as Pcl,isnull(b.HasSupplierTotal,0) as Ygh,0 as Wgh,'按时供货' as GhType from TbFactoryBatchNeedPlan a 
                           left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6274025879437836288','6274026095054422016') and a.SteelsTypeCode='BuildingSteel' and b.StateCode='已供货' and CONVERT(varchar(100), b.SupplyCompleteTime, 23)<=CONVERT(varchar(100), b.SupplyDate, 23) 
                           union all
                           select isnull(b.BatchPlanTotal,0) as Pcl,isnull(b.HasSupplierTotal,0) as Ygh,0 as Wgh,'超时供货' as GhType from TbFactoryBatchNeedPlan a 
                           left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6274025879437836288','6274026095054422016') and a.SteelsTypeCode='BuildingSteel' and b.StateCode='已供货' and CONVERT(varchar(100), b.SupplyCompleteTime, 23)>CONVERT(varchar(100), b.SupplyDate, 23) 
                           union all
                           select sum(Tb.BatchPlanQuantity) Pcl,sum(Tb.HasSupplier) as Ygh,Sum(Tb.Wghl) as Wgh,Tb.GhType from (select Tb.BatchPlanNum,sud.BatchPlanQuantity,sud.HasSupplier,case when (isnull(sud.BatchPlanQuantity,0)-isnull(sud.HasSupplier,0))<0 then 0 when (isnull(sud.BatchPlanQuantity,0)-isnull(sud.HasSupplier,0))>0 then (isnull(sud.BatchPlanQuantity,0)-isnull(sud.HasSupplier,0)) end Wghl,Tb.SupplyDate,Tb.SupplyCompleteTime,Tb.GhType from (
                           select b.BatchPlanNum,b.BatchPlanTotal,b.HasSupplierTotal,b.StateCode,b.SupplyDate,b.SupplyCompleteTime,'超时部分供货' as GhType from TbFactoryBatchNeedPlan a
                           left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6274025879437836288','6274026095054422016') and a.SteelsTypeCode='BuildingSteel' and b.StateCode='部分供货' and CONVERT(varchar(100), b.SupplyDate, 23)<= CONVERT(varchar(100), GETDATE(), 23) 
                           union all
                           select b.BatchPlanNum,b.BatchPlanTotal,b.HasSupplierTotal,b.StateCode,b.SupplyDate,b.SupplyCompleteTime,'按时部分供货' as GhType from TbFactoryBatchNeedPlan a
                           left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6274025879437836288','6274026095054422016') and a.SteelsTypeCode='BuildingSteel' and b.StateCode='部分供货' and CONVERT(varchar(100), b.SupplyDate, 23)>CONVERT(varchar(100), GETDATE(), 23) ) Tb
                           left join TbSupplyListDetail sud on Tb.BatchPlanNum=sud.BatchPlanNum) Tb group by Tb.GhType	


-----------------------------------------------------------------------------
2020-03-27 17:58:41
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025587078070272
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:58:41
Text:	select Tb.GhType,sum(Tb.GhWeight) as GhWeight,sum(tb.GhCount) as GhCount from (select TbGhType.GhType,isnull(TbGhInfo.HasSupplier,0) as GhWeight,isnull(TbGhInfo.GhCount,0) as GhCount from (select '供货' as GhType
                            union all
                            select '验收不合格' as GhType
                            union all
                            select '检测不合格' as GhType) TbGhType
                            left join(
                            --供货次数、总量
                            select isnull(sum(Tb.HasSupplier),0) as HasSupplier,isnull(sum(Tb.GhCount),0) as GhCount,'供货' as GhType from (select a.HasSupplier,isnull(b.GhCount,0) as GhCount from (select a.BatchPlanNum,sum(a.HasSupplier) as HasSupplier from TbSupplyListDetail a 
                            left join TbSupplyList s on a.BatchPlanNum=s.BatchPlanNum where 1=1  and s.ProjectId='6245721945602523136' and s.ProcessFactoryCode='6386683729561128960' and s.WorkAreaCode in('6274025879437836288','6274026095054422016') and s.SteelsTypeCode='BuildingSteel'
                            GROUP BY a.BatchPlanNum) a
                            left join(select Tb.BatchPlanNum,count(1) as GhCount from (select BatchPlanNum,ThisTime from TbSupplyListDetailHistory
                            group by BatchPlanNum,ThisTime) Tb group by Tb.BatchPlanNum) b on a.BatchPlanNum=b.BatchPlanNum) Tb 
                            union all
                            --验收不合格次数、验收不合格重量
                            select sum(TbSum.NoPass) as NoPass,sum(TbSum.YsNoPassCount) as YsNoPassCount,'验收不合格' as GhType from (select count(1) as YsNoPassCount,sum(Tb.NoPass) as NoPass from (select b.BatchPlanCode,c.ThisTime,sum(a.NoPass) as NoPass from TbInOrderItem a
                            left join TbInOrder b on a.InOrderCode=b.InOrderCode
                            left join TbSupplyList s on b.BatchPlanCode=s.BatchPlanNum
                            left join TbSupplyListDetailHistory c on a.BatchPlanItemNewCode=c.BatchPlanItemNewCode
                            where 1=1  and s.ProjectId='6245721945602523136' and s.ProcessFactoryCode='6386683729561128960' and s.WorkAreaCode in('6274025879437836288','6274026095054422016') and s.SteelsTypeCode='BuildingSteel' and a.BatchPlanItemNewCode is not null and a.NoPass>0 
                            group by b.BatchPlanCode,c.ThisTime) Tb group by Tb.BatchPlanCode) TbSum
                            union all
                            --检测不合格次数、重量
                            select isnull(sum(Tb.JcNoPass),0) as JcNoPass,count(1) as JcNoPassCount,'检测不合格' as GhType from (select b.BatchPlanCode,d.ThisTime,Isnull(sum(c.PassCount),0) as JcNoPass from TbSampleOrderItem a
                            left join TbSampleOrder e on a.SampleOrderCode=e.SampleOrderCode
                            left join TbInOrderItem c on a.InOrderItemId=c.ID
                            left join TbSupplyListDetailHistory d on c.BatchPlanItemNewCode=d.BatchPlanItemNewCode
                            left join TbInOrder b on c.InOrderCode=b.InOrderCode
                            left join TbSupplyList s on b.BatchPlanCode=s.BatchPlanNum
                            where 1=1  and s.ProjectId='6245721945602523136' and s.ProcessFactoryCode='6386683729561128960' and s.WorkAreaCode in('6274025879437836288','6274026095054422016') and s.SteelsTypeCode='BuildingSteel'  and a.ChackState=2 and c.BatchPlanItemNewCode is not null
                            group by b.BatchPlanCode,d.ThisTime) Tb group by Tb.BatchPlanCode) TbGhInfo on TbGhType.GhType=TbGhInfo.GhType) Tb group by Tb.GhType	


-----------------------------------------------------------------------------
2020-03-27 17:58:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 17:58:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:58:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:58:43
Text:	select TbStateCode.StateCode,isnull(Tb.StateCount,0) as StateCount,isnull(Tb.BatchPlanTotal,0) as BatchPlanTotal from (select '未供货' as StateCode
                            union all
                            select '超期未供货' as StateCode
                            union all
                            select '供货不足' as StateCode
                            union all
                            select '供货完成' as StateCode
                            union all
                            select '供货过多' as StateCode) TbStateCode
                            left join (select TbGh.StateCode,Count(1) as StateCount,isnull(sum(TbGh.BatchPlanTotal),0) as BatchPlanTotal from (select a.BatchPlanNum,a.BatchPlanTotal,DATEADD(DAY,4,A.InsertTime) as SupplyDate,isnull(b.HasSupplierTotal,0) as HasSupplierTotal,b.SupplyCompleteTime,'未供货' as StateCode from TbFactoryBatchNeedPlan a
                            left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum
                            where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6276140381243441152') and a.SteelsTypeCode='BuildingSteel' and CONVERT(varchar(100),GETDATE(),23)<=CONVERT(varchar(100), DATEADD(DAY,4,A.InsertTime), 23) and b.SupplyCompleteTime is null and ISNULL(b.HasSupplierTotal,0)=0
                            union all
                            select a.BatchPlanNum,a.BatchPlanTotal,DATEADD(DAY,4,A.InsertTime) as SupplyDate,isnull(b.HasSupplierTotal,0) as HasSupplierTotal,b.SupplyCompleteTime,'超期未供货' as StateCode from TbFactoryBatchNeedPlan a
                            left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum
                            where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6276140381243441152') and a.SteelsTypeCode='BuildingSteel' and CONVERT(varchar(100),GETDATE(),23)>CONVERT(varchar(100), DATEADD(DAY,4,A.InsertTime), 23) and b.SupplyCompleteTime is null and ISNULL(b.HasSupplierTotal,0)=0
                            union all
                            select a.BatchPlanNum,a.BatchPlanTotal,DATEADD(DAY,4,A.InsertTime) as SupplyDate,isnull(b.HasSupplierTotal,0) as HasSupplierTotal,b.SupplyCompleteTime,'供货不足' as StateCode from TbFactoryBatchNeedPlan a
                            left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum
                            where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6276140381243441152') and a.SteelsTypeCode='BuildingSteel' and ISNULL(b.HasSupplierTotal,0)>0 and b.StateCode='部分供货'
                            union all
                            select a.BatchPlanNum,a.BatchPlanTotal,DATEADD(DAY,4,A.InsertTime) as SupplyDate,isnull(b.HasSupplierTotal,0) as HasSupplierTotal,b.SupplyCompleteTime,'供货过多' as StateCode from TbFactoryBatchNeedPlan a
                            left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum
                            where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6276140381243441152') and a.SteelsTypeCode='BuildingSteel' and ISNULL(b.HasSupplierTotal,0)>0 and b.StateCode='已供货' and b.BatchPlanTotal+(Isnull(b.BatchPlanTotal,0)*0.05)<b.HasSupplierTotal
                            union all
                            select a.BatchPlanNum,a.BatchPlanTotal,DATEADD(DAY,4,A.InsertTime) as SupplyDate,isnull(b.HasSupplierTotal,0) as HasSupplierTotal,b.SupplyCompleteTime,'供货完成' as StateCode from TbFactoryBatchNeedPlan a
                            left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum
                            where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6276140381243441152') and a.SteelsTypeCode='BuildingSteel' and ISNULL(b.HasSupplierTotal,0)>0 and b.StateCode='已供货' and b.BatchPlanTotal+(Isnull(b.BatchPlanTotal,0)*0.05)>=b.HasSupplierTotal
                            ) TbGh group by TbGh.StateCode) Tb on TbStateCode.StateCode=Tb.StateCode	


-----------------------------------------------------------------------------
2020-03-27 17:58:43
Text:	select 
                               a.*,b.CompanyFullName BranchName,
                               c.CompanyFullName SiteName,d.CompanyFullName ProcessFactoryName,f.CompanyFullName as WorkAreaName,
                               e.UserName AcceptorName,g.DictionaryText RebarTypeNew,
                               h.UserName,ISNULL(i.StateCode,'未供货') as StateCode,i.ID as SupId,
                               ISNULL(i.SupplyDate, DATEADD(DAY,4,A.InsertTime)) as SupplyDate,isnull(i.HasSupplierTotal,0) as HasSupplierTotal,i.SupplyCompleteTime,case when j.DemandPlanCode is null then a.RawMaterialDemandNum else j.DemandPlanCode end DemandPlanCode,k.NoPassTotal,r.QyBhgCount,ghrk.BatchPlanNum as IsAdd,TbGhHg.PassCount
                               from TbFactoryBatchNeedPlan a
                               left join TbCompany b on a.BranchCode = b.CompanyCode 
                               left join TbCompany c on a.SiteCode=c.CompanyCode 
                               left join TbCompany d on a.ProcessFactoryCode=d.CompanyCode 
                               left join TbCompany f on a.WorkAreaCode=f.CompanyCode 
                               left join TbUser e on a.Acceptor=e.UserCode  
                               left join TbSysDictionaryData g on a.SteelsTypeCode=g.DictionaryCode and g.FDictionaryCode='RebarType' 
                               left join TbUser h on a.InsertUserCode=h.UserCode
                               LEFT JOIN TbSupplyList i ON a.BatchPlanNum=i.BatchPlanNum
							   left join TbRawMaterialMonthDemandSupplyPlan j on a.RawMaterialDemandNum=j.SupplyPlanCode
							   left join (select BatchPlanCode,sum(NoPassTotal) as NoPassTotal from TbInOrder group by BatchPlanCode) k on  a.BatchPlanNum=k.BatchPlanCode
                               left join (select io.BatchPlanCode,sum(ioi.PassCount) as QyBhgCount from TbSampleOrder  so
                               left join TbSampleOrderItem soi on so.SampleOrderCode=soi.SampleOrderCode
                               left join TbInOrderItem ioi on soi.InOrderItemId=ioi.ID
                               left join TbInOrder io on so.InOrderCode=io.InOrderCode
                               where (so.ChackResult=2 or so.ChackResult=3) and soi.ChackState=2
                               group by io.BatchPlanCode) r on a.BatchPlanNum=r.BatchPlanCode 
							   left join(select a.BatchPlanNum from TbSupplyListDetailHistory a
							   left join TbInOrderItem b on a.BatchPlanItemNewCode=b.BatchPlanItemNewCode where b.BatchPlanItemNewCode is null group by a.BatchPlanNum) ghrk on a.BatchPlanNum=ghrk.BatchPlanNum
							   left join(select TbGhHg.BatchPlanCode,sum(TbGhHg.PassCount) as PassCount from (select a.BatchPlanCode,case when c.ChackState=2 then 0 else b.PassCount end PassCount from TbInOrder a
                               left join TbInOrderItem b on a.InOrderCode=b.InOrderCode
                               left join TbSampleOrderItem c on b.ID=c.InOrderItemId) TbGhHg  group by TbGhHg.BatchPlanCode) TbGhHg on a.BatchPlanNum=TbGhHg.BatchPlanCode
							   where 1=1  and a.ProcessFactoryCode='6386683729561128960' and a.ProjectId='6245721945602523136' and (a.SiteCode in('6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896') or a.WorkAreaCode in('6276140381243441152'))	


-----------------------------------------------------------------------------
2020-03-27 17:58:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:58:43
Text:	select isnull(a.BatchPlanTotal,0) as Pcl,isnull(b.HasSupplierTotal,0) as Ygh,isnull(a.BatchPlanTotal,0) as Wgh,'未供货' as GhType from TbFactoryBatchNeedPlan a
                           left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum
                           where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6276140381243441152') and a.SteelsTypeCode='BuildingSteel' and CONVERT(varchar(100),GETDATE(),23)<=CONVERT(varchar(100), DATEADD(DAY,4,A.InsertTime), 23) and b.SupplyCompleteTime is null and ISNULL(b.HasSupplierTotal,0)=0
                           union all
                           select isnull(a.BatchPlanTotal,0) as Pcl,isnull(b.HasSupplierTotal,0) as Ygh,isnull(a.BatchPlanTotal,0) as Wgh,'超期未供货' as GhType from TbFactoryBatchNeedPlan a
                           left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum
                           where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6276140381243441152') and a.SteelsTypeCode='BuildingSteel' and CONVERT(varchar(100),GETDATE(),23)>CONVERT(varchar(100), DATEADD(DAY,4,A.InsertTime), 23) and b.SupplyCompleteTime is null and ISNULL(b.HasSupplierTotal,0)=0
                           union all
                           select isnull(b.BatchPlanTotal,0) as Pcl,isnull(b.HasSupplierTotal,0) as Ygh,0 as Wgh,'按时供货' as GhType from TbFactoryBatchNeedPlan a 
                           left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6276140381243441152') and a.SteelsTypeCode='BuildingSteel' and b.StateCode='已供货' and CONVERT(varchar(100), b.SupplyCompleteTime, 23)<=CONVERT(varchar(100), b.SupplyDate, 23) 
                           union all
                           select isnull(b.BatchPlanTotal,0) as Pcl,isnull(b.HasSupplierTotal,0) as Ygh,0 as Wgh,'超时供货' as GhType from TbFactoryBatchNeedPlan a 
                           left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6276140381243441152') and a.SteelsTypeCode='BuildingSteel' and b.StateCode='已供货' and CONVERT(varchar(100), b.SupplyCompleteTime, 23)>CONVERT(varchar(100), b.SupplyDate, 23) 
                           union all
                           select sum(Tb.BatchPlanQuantity) Pcl,sum(Tb.HasSupplier) as Ygh,Sum(Tb.Wghl) as Wgh,Tb.GhType from (select Tb.BatchPlanNum,sud.BatchPlanQuantity,sud.HasSupplier,case when (isnull(sud.BatchPlanQuantity,0)-isnull(sud.HasSupplier,0))<0 then 0 when (isnull(sud.BatchPlanQuantity,0)-isnull(sud.HasSupplier,0))>0 then (isnull(sud.BatchPlanQuantity,0)-isnull(sud.HasSupplier,0)) end Wghl,Tb.SupplyDate,Tb.SupplyCompleteTime,Tb.GhType from (
                           select b.BatchPlanNum,b.BatchPlanTotal,b.HasSupplierTotal,b.StateCode,b.SupplyDate,b.SupplyCompleteTime,'超时部分供货' as GhType from TbFactoryBatchNeedPlan a
                           left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6276140381243441152') and a.SteelsTypeCode='BuildingSteel' and b.StateCode='部分供货' and CONVERT(varchar(100), b.SupplyDate, 23)<= CONVERT(varchar(100), GETDATE(), 23) 
                           union all
                           select b.BatchPlanNum,b.BatchPlanTotal,b.HasSupplierTotal,b.StateCode,b.SupplyDate,b.SupplyCompleteTime,'按时部分供货' as GhType from TbFactoryBatchNeedPlan a
                           left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum where 1=1  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and a.WorkAreaCode in('6276140381243441152') and a.SteelsTypeCode='BuildingSteel' and b.StateCode='部分供货' and CONVERT(varchar(100), b.SupplyDate, 23)>CONVERT(varchar(100), GETDATE(), 23) ) Tb
                           left join TbSupplyListDetail sud on Tb.BatchPlanNum=sud.BatchPlanNum) Tb group by Tb.GhType	


-----------------------------------------------------------------------------
2020-03-27 17:58:44
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:58:44
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by BatchPlanNum desc)AS Row, * from (select 
                               a.*,b.CompanyFullName BranchName,
                               c.CompanyFullName SiteName,d.CompanyFullName ProcessFactoryName,f.CompanyFullName as WorkAreaName,
                               e.UserName AcceptorName,g.DictionaryText RebarTypeNew,
                               h.UserName,ISNULL(i.StateCode,'未供货') as StateCode,i.ID as SupId,
                               ISNULL(i.SupplyDate, DATEADD(DAY,4,A.InsertTime)) as SupplyDate,isnull(i.HasSupplierTotal,0) as HasSupplierTotal,i.SupplyCompleteTime,case when j.DemandPlanCode is null then a.RawMaterialDemandNum else j.DemandPlanCode end DemandPlanCode,k.NoPassTotal,r.QyBhgCount,ghrk.BatchPlanNum as IsAdd,TbGhHg.PassCount
                               from TbFactoryBatchNeedPlan a
                               left join TbCompany b on a.BranchCode = b.CompanyCode 
                               left join TbCompany c on a.SiteCode=c.CompanyCode 
                               left join TbCompany d on a.ProcessFactoryCode=d.CompanyCode 
                               left join TbCompany f on a.WorkAreaCode=f.CompanyCode 
                               left join TbUser e on a.Acceptor=e.UserCode  
                               left join TbSysDictionaryData g on a.SteelsTypeCode=g.DictionaryCode and g.FDictionaryCode='RebarType' 
                               left join TbUser h on a.InsertUserCode=h.UserCode
                               LEFT JOIN TbSupplyList i ON a.BatchPlanNum=i.BatchPlanNum
							   left join TbRawMaterialMonthDemandSupplyPlan j on a.RawMaterialDemandNum=j.SupplyPlanCode
							   left join (select BatchPlanCode,sum(NoPassTotal) as NoPassTotal from TbInOrder group by BatchPlanCode) k on  a.BatchPlanNum=k.BatchPlanCode
                               left join (select io.BatchPlanCode,sum(ioi.PassCount) as QyBhgCount from TbSampleOrder  so
                               left join TbSampleOrderItem soi on so.SampleOrderCode=soi.SampleOrderCode
                               left join TbInOrderItem ioi on soi.InOrderItemId=ioi.ID
                               left join TbInOrder io on so.InOrderCode=io.InOrderCode
                               where (so.ChackResult=2 or so.ChackResult=3) and soi.ChackState=2
                               group by io.BatchPlanCode) r on a.BatchPlanNum=r.BatchPlanCode 
							   left join(select a.BatchPlanNum from TbSupplyListDetailHistory a
							   left join TbInOrderItem b on a.BatchPlanItemNewCode=b.BatchPlanItemNewCode where b.BatchPlanItemNewCode is null group by a.BatchPlanNum) ghrk on a.BatchPlanNum=ghrk.BatchPlanNum
							   left join(select TbGhHg.BatchPlanCode,sum(TbGhHg.PassCount) as PassCount from (select a.BatchPlanCode,case when c.ChackState=2 then 0 else b.PassCount end PassCount from TbInOrder a
                               left join TbInOrderItem b on a.InOrderCode=b.InOrderCode
                               left join TbSampleOrderItem c on b.ID=c.InOrderItemId) TbGhHg  group by TbGhHg.BatchPlanCode) TbGhHg on a.BatchPlanNum=TbGhHg.BatchPlanCode
							   where 1=1  and a.ProcessFactoryCode='6386683729561128960' and a.ProjectId='6245721945602523136' and (a.SiteCode in('6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896') or a.WorkAreaCode in('6276140381243441152'))) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-03-27 17:58:44
Text:	select Tb.GhType,sum(Tb.GhWeight) as GhWeight,sum(tb.GhCount) as GhCount from (select TbGhType.GhType,isnull(TbGhInfo.HasSupplier,0) as GhWeight,isnull(TbGhInfo.GhCount,0) as GhCount from (select '供货' as GhType
                            union all
                            select '验收不合格' as GhType
                            union all
                            select '检测不合格' as GhType) TbGhType
                            left join(
                            --供货次数、总量
                            select isnull(sum(Tb.HasSupplier),0) as HasSupplier,isnull(sum(Tb.GhCount),0) as GhCount,'供货' as GhType from (select a.HasSupplier,isnull(b.GhCount,0) as GhCount from (select a.BatchPlanNum,sum(a.HasSupplier) as HasSupplier from TbSupplyListDetail a 
                            left join TbSupplyList s on a.BatchPlanNum=s.BatchPlanNum where 1=1  and s.ProjectId='6245721945602523136' and s.ProcessFactoryCode='6386683729561128960' and s.WorkAreaCode in('6276140381243441152') and s.SteelsTypeCode='BuildingSteel'
                            GROUP BY a.BatchPlanNum) a
                            left join(select Tb.BatchPlanNum,count(1) as GhCount from (select BatchPlanNum,ThisTime from TbSupplyListDetailHistory
                            group by BatchPlanNum,ThisTime) Tb group by Tb.BatchPlanNum) b on a.BatchPlanNum=b.BatchPlanNum) Tb 
                            union all
                            --验收不合格次数、验收不合格重量
                            select sum(TbSum.NoPass) as NoPass,sum(TbSum.YsNoPassCount) as YsNoPassCount,'验收不合格' as GhType from (select count(1) as YsNoPassCount,sum(Tb.NoPass) as NoPass from (select b.BatchPlanCode,c.ThisTime,sum(a.NoPass) as NoPass from TbInOrderItem a
                            left join TbInOrder b on a.InOrderCode=b.InOrderCode
                            left join TbSupplyList s on b.BatchPlanCode=s.BatchPlanNum
                            left join TbSupplyListDetailHistory c on a.BatchPlanItemNewCode=c.BatchPlanItemNewCode
                            where 1=1  and s.ProjectId='6245721945602523136' and s.ProcessFactoryCode='6386683729561128960' and s.WorkAreaCode in('6276140381243441152') and s.SteelsTypeCode='BuildingSteel' and a.BatchPlanItemNewCode is not null and a.NoPass>0 
                            group by b.BatchPlanCode,c.ThisTime) Tb group by Tb.BatchPlanCode) TbSum
                            union all
                            --检测不合格次数、重量
                            select isnull(sum(Tb.JcNoPass),0) as JcNoPass,count(1) as JcNoPassCount,'检测不合格' as GhType from (select b.BatchPlanCode,d.ThisTime,Isnull(sum(c.PassCount),0) as JcNoPass from TbSampleOrderItem a
                            left join TbSampleOrder e on a.SampleOrderCode=e.SampleOrderCode
                            left join TbInOrderItem c on a.InOrderItemId=c.ID
                            left join TbSupplyListDetailHistory d on c.BatchPlanItemNewCode=d.BatchPlanItemNewCode
                            left join TbInOrder b on c.InOrderCode=b.InOrderCode
                            left join TbSupplyList s on b.BatchPlanCode=s.BatchPlanNum
                            where 1=1  and s.ProjectId='6245721945602523136' and s.ProcessFactoryCode='6386683729561128960' and s.WorkAreaCode in('6276140381243441152') and s.SteelsTypeCode='BuildingSteel'  and a.ChackState=2 and c.BatchPlanItemNewCode is not null
                            group by b.BatchPlanCode,d.ThisTime) Tb group by Tb.BatchPlanCode) TbGhInfo on TbGhType.GhType=TbGhInfo.GhType) Tb group by Tb.GhType	


-----------------------------------------------------------------------------
2020-03-27 17:58:57
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  and T.OrgType!=5 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 17:58:57
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 17:58:57
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:58:57
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 and T.OrgType!=5 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 17:58:57
Text:	select 
                               a.*,b.CompanyFullName BranchName,
                               c.CompanyFullName SiteName,d.CompanyFullName ProcessFactoryName,f.CompanyFullName as WorkAreaName,
                               e.UserName AcceptorName,g.DictionaryText RebarTypeNew,
                               h.UserName,ISNULL(i.StateCode,'未供货') as StateCode,i.ID as SupId,
                               ISNULL(i.SupplyDate, DATEADD(DAY,4,A.InsertTime)) as SupplyDate,isnull(i.HasSupplierTotal,0) as HasSupplierTotal,i.SupplyCompleteTime,case when j.DemandPlanCode is null then a.RawMaterialDemandNum else j.DemandPlanCode end DemandPlanCode,k.NoPassTotal,r.QyBhgCount,ghrk.BatchPlanNum as IsAdd,TbGhHg.PassCount
                               from TbFactoryBatchNeedPlan a
                               left join TbCompany b on a.BranchCode = b.CompanyCode 
                               left join TbCompany c on a.SiteCode=c.CompanyCode 
                               left join TbCompany d on a.ProcessFactoryCode=d.CompanyCode 
                               left join TbCompany f on a.WorkAreaCode=f.CompanyCode 
                               left join TbUser e on a.Acceptor=e.UserCode  
                               left join TbSysDictionaryData g on a.SteelsTypeCode=g.DictionaryCode and g.FDictionaryCode='RebarType' 
                               left join TbUser h on a.InsertUserCode=h.UserCode
                               LEFT JOIN TbSupplyList i ON a.BatchPlanNum=i.BatchPlanNum
							   left join TbRawMaterialMonthDemandSupplyPlan j on a.RawMaterialDemandNum=j.SupplyPlanCode
							   left join (select BatchPlanCode,sum(NoPassTotal) as NoPassTotal from TbInOrder group by BatchPlanCode) k on  a.BatchPlanNum=k.BatchPlanCode
                               left join (select io.BatchPlanCode,sum(ioi.PassCount) as QyBhgCount from TbSampleOrder  so
                               left join TbSampleOrderItem soi on so.SampleOrderCode=soi.SampleOrderCode
                               left join TbInOrderItem ioi on soi.InOrderItemId=ioi.ID
                               left join TbInOrder io on so.InOrderCode=io.InOrderCode
                               where (so.ChackResult=2 or so.ChackResult=3) and soi.ChackState=2
                               group by io.BatchPlanCode) r on a.BatchPlanNum=r.BatchPlanCode 
							   left join(select a.BatchPlanNum from TbSupplyListDetailHistory a
							   left join TbInOrderItem b on a.BatchPlanItemNewCode=b.BatchPlanItemNewCode where b.BatchPlanItemNewCode is null group by a.BatchPlanNum) ghrk on a.BatchPlanNum=ghrk.BatchPlanNum
							   left join(select TbGhHg.BatchPlanCode,sum(TbGhHg.PassCount) as PassCount from (select a.BatchPlanCode,case when c.ChackState=2 then 0 else b.PassCount end PassCount from TbInOrder a
                               left join TbInOrderItem b on a.InOrderCode=b.InOrderCode
                               left join TbSampleOrderItem c on b.ID=c.InOrderItemId) TbGhHg  group by TbGhHg.BatchPlanCode) TbGhHg on a.BatchPlanNum=TbGhHg.BatchPlanCode
							   where 1=1  and a.ProcessFactoryCode='6386683729561128960' and a.ProjectId='6245721945602523136' and (a.SiteCode in('6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896') or a.WorkAreaCode in('6276140381243441152'))	


-----------------------------------------------------------------------------
2020-03-27 17:58:57
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by BatchPlanNum desc)AS Row, * from (select 
                               a.*,b.CompanyFullName BranchName,
                               c.CompanyFullName SiteName,d.CompanyFullName ProcessFactoryName,f.CompanyFullName as WorkAreaName,
                               e.UserName AcceptorName,g.DictionaryText RebarTypeNew,
                               h.UserName,ISNULL(i.StateCode,'未供货') as StateCode,i.ID as SupId,
                               ISNULL(i.SupplyDate, DATEADD(DAY,4,A.InsertTime)) as SupplyDate,isnull(i.HasSupplierTotal,0) as HasSupplierTotal,i.SupplyCompleteTime,case when j.DemandPlanCode is null then a.RawMaterialDemandNum else j.DemandPlanCode end DemandPlanCode,k.NoPassTotal,r.QyBhgCount,ghrk.BatchPlanNum as IsAdd,TbGhHg.PassCount
                               from TbFactoryBatchNeedPlan a
                               left join TbCompany b on a.BranchCode = b.CompanyCode 
                               left join TbCompany c on a.SiteCode=c.CompanyCode 
                               left join TbCompany d on a.ProcessFactoryCode=d.CompanyCode 
                               left join TbCompany f on a.WorkAreaCode=f.CompanyCode 
                               left join TbUser e on a.Acceptor=e.UserCode  
                               left join TbSysDictionaryData g on a.SteelsTypeCode=g.DictionaryCode and g.FDictionaryCode='RebarType' 
                               left join TbUser h on a.InsertUserCode=h.UserCode
                               LEFT JOIN TbSupplyList i ON a.BatchPlanNum=i.BatchPlanNum
							   left join TbRawMaterialMonthDemandSupplyPlan j on a.RawMaterialDemandNum=j.SupplyPlanCode
							   left join (select BatchPlanCode,sum(NoPassTotal) as NoPassTotal from TbInOrder group by BatchPlanCode) k on  a.BatchPlanNum=k.BatchPlanCode
                               left join (select io.BatchPlanCode,sum(ioi.PassCount) as QyBhgCount from TbSampleOrder  so
                               left join TbSampleOrderItem soi on so.SampleOrderCode=soi.SampleOrderCode
                               left join TbInOrderItem ioi on soi.InOrderItemId=ioi.ID
                               left join TbInOrder io on so.InOrderCode=io.InOrderCode
                               where (so.ChackResult=2 or so.ChackResult=3) and soi.ChackState=2
                               group by io.BatchPlanCode) r on a.BatchPlanNum=r.BatchPlanCode 
							   left join(select a.BatchPlanNum from TbSupplyListDetailHistory a
							   left join TbInOrderItem b on a.BatchPlanItemNewCode=b.BatchPlanItemNewCode where b.BatchPlanItemNewCode is null group by a.BatchPlanNum) ghrk on a.BatchPlanNum=ghrk.BatchPlanNum
							   left join(select TbGhHg.BatchPlanCode,sum(TbGhHg.PassCount) as PassCount from (select a.BatchPlanCode,case when c.ChackState=2 then 0 else b.PassCount end PassCount from TbInOrder a
                               left join TbInOrderItem b on a.InOrderCode=b.InOrderCode
                               left join TbSampleOrderItem c on b.ID=c.InOrderItemId) TbGhHg  group by TbGhHg.BatchPlanCode) TbGhHg on a.BatchPlanNum=TbGhHg.BatchPlanCode
							   where 1=1  and a.ProcessFactoryCode='6386683729561128960' and a.ProjectId='6245721945602523136' and (a.SiteCode in('6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896') or a.WorkAreaCode in('6276140381243441152'))) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-03-27 17:59:07
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  and T.OrgType!=5 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 17:59:07
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 17:59:07
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 and T.OrgType!=5 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 17:59:07
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:59:07
Text:	select 
                               a.*,b.CompanyFullName BranchName,
                               c.CompanyFullName SiteName,d.CompanyFullName ProcessFactoryName,f.CompanyFullName as WorkAreaName,
                               e.UserName AcceptorName,g.DictionaryText RebarTypeNew,
                               h.UserName,ISNULL(i.StateCode,'未供货') as StateCode,i.ID as SupId,
                               ISNULL(i.SupplyDate, DATEADD(DAY,4,A.InsertTime)) as SupplyDate,isnull(i.HasSupplierTotal,0) as HasSupplierTotal,i.SupplyCompleteTime,case when j.DemandPlanCode is null then a.RawMaterialDemandNum else j.DemandPlanCode end DemandPlanCode,k.NoPassTotal,r.QyBhgCount,ghrk.BatchPlanNum as IsAdd,TbGhHg.PassCount
                               from TbFactoryBatchNeedPlan a
                               left join TbCompany b on a.BranchCode = b.CompanyCode 
                               left join TbCompany c on a.SiteCode=c.CompanyCode 
                               left join TbCompany d on a.ProcessFactoryCode=d.CompanyCode 
                               left join TbCompany f on a.WorkAreaCode=f.CompanyCode 
                               left join TbUser e on a.Acceptor=e.UserCode  
                               left join TbSysDictionaryData g on a.SteelsTypeCode=g.DictionaryCode and g.FDictionaryCode='RebarType' 
                               left join TbUser h on a.InsertUserCode=h.UserCode
                               LEFT JOIN TbSupplyList i ON a.BatchPlanNum=i.BatchPlanNum
							   left join TbRawMaterialMonthDemandSupplyPlan j on a.RawMaterialDemandNum=j.SupplyPlanCode
							   left join (select BatchPlanCode,sum(NoPassTotal) as NoPassTotal from TbInOrder group by BatchPlanCode) k on  a.BatchPlanNum=k.BatchPlanCode
                               left join (select io.BatchPlanCode,sum(ioi.PassCount) as QyBhgCount from TbSampleOrder  so
                               left join TbSampleOrderItem soi on so.SampleOrderCode=soi.SampleOrderCode
                               left join TbInOrderItem ioi on soi.InOrderItemId=ioi.ID
                               left join TbInOrder io on so.InOrderCode=io.InOrderCode
                               where (so.ChackResult=2 or so.ChackResult=3) and soi.ChackState=2
                               group by io.BatchPlanCode) r on a.BatchPlanNum=r.BatchPlanCode 
							   left join(select a.BatchPlanNum from TbSupplyListDetailHistory a
							   left join TbInOrderItem b on a.BatchPlanItemNewCode=b.BatchPlanItemNewCode where b.BatchPlanItemNewCode is null group by a.BatchPlanNum) ghrk on a.BatchPlanNum=ghrk.BatchPlanNum
							   left join(select TbGhHg.BatchPlanCode,sum(TbGhHg.PassCount) as PassCount from (select a.BatchPlanCode,case when c.ChackState=2 then 0 else b.PassCount end PassCount from TbInOrder a
                               left join TbInOrderItem b on a.InOrderCode=b.InOrderCode
                               left join TbSampleOrderItem c on b.ID=c.InOrderItemId) TbGhHg  group by TbGhHg.BatchPlanCode) TbGhHg on a.BatchPlanNum=TbGhHg.BatchPlanCode
							   where 1=1  and a.ProcessFactoryCode='6386683729561128960' and a.ProjectId='6245721945602523136' and (a.SiteCode in('6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896') or a.WorkAreaCode in('6276140381243441152'))	


-----------------------------------------------------------------------------
2020-03-27 17:59:07
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by BatchPlanNum desc)AS Row, * from (select 
                               a.*,b.CompanyFullName BranchName,
                               c.CompanyFullName SiteName,d.CompanyFullName ProcessFactoryName,f.CompanyFullName as WorkAreaName,
                               e.UserName AcceptorName,g.DictionaryText RebarTypeNew,
                               h.UserName,ISNULL(i.StateCode,'未供货') as StateCode,i.ID as SupId,
                               ISNULL(i.SupplyDate, DATEADD(DAY,4,A.InsertTime)) as SupplyDate,isnull(i.HasSupplierTotal,0) as HasSupplierTotal,i.SupplyCompleteTime,case when j.DemandPlanCode is null then a.RawMaterialDemandNum else j.DemandPlanCode end DemandPlanCode,k.NoPassTotal,r.QyBhgCount,ghrk.BatchPlanNum as IsAdd,TbGhHg.PassCount
                               from TbFactoryBatchNeedPlan a
                               left join TbCompany b on a.BranchCode = b.CompanyCode 
                               left join TbCompany c on a.SiteCode=c.CompanyCode 
                               left join TbCompany d on a.ProcessFactoryCode=d.CompanyCode 
                               left join TbCompany f on a.WorkAreaCode=f.CompanyCode 
                               left join TbUser e on a.Acceptor=e.UserCode  
                               left join TbSysDictionaryData g on a.SteelsTypeCode=g.DictionaryCode and g.FDictionaryCode='RebarType' 
                               left join TbUser h on a.InsertUserCode=h.UserCode
                               LEFT JOIN TbSupplyList i ON a.BatchPlanNum=i.BatchPlanNum
							   left join TbRawMaterialMonthDemandSupplyPlan j on a.RawMaterialDemandNum=j.SupplyPlanCode
							   left join (select BatchPlanCode,sum(NoPassTotal) as NoPassTotal from TbInOrder group by BatchPlanCode) k on  a.BatchPlanNum=k.BatchPlanCode
                               left join (select io.BatchPlanCode,sum(ioi.PassCount) as QyBhgCount from TbSampleOrder  so
                               left join TbSampleOrderItem soi on so.SampleOrderCode=soi.SampleOrderCode
                               left join TbInOrderItem ioi on soi.InOrderItemId=ioi.ID
                               left join TbInOrder io on so.InOrderCode=io.InOrderCode
                               where (so.ChackResult=2 or so.ChackResult=3) and soi.ChackState=2
                               group by io.BatchPlanCode) r on a.BatchPlanNum=r.BatchPlanCode 
							   left join(select a.BatchPlanNum from TbSupplyListDetailHistory a
							   left join TbInOrderItem b on a.BatchPlanItemNewCode=b.BatchPlanItemNewCode where b.BatchPlanItemNewCode is null group by a.BatchPlanNum) ghrk on a.BatchPlanNum=ghrk.BatchPlanNum
							   left join(select TbGhHg.BatchPlanCode,sum(TbGhHg.PassCount) as PassCount from (select a.BatchPlanCode,case when c.ChackState=2 then 0 else b.PassCount end PassCount from TbInOrder a
                               left join TbInOrderItem b on a.InOrderCode=b.InOrderCode
                               left join TbSampleOrderItem c on b.ID=c.InOrderItemId) TbGhHg  group by TbGhHg.BatchPlanCode) TbGhHg on a.BatchPlanNum=TbGhHg.BatchPlanCode
							   where 1=1  and a.ProcessFactoryCode='6386683729561128960' and a.ProjectId='6245721945602523136' and (a.SiteCode in('6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896') or a.WorkAreaCode in('6276140381243441152'))) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-03-27 17:59:17
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  and T.OrgType!=5 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 17:59:17
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 17:59:17
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 17:59:17
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 and T.OrgType!=5 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 17:59:17
Text:	select 
                               a.*,b.CompanyFullName BranchName,
                               c.CompanyFullName SiteName,d.CompanyFullName ProcessFactoryName,f.CompanyFullName as WorkAreaName,
                               e.UserName AcceptorName,g.DictionaryText RebarTypeNew,
                               h.UserName,ISNULL(i.StateCode,'未供货') as StateCode,i.ID as SupId,
                               ISNULL(i.SupplyDate, DATEADD(DAY,4,A.InsertTime)) as SupplyDate,isnull(i.HasSupplierTotal,0) as HasSupplierTotal,i.SupplyCompleteTime,case when j.DemandPlanCode is null then a.RawMaterialDemandNum else j.DemandPlanCode end DemandPlanCode,k.NoPassTotal,r.QyBhgCount,ghrk.BatchPlanNum as IsAdd,TbGhHg.PassCount
                               from TbFactoryBatchNeedPlan a
                               left join TbCompany b on a.BranchCode = b.CompanyCode 
                               left join TbCompany c on a.SiteCode=c.CompanyCode 
                               left join TbCompany d on a.ProcessFactoryCode=d.CompanyCode 
                               left join TbCompany f on a.WorkAreaCode=f.CompanyCode 
                               left join TbUser e on a.Acceptor=e.UserCode  
                               left join TbSysDictionaryData g on a.SteelsTypeCode=g.DictionaryCode and g.FDictionaryCode='RebarType' 
                               left join TbUser h on a.InsertUserCode=h.UserCode
                               LEFT JOIN TbSupplyList i ON a.BatchPlanNum=i.BatchPlanNum
							   left join TbRawMaterialMonthDemandSupplyPlan j on a.RawMaterialDemandNum=j.SupplyPlanCode
							   left join (select BatchPlanCode,sum(NoPassTotal) as NoPassTotal from TbInOrder group by BatchPlanCode) k on  a.BatchPlanNum=k.BatchPlanCode
                               left join (select io.BatchPlanCode,sum(ioi.PassCount) as QyBhgCount from TbSampleOrder  so
                               left join TbSampleOrderItem soi on so.SampleOrderCode=soi.SampleOrderCode
                               left join TbInOrderItem ioi on soi.InOrderItemId=ioi.ID
                               left join TbInOrder io on so.InOrderCode=io.InOrderCode
                               where (so.ChackResult=2 or so.ChackResult=3) and soi.ChackState=2
                               group by io.BatchPlanCode) r on a.BatchPlanNum=r.BatchPlanCode 
							   left join(select a.BatchPlanNum from TbSupplyListDetailHistory a
							   left join TbInOrderItem b on a.BatchPlanItemNewCode=b.BatchPlanItemNewCode where b.BatchPlanItemNewCode is null group by a.BatchPlanNum) ghrk on a.BatchPlanNum=ghrk.BatchPlanNum
							   left join(select TbGhHg.BatchPlanCode,sum(TbGhHg.PassCount) as PassCount from (select a.BatchPlanCode,case when c.ChackState=2 then 0 else b.PassCount end PassCount from TbInOrder a
                               left join TbInOrderItem b on a.InOrderCode=b.InOrderCode
                               left join TbSampleOrderItem c on b.ID=c.InOrderItemId) TbGhHg  group by TbGhHg.BatchPlanCode) TbGhHg on a.BatchPlanNum=TbGhHg.BatchPlanCode
							   where 1=1  and a.ProcessFactoryCode='6386683729561128960' and a.ProjectId='6245721945602523136' and (a.SiteCode in('6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896') or a.WorkAreaCode in('6276140381243441152'))	


-----------------------------------------------------------------------------
2020-03-27 17:59:17
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by BatchPlanNum desc)AS Row, * from (select 
                               a.*,b.CompanyFullName BranchName,
                               c.CompanyFullName SiteName,d.CompanyFullName ProcessFactoryName,f.CompanyFullName as WorkAreaName,
                               e.UserName AcceptorName,g.DictionaryText RebarTypeNew,
                               h.UserName,ISNULL(i.StateCode,'未供货') as StateCode,i.ID as SupId,
                               ISNULL(i.SupplyDate, DATEADD(DAY,4,A.InsertTime)) as SupplyDate,isnull(i.HasSupplierTotal,0) as HasSupplierTotal,i.SupplyCompleteTime,case when j.DemandPlanCode is null then a.RawMaterialDemandNum else j.DemandPlanCode end DemandPlanCode,k.NoPassTotal,r.QyBhgCount,ghrk.BatchPlanNum as IsAdd,TbGhHg.PassCount
                               from TbFactoryBatchNeedPlan a
                               left join TbCompany b on a.BranchCode = b.CompanyCode 
                               left join TbCompany c on a.SiteCode=c.CompanyCode 
                               left join TbCompany d on a.ProcessFactoryCode=d.CompanyCode 
                               left join TbCompany f on a.WorkAreaCode=f.CompanyCode 
                               left join TbUser e on a.Acceptor=e.UserCode  
                               left join TbSysDictionaryData g on a.SteelsTypeCode=g.DictionaryCode and g.FDictionaryCode='RebarType' 
                               left join TbUser h on a.InsertUserCode=h.UserCode
                               LEFT JOIN TbSupplyList i ON a.BatchPlanNum=i.BatchPlanNum
							   left join TbRawMaterialMonthDemandSupplyPlan j on a.RawMaterialDemandNum=j.SupplyPlanCode
							   left join (select BatchPlanCode,sum(NoPassTotal) as NoPassTotal from TbInOrder group by BatchPlanCode) k on  a.BatchPlanNum=k.BatchPlanCode
                               left join (select io.BatchPlanCode,sum(ioi.PassCount) as QyBhgCount from TbSampleOrder  so
                               left join TbSampleOrderItem soi on so.SampleOrderCode=soi.SampleOrderCode
                               left join TbInOrderItem ioi on soi.InOrderItemId=ioi.ID
                               left join TbInOrder io on so.InOrderCode=io.InOrderCode
                               where (so.ChackResult=2 or so.ChackResult=3) and soi.ChackState=2
                               group by io.BatchPlanCode) r on a.BatchPlanNum=r.BatchPlanCode 
							   left join(select a.BatchPlanNum from TbSupplyListDetailHistory a
							   left join TbInOrderItem b on a.BatchPlanItemNewCode=b.BatchPlanItemNewCode where b.BatchPlanItemNewCode is null group by a.BatchPlanNum) ghrk on a.BatchPlanNum=ghrk.BatchPlanNum
							   left join(select TbGhHg.BatchPlanCode,sum(TbGhHg.PassCount) as PassCount from (select a.BatchPlanCode,case when c.ChackState=2 then 0 else b.PassCount end PassCount from TbInOrder a
                               left join TbInOrderItem b on a.InOrderCode=b.InOrderCode
                               left join TbSampleOrderItem c on b.ID=c.InOrderItemId) TbGhHg  group by TbGhHg.BatchPlanCode) TbGhHg on a.BatchPlanNum=TbGhHg.BatchPlanCode
							   where 1=1  and a.ProcessFactoryCode='6386683729561128960' and a.ProjectId='6245721945602523136' and (a.SiteCode in('6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896') or a.WorkAreaCode in('6276140381243441152'))) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-03-27 17:59:29
Text:	select TbAll.EarlyWarningCode,TbAll.BranchCode,TbAll.BranchName,TbAll.WorkAreaCode,TbAll.WorkAreaName,TbAll.SiteCode,TbAll.SiteName,TbAll.ProjectId,TbAll.YjMonth,TbAll.MenuCode,TbAll.EWNodeCode,TbAll.EWNodeName,TbAll.PersonnelCode,TbAll.PersonnelSource,TbAll.BegEwTiemNew from (select Tb.*,case when Tb.EWTimeType='年' then DATEADD(YEAR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='月' then DATEADD(MONTH,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='天' then DATEADD(DAY,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='时' then DATEADD(HOUR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='分' then DATEADD(MINUTE,Tb.EWTime,Tb.BegEwTiem) end as BegEwTiemNew,TbYjInfo.EarlyWarningCode as YjCode from (select ewt.EarlyWarningCode,DATENAME(year,GETDATE())+'-'+ DATENAME(MONTH,GETDATE())+'-'+ CONVERT(varchar(20),ewt.EWBegDay)+' '+CONVERT(varchar(20),ewt.EWBegHour)+':'+CONVERT(varchar(20),ewt.EWBegMinute)+':00' as BegEwTiem,ewt.BranchCode,cp1.CompanyFullName as BranchName,ewt.WorkAreaCode,cp2.CompanyFullName as WorkAreaName,ewt.SiteCode,cp3.CompanyFullName as SiteName,ewt.ProjectId,MONTH(GETDATE()) as YjMonth,ewt.MenuCode,ewn.EWNodeCode,ewn.EWNodeName,ewn.EWTimeType,ewn.EWTime,ewnp.PersonnelCode,ewnp.PersonnelSource,ewnp.DeptId,ewnp.RoleId from TbFormEarlyWarningBegTime ewt 
left join TbFormEarlyWarningNode ewn on ewt.EarlyWarningCode=ewn.EarlyWarningCode and ewt.ProjectId=ewn.ProjectId and ewt.MenuCode=ewn.MenuCode
left join TbFormEarlyWarningNodePersonnel ewnp on ewn.EarlyWarningCode=ewnp.EarlyWarningCode and ewn.EWNodeCode=ewnp.EWNodeCode and  ewn.MenuCode=ewnp.MenuCode and ewn.ProjectId=ewnp.ProjectId
left join TbCompany cp1 on ewt.BranchCode=cp1.CompanyCode
left join TbCompany cp2 on ewt.WorkAreaCode=cp2.CompanyCode
left join TbCompany cp3 on ewt.SiteCode=cp3.CompanyCode
where ewt.MenuCode='RawMonthDemandPlan') Tb 
left join (select EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId from TbFormEarlyWarningNodeInfo ewni
where ewni.EWFormDataCode=MONTH(GETDATE()) group by EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId) TbYjInfo on Tb.EarlyWarningCode=TbYjInfo.EarlyWarningCode and Tb.EWNodeCode=TbYjInfo.EWNodeCode and Tb.MenuCode=TbYjInfo.MenuCode and  Tb.YjMonth=TbYjInfo.EWFormDataCode and Tb.WorkAreaCode=TbYjInfo.WorkArea and Tb.ProjectId=TbYjInfo.ProjectId
where GETDATE()>=BegEwTiem and Tb.WorkAreaCode not in(select rmdp.WorkAreaCode from TbRawMaterialMonthDemandPlan rmdp where MONTH(InsertTime)=MONTH(GETDATE())
group by rmdp.WorkAreaCode)) TbAll where TbAll.YjCode is null and TbAll.PersonnelCode is not null and GETDATE()>=TbAll.BegEwTiemNew	


-----------------------------------------------------------------------------
2020-03-27 17:59:41
Text:	 SELECT   TOP 1 * FROM [TbSupplyList]  WHERE [TbSupplyList].[ID] = @ID157 	
Parameters:
@ID157[Int32] = 16


-----------------------------------------------------------------------------
2020-03-27 17:59:41
Text:	select a.ID,a.RawMaterialNum,a.MaterialName,a.Standard,a.MeasurementUnit,c.DictionaryText as MeasurementUnitText,a.BatchPlanQuantity,a.TechnicalRequirement,a.Remarks,a.HasSupplier,a.BatchPlanNum,a.BatchPlanItemId from TbSupplyListDetail a
left join TbSupplyList b on a.BatchPlanNum=b.BatchPlanNum 
left join TbSysDictionaryData c on a.MeasurementUnit=c.DictionaryCode where b.ID=16	


-----------------------------------------------------------------------------
2020-03-27 17:59:41
Text:	select a.ID,a.RawMaterialNum,a.MaterialName,a.Standard,a.MeasurementUnit,c.DictionaryText as MeasurementUnitText,a.BatchPlanQuantity,a.TechnicalRequirement,a.Remarks,a.HasSupplier,a.BatchPlanNum,a.BatchPlanItemId,b.ID as HistoryId,b.ThisTime,b.ThisTimeCount,b.BatchPlanItemNewCode,2 as GhType,e.BatchPlanItemNewCode as InorderId,e.PassCount,e.NoPass,e.NoPassReason,case when f.ChackState=2 then e.PassCount else 0 end Unqualified,f.Enclosure,CONVERT(varchar(100),e.ReturnTime,23) as ReturnTime from TbSupplyListDetail a
left join  TbSupplyListDetailHistory b on a.BatchPlanItemId=b.BatchPlanItemId
left join TbSysDictionaryData c on a.MeasurementUnit=c.DictionaryCode
left join TbSupplyList d on a.BatchPlanNum=d.BatchPlanNum
left join TbInOrderItem e on b.BatchPlanItemNewCode=e.BatchPlanItemNewCode 
left join TbSampleOrderItem f on e.ID=f.InOrderItemId where d.ID=16 and b.ID is not null	


-----------------------------------------------------------------------------
2020-03-27 18:00:01
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
left join TbFlowDefine d on p.FlowCode=d.FlowCode
where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
union all
select COUNT(1) as MsgCount from TbFlowPerformMessage m 
LEFT JOIN TbUser tu ON m.UserCode=tu.UserCode
where (m.usercode=@UserCode OR tu.UserId=@UserCode)and IsRead=-1
union all
select SUM(Tb.earlywarningcount) as earlywarningcount from (
select COUNT(1) as earlywarningcount from TbFlowEarlyWarningInfo where EarlyWarningBTUser=@UserCode and EarlyWarningStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)
union all
select COUNT(1) as earlywarningcount from TbFormEarlyWarningNodeInfo where EWUserCode=@UserCode and EWStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:00:56
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  and T.OrgType!=5 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:00:56
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:00:56
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:00:56
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 and T.OrgType!=5 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:00:56
Text:	select 
                               a.*,b.CompanyFullName BranchName,
                               c.CompanyFullName SiteName,d.CompanyFullName ProcessFactoryName,f.CompanyFullName as WorkAreaName,
                               e.UserName AcceptorName,g.DictionaryText RebarTypeNew,
                               h.UserName,ISNULL(i.StateCode,'未供货') as StateCode,i.ID as SupId,
                               ISNULL(i.SupplyDate, DATEADD(DAY,4,A.InsertTime)) as SupplyDate,isnull(i.HasSupplierTotal,0) as HasSupplierTotal,i.SupplyCompleteTime,case when j.DemandPlanCode is null then a.RawMaterialDemandNum else j.DemandPlanCode end DemandPlanCode,k.NoPassTotal,r.QyBhgCount,ghrk.BatchPlanNum as IsAdd,TbGhHg.PassCount
                               from TbFactoryBatchNeedPlan a
                               left join TbCompany b on a.BranchCode = b.CompanyCode 
                               left join TbCompany c on a.SiteCode=c.CompanyCode 
                               left join TbCompany d on a.ProcessFactoryCode=d.CompanyCode 
                               left join TbCompany f on a.WorkAreaCode=f.CompanyCode 
                               left join TbUser e on a.Acceptor=e.UserCode  
                               left join TbSysDictionaryData g on a.SteelsTypeCode=g.DictionaryCode and g.FDictionaryCode='RebarType' 
                               left join TbUser h on a.InsertUserCode=h.UserCode
                               LEFT JOIN TbSupplyList i ON a.BatchPlanNum=i.BatchPlanNum
							   left join TbRawMaterialMonthDemandSupplyPlan j on a.RawMaterialDemandNum=j.SupplyPlanCode
							   left join (select BatchPlanCode,sum(NoPassTotal) as NoPassTotal from TbInOrder group by BatchPlanCode) k on  a.BatchPlanNum=k.BatchPlanCode
                               left join (select io.BatchPlanCode,sum(ioi.PassCount) as QyBhgCount from TbSampleOrder  so
                               left join TbSampleOrderItem soi on so.SampleOrderCode=soi.SampleOrderCode
                               left join TbInOrderItem ioi on soi.InOrderItemId=ioi.ID
                               left join TbInOrder io on so.InOrderCode=io.InOrderCode
                               where (so.ChackResult=2 or so.ChackResult=3) and soi.ChackState=2
                               group by io.BatchPlanCode) r on a.BatchPlanNum=r.BatchPlanCode 
							   left join(select a.BatchPlanNum from TbSupplyListDetailHistory a
							   left join TbInOrderItem b on a.BatchPlanItemNewCode=b.BatchPlanItemNewCode where b.BatchPlanItemNewCode is null group by a.BatchPlanNum) ghrk on a.BatchPlanNum=ghrk.BatchPlanNum
							   left join(select TbGhHg.BatchPlanCode,sum(TbGhHg.PassCount) as PassCount from (select a.BatchPlanCode,case when c.ChackState=2 then 0 else b.PassCount end PassCount from TbInOrder a
                               left join TbInOrderItem b on a.InOrderCode=b.InOrderCode
                               left join TbSampleOrderItem c on b.ID=c.InOrderItemId) TbGhHg  group by TbGhHg.BatchPlanCode) TbGhHg on a.BatchPlanNum=TbGhHg.BatchPlanCode
							   where 1=1  and a.ProcessFactoryCode='6386683729561128960' and a.ProjectId='6245721945602523136' and (a.SiteCode in('6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896') or a.WorkAreaCode in('6276140381243441152'))	


-----------------------------------------------------------------------------
2020-03-27 18:00:56
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by BatchPlanNum desc)AS Row, * from (select 
                               a.*,b.CompanyFullName BranchName,
                               c.CompanyFullName SiteName,d.CompanyFullName ProcessFactoryName,f.CompanyFullName as WorkAreaName,
                               e.UserName AcceptorName,g.DictionaryText RebarTypeNew,
                               h.UserName,ISNULL(i.StateCode,'未供货') as StateCode,i.ID as SupId,
                               ISNULL(i.SupplyDate, DATEADD(DAY,4,A.InsertTime)) as SupplyDate,isnull(i.HasSupplierTotal,0) as HasSupplierTotal,i.SupplyCompleteTime,case when j.DemandPlanCode is null then a.RawMaterialDemandNum else j.DemandPlanCode end DemandPlanCode,k.NoPassTotal,r.QyBhgCount,ghrk.BatchPlanNum as IsAdd,TbGhHg.PassCount
                               from TbFactoryBatchNeedPlan a
                               left join TbCompany b on a.BranchCode = b.CompanyCode 
                               left join TbCompany c on a.SiteCode=c.CompanyCode 
                               left join TbCompany d on a.ProcessFactoryCode=d.CompanyCode 
                               left join TbCompany f on a.WorkAreaCode=f.CompanyCode 
                               left join TbUser e on a.Acceptor=e.UserCode  
                               left join TbSysDictionaryData g on a.SteelsTypeCode=g.DictionaryCode and g.FDictionaryCode='RebarType' 
                               left join TbUser h on a.InsertUserCode=h.UserCode
                               LEFT JOIN TbSupplyList i ON a.BatchPlanNum=i.BatchPlanNum
							   left join TbRawMaterialMonthDemandSupplyPlan j on a.RawMaterialDemandNum=j.SupplyPlanCode
							   left join (select BatchPlanCode,sum(NoPassTotal) as NoPassTotal from TbInOrder group by BatchPlanCode) k on  a.BatchPlanNum=k.BatchPlanCode
                               left join (select io.BatchPlanCode,sum(ioi.PassCount) as QyBhgCount from TbSampleOrder  so
                               left join TbSampleOrderItem soi on so.SampleOrderCode=soi.SampleOrderCode
                               left join TbInOrderItem ioi on soi.InOrderItemId=ioi.ID
                               left join TbInOrder io on so.InOrderCode=io.InOrderCode
                               where (so.ChackResult=2 or so.ChackResult=3) and soi.ChackState=2
                               group by io.BatchPlanCode) r on a.BatchPlanNum=r.BatchPlanCode 
							   left join(select a.BatchPlanNum from TbSupplyListDetailHistory a
							   left join TbInOrderItem b on a.BatchPlanItemNewCode=b.BatchPlanItemNewCode where b.BatchPlanItemNewCode is null group by a.BatchPlanNum) ghrk on a.BatchPlanNum=ghrk.BatchPlanNum
							   left join(select TbGhHg.BatchPlanCode,sum(TbGhHg.PassCount) as PassCount from (select a.BatchPlanCode,case when c.ChackState=2 then 0 else b.PassCount end PassCount from TbInOrder a
                               left join TbInOrderItem b on a.InOrderCode=b.InOrderCode
                               left join TbSampleOrderItem c on b.ID=c.InOrderItemId) TbGhHg  group by TbGhHg.BatchPlanCode) TbGhHg on a.BatchPlanNum=TbGhHg.BatchPlanCode
							   where 1=1  and a.ProcessFactoryCode='6386683729561128960' and a.ProjectId='6245721945602523136' and (a.SiteCode in('6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896') or a.WorkAreaCode in('6276140381243441152'))) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-03-27 18:01:08
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  and T.OrgType!=5 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:01:08
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:01:08
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 and T.OrgType!=5 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:01:08
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:01:08
Text:	select 
                               a.*,b.CompanyFullName BranchName,
                               c.CompanyFullName SiteName,d.CompanyFullName ProcessFactoryName,f.CompanyFullName as WorkAreaName,
                               e.UserName AcceptorName,g.DictionaryText RebarTypeNew,
                               h.UserName,ISNULL(i.StateCode,'未供货') as StateCode,i.ID as SupId,
                               ISNULL(i.SupplyDate, DATEADD(DAY,4,A.InsertTime)) as SupplyDate,isnull(i.HasSupplierTotal,0) as HasSupplierTotal,i.SupplyCompleteTime,case when j.DemandPlanCode is null then a.RawMaterialDemandNum else j.DemandPlanCode end DemandPlanCode,k.NoPassTotal,r.QyBhgCount,ghrk.BatchPlanNum as IsAdd,TbGhHg.PassCount
                               from TbFactoryBatchNeedPlan a
                               left join TbCompany b on a.BranchCode = b.CompanyCode 
                               left join TbCompany c on a.SiteCode=c.CompanyCode 
                               left join TbCompany d on a.ProcessFactoryCode=d.CompanyCode 
                               left join TbCompany f on a.WorkAreaCode=f.CompanyCode 
                               left join TbUser e on a.Acceptor=e.UserCode  
                               left join TbSysDictionaryData g on a.SteelsTypeCode=g.DictionaryCode and g.FDictionaryCode='RebarType' 
                               left join TbUser h on a.InsertUserCode=h.UserCode
                               LEFT JOIN TbSupplyList i ON a.BatchPlanNum=i.BatchPlanNum
							   left join TbRawMaterialMonthDemandSupplyPlan j on a.RawMaterialDemandNum=j.SupplyPlanCode
							   left join (select BatchPlanCode,sum(NoPassTotal) as NoPassTotal from TbInOrder group by BatchPlanCode) k on  a.BatchPlanNum=k.BatchPlanCode
                               left join (select io.BatchPlanCode,sum(ioi.PassCount) as QyBhgCount from TbSampleOrder  so
                               left join TbSampleOrderItem soi on so.SampleOrderCode=soi.SampleOrderCode
                               left join TbInOrderItem ioi on soi.InOrderItemId=ioi.ID
                               left join TbInOrder io on so.InOrderCode=io.InOrderCode
                               where (so.ChackResult=2 or so.ChackResult=3) and soi.ChackState=2
                               group by io.BatchPlanCode) r on a.BatchPlanNum=r.BatchPlanCode 
							   left join(select a.BatchPlanNum from TbSupplyListDetailHistory a
							   left join TbInOrderItem b on a.BatchPlanItemNewCode=b.BatchPlanItemNewCode where b.BatchPlanItemNewCode is null group by a.BatchPlanNum) ghrk on a.BatchPlanNum=ghrk.BatchPlanNum
							   left join(select TbGhHg.BatchPlanCode,sum(TbGhHg.PassCount) as PassCount from (select a.BatchPlanCode,case when c.ChackState=2 then 0 else b.PassCount end PassCount from TbInOrder a
                               left join TbInOrderItem b on a.InOrderCode=b.InOrderCode
                               left join TbSampleOrderItem c on b.ID=c.InOrderItemId) TbGhHg  group by TbGhHg.BatchPlanCode) TbGhHg on a.BatchPlanNum=TbGhHg.BatchPlanCode
							   where 1=1  and a.ProcessFactoryCode='6386683729561128960' and a.ProjectId='6245721945602523136' and (a.SiteCode in('6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896') or a.WorkAreaCode in('6276140381243441152'))	


-----------------------------------------------------------------------------
2020-03-27 18:01:08
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by BatchPlanNum desc)AS Row, * from (select 
                               a.*,b.CompanyFullName BranchName,
                               c.CompanyFullName SiteName,d.CompanyFullName ProcessFactoryName,f.CompanyFullName as WorkAreaName,
                               e.UserName AcceptorName,g.DictionaryText RebarTypeNew,
                               h.UserName,ISNULL(i.StateCode,'未供货') as StateCode,i.ID as SupId,
                               ISNULL(i.SupplyDate, DATEADD(DAY,4,A.InsertTime)) as SupplyDate,isnull(i.HasSupplierTotal,0) as HasSupplierTotal,i.SupplyCompleteTime,case when j.DemandPlanCode is null then a.RawMaterialDemandNum else j.DemandPlanCode end DemandPlanCode,k.NoPassTotal,r.QyBhgCount,ghrk.BatchPlanNum as IsAdd,TbGhHg.PassCount
                               from TbFactoryBatchNeedPlan a
                               left join TbCompany b on a.BranchCode = b.CompanyCode 
                               left join TbCompany c on a.SiteCode=c.CompanyCode 
                               left join TbCompany d on a.ProcessFactoryCode=d.CompanyCode 
                               left join TbCompany f on a.WorkAreaCode=f.CompanyCode 
                               left join TbUser e on a.Acceptor=e.UserCode  
                               left join TbSysDictionaryData g on a.SteelsTypeCode=g.DictionaryCode and g.FDictionaryCode='RebarType' 
                               left join TbUser h on a.InsertUserCode=h.UserCode
                               LEFT JOIN TbSupplyList i ON a.BatchPlanNum=i.BatchPlanNum
							   left join TbRawMaterialMonthDemandSupplyPlan j on a.RawMaterialDemandNum=j.SupplyPlanCode
							   left join (select BatchPlanCode,sum(NoPassTotal) as NoPassTotal from TbInOrder group by BatchPlanCode) k on  a.BatchPlanNum=k.BatchPlanCode
                               left join (select io.BatchPlanCode,sum(ioi.PassCount) as QyBhgCount from TbSampleOrder  so
                               left join TbSampleOrderItem soi on so.SampleOrderCode=soi.SampleOrderCode
                               left join TbInOrderItem ioi on soi.InOrderItemId=ioi.ID
                               left join TbInOrder io on so.InOrderCode=io.InOrderCode
                               where (so.ChackResult=2 or so.ChackResult=3) and soi.ChackState=2
                               group by io.BatchPlanCode) r on a.BatchPlanNum=r.BatchPlanCode 
							   left join(select a.BatchPlanNum from TbSupplyListDetailHistory a
							   left join TbInOrderItem b on a.BatchPlanItemNewCode=b.BatchPlanItemNewCode where b.BatchPlanItemNewCode is null group by a.BatchPlanNum) ghrk on a.BatchPlanNum=ghrk.BatchPlanNum
							   left join(select TbGhHg.BatchPlanCode,sum(TbGhHg.PassCount) as PassCount from (select a.BatchPlanCode,case when c.ChackState=2 then 0 else b.PassCount end PassCount from TbInOrder a
                               left join TbInOrderItem b on a.InOrderCode=b.InOrderCode
                               left join TbSampleOrderItem c on b.ID=c.InOrderItemId) TbGhHg  group by TbGhHg.BatchPlanCode) TbGhHg on a.BatchPlanNum=TbGhHg.BatchPlanCode
							   where 1=1  and a.ProcessFactoryCode='6386683729561128960' and a.ProjectId='6245721945602523136' and (a.SiteCode in('6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896') or a.WorkAreaCode in('6276140381243441152'))) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-03-27 18:03:01
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
left join TbFlowDefine d on p.FlowCode=d.FlowCode
where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
union all
select COUNT(1) as MsgCount from TbFlowPerformMessage m 
LEFT JOIN TbUser tu ON m.UserCode=tu.UserCode
where (m.usercode=@UserCode OR tu.UserId=@UserCode)and IsRead=-1
union all
select SUM(Tb.earlywarningcount) as earlywarningcount from (
select COUNT(1) as earlywarningcount from TbFlowEarlyWarningInfo where EarlyWarningBTUser=@UserCode and EarlyWarningStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)
union all
select COUNT(1) as earlywarningcount from TbFormEarlyWarningNodeInfo where EWUserCode=@UserCode and EWStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:04:29
Text:	select TbAll.EarlyWarningCode,TbAll.BranchCode,TbAll.BranchName,TbAll.WorkAreaCode,TbAll.WorkAreaName,TbAll.SiteCode,TbAll.SiteName,TbAll.ProjectId,TbAll.YjMonth,TbAll.MenuCode,TbAll.EWNodeCode,TbAll.EWNodeName,TbAll.PersonnelCode,TbAll.PersonnelSource,TbAll.BegEwTiemNew from (select Tb.*,case when Tb.EWTimeType='年' then DATEADD(YEAR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='月' then DATEADD(MONTH,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='天' then DATEADD(DAY,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='时' then DATEADD(HOUR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='分' then DATEADD(MINUTE,Tb.EWTime,Tb.BegEwTiem) end as BegEwTiemNew,TbYjInfo.EarlyWarningCode as YjCode from (select ewt.EarlyWarningCode,DATENAME(year,GETDATE())+'-'+ DATENAME(MONTH,GETDATE())+'-'+ CONVERT(varchar(20),ewt.EWBegDay)+' '+CONVERT(varchar(20),ewt.EWBegHour)+':'+CONVERT(varchar(20),ewt.EWBegMinute)+':00' as BegEwTiem,ewt.BranchCode,cp1.CompanyFullName as BranchName,ewt.WorkAreaCode,cp2.CompanyFullName as WorkAreaName,ewt.SiteCode,cp3.CompanyFullName as SiteName,ewt.ProjectId,MONTH(GETDATE()) as YjMonth,ewt.MenuCode,ewn.EWNodeCode,ewn.EWNodeName,ewn.EWTimeType,ewn.EWTime,ewnp.PersonnelCode,ewnp.PersonnelSource,ewnp.DeptId,ewnp.RoleId from TbFormEarlyWarningBegTime ewt 
left join TbFormEarlyWarningNode ewn on ewt.EarlyWarningCode=ewn.EarlyWarningCode and ewt.ProjectId=ewn.ProjectId and ewt.MenuCode=ewn.MenuCode
left join TbFormEarlyWarningNodePersonnel ewnp on ewn.EarlyWarningCode=ewnp.EarlyWarningCode and ewn.EWNodeCode=ewnp.EWNodeCode and  ewn.MenuCode=ewnp.MenuCode and ewn.ProjectId=ewnp.ProjectId
left join TbCompany cp1 on ewt.BranchCode=cp1.CompanyCode
left join TbCompany cp2 on ewt.WorkAreaCode=cp2.CompanyCode
left join TbCompany cp3 on ewt.SiteCode=cp3.CompanyCode
where ewt.MenuCode='RawMonthDemandPlan') Tb 
left join (select EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId from TbFormEarlyWarningNodeInfo ewni
where ewni.EWFormDataCode=MONTH(GETDATE()) group by EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId) TbYjInfo on Tb.EarlyWarningCode=TbYjInfo.EarlyWarningCode and Tb.EWNodeCode=TbYjInfo.EWNodeCode and Tb.MenuCode=TbYjInfo.MenuCode and  Tb.YjMonth=TbYjInfo.EWFormDataCode and Tb.WorkAreaCode=TbYjInfo.WorkArea and Tb.ProjectId=TbYjInfo.ProjectId
where GETDATE()>=BegEwTiem and Tb.WorkAreaCode not in(select rmdp.WorkAreaCode from TbRawMaterialMonthDemandPlan rmdp where MONTH(InsertTime)=MONTH(GETDATE())
group by rmdp.WorkAreaCode)) TbAll where TbAll.YjCode is null and TbAll.PersonnelCode is not null and GETDATE()>=TbAll.BegEwTiemNew	


-----------------------------------------------------------------------------
2020-03-27 18:06:01
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
left join TbFlowDefine d on p.FlowCode=d.FlowCode
where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
union all
select COUNT(1) as MsgCount from TbFlowPerformMessage m 
LEFT JOIN TbUser tu ON m.UserCode=tu.UserCode
where (m.usercode=@UserCode OR tu.UserId=@UserCode)and IsRead=-1
union all
select SUM(Tb.earlywarningcount) as earlywarningcount from (
select COUNT(1) as earlywarningcount from TbFlowEarlyWarningInfo where EarlyWarningBTUser=@UserCode and EarlyWarningStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)
union all
select COUNT(1) as earlywarningcount from TbFormEarlyWarningNodeInfo where EWUserCode=@UserCode and EWStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:03
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  and T.OrgType!=5 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:03
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:03
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6276140381243441152
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:03
Text:	select 
                               a.*,b.CompanyFullName BranchName,
                               c.CompanyFullName SiteName,d.CompanyFullName ProcessFactoryName,f.CompanyFullName as WorkAreaName,
                               e.UserName AcceptorName,g.DictionaryText RebarTypeNew,
                               h.UserName,ISNULL(i.StateCode,'未供货') as StateCode,i.ID as SupId,
                               ISNULL(i.SupplyDate, DATEADD(DAY,4,A.InsertTime)) as SupplyDate,isnull(i.HasSupplierTotal,0) as HasSupplierTotal,i.SupplyCompleteTime,case when j.DemandPlanCode is null then a.RawMaterialDemandNum else j.DemandPlanCode end DemandPlanCode,k.NoPassTotal,r.QyBhgCount,ghrk.BatchPlanNum as IsAdd,TbGhHg.PassCount
                               from TbFactoryBatchNeedPlan a
                               left join TbCompany b on a.BranchCode = b.CompanyCode 
                               left join TbCompany c on a.SiteCode=c.CompanyCode 
                               left join TbCompany d on a.ProcessFactoryCode=d.CompanyCode 
                               left join TbCompany f on a.WorkAreaCode=f.CompanyCode 
                               left join TbUser e on a.Acceptor=e.UserCode  
                               left join TbSysDictionaryData g on a.SteelsTypeCode=g.DictionaryCode and g.FDictionaryCode='RebarType' 
                               left join TbUser h on a.InsertUserCode=h.UserCode
                               LEFT JOIN TbSupplyList i ON a.BatchPlanNum=i.BatchPlanNum
							   left join TbRawMaterialMonthDemandSupplyPlan j on a.RawMaterialDemandNum=j.SupplyPlanCode
							   left join (select BatchPlanCode,sum(NoPassTotal) as NoPassTotal from TbInOrder group by BatchPlanCode) k on  a.BatchPlanNum=k.BatchPlanCode
                               left join (select io.BatchPlanCode,sum(ioi.PassCount) as QyBhgCount from TbSampleOrder  so
                               left join TbSampleOrderItem soi on so.SampleOrderCode=soi.SampleOrderCode
                               left join TbInOrderItem ioi on soi.InOrderItemId=ioi.ID
                               left join TbInOrder io on so.InOrderCode=io.InOrderCode
                               where (so.ChackResult=2 or so.ChackResult=3) and soi.ChackState=2
                               group by io.BatchPlanCode) r on a.BatchPlanNum=r.BatchPlanCode 
							   left join(select a.BatchPlanNum from TbSupplyListDetailHistory a
							   left join TbInOrderItem b on a.BatchPlanItemNewCode=b.BatchPlanItemNewCode where b.BatchPlanItemNewCode is null group by a.BatchPlanNum) ghrk on a.BatchPlanNum=ghrk.BatchPlanNum
							   left join(select TbGhHg.BatchPlanCode,sum(TbGhHg.PassCount) as PassCount from (select a.BatchPlanCode,case when c.ChackState=2 then 0 else b.PassCount end PassCount from TbInOrder a
                               left join TbInOrderItem b on a.InOrderCode=b.InOrderCode
                               left join TbSampleOrderItem c on b.ID=c.InOrderItemId) TbGhHg  group by TbGhHg.BatchPlanCode) TbGhHg on a.BatchPlanNum=TbGhHg.BatchPlanCode
							   where 1=1  and a.ProcessFactoryCode='6386683729561128960' and a.ProjectId='6245721945602523136' and (a.SiteCode in('6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896') or a.WorkAreaCode in('6276140381243441152'))	


-----------------------------------------------------------------------------
2020-03-27 18:06:03
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 and T.OrgType!=5 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:04
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by BatchPlanNum desc)AS Row, * from (select 
                               a.*,b.CompanyFullName BranchName,
                               c.CompanyFullName SiteName,d.CompanyFullName ProcessFactoryName,f.CompanyFullName as WorkAreaName,
                               e.UserName AcceptorName,g.DictionaryText RebarTypeNew,
                               h.UserName,ISNULL(i.StateCode,'未供货') as StateCode,i.ID as SupId,
                               ISNULL(i.SupplyDate, DATEADD(DAY,4,A.InsertTime)) as SupplyDate,isnull(i.HasSupplierTotal,0) as HasSupplierTotal,i.SupplyCompleteTime,case when j.DemandPlanCode is null then a.RawMaterialDemandNum else j.DemandPlanCode end DemandPlanCode,k.NoPassTotal,r.QyBhgCount,ghrk.BatchPlanNum as IsAdd,TbGhHg.PassCount
                               from TbFactoryBatchNeedPlan a
                               left join TbCompany b on a.BranchCode = b.CompanyCode 
                               left join TbCompany c on a.SiteCode=c.CompanyCode 
                               left join TbCompany d on a.ProcessFactoryCode=d.CompanyCode 
                               left join TbCompany f on a.WorkAreaCode=f.CompanyCode 
                               left join TbUser e on a.Acceptor=e.UserCode  
                               left join TbSysDictionaryData g on a.SteelsTypeCode=g.DictionaryCode and g.FDictionaryCode='RebarType' 
                               left join TbUser h on a.InsertUserCode=h.UserCode
                               LEFT JOIN TbSupplyList i ON a.BatchPlanNum=i.BatchPlanNum
							   left join TbRawMaterialMonthDemandSupplyPlan j on a.RawMaterialDemandNum=j.SupplyPlanCode
							   left join (select BatchPlanCode,sum(NoPassTotal) as NoPassTotal from TbInOrder group by BatchPlanCode) k on  a.BatchPlanNum=k.BatchPlanCode
                               left join (select io.BatchPlanCode,sum(ioi.PassCount) as QyBhgCount from TbSampleOrder  so
                               left join TbSampleOrderItem soi on so.SampleOrderCode=soi.SampleOrderCode
                               left join TbInOrderItem ioi on soi.InOrderItemId=ioi.ID
                               left join TbInOrder io on so.InOrderCode=io.InOrderCode
                               where (so.ChackResult=2 or so.ChackResult=3) and soi.ChackState=2
                               group by io.BatchPlanCode) r on a.BatchPlanNum=r.BatchPlanCode 
							   left join(select a.BatchPlanNum from TbSupplyListDetailHistory a
							   left join TbInOrderItem b on a.BatchPlanItemNewCode=b.BatchPlanItemNewCode where b.BatchPlanItemNewCode is null group by a.BatchPlanNum) ghrk on a.BatchPlanNum=ghrk.BatchPlanNum
							   left join(select TbGhHg.BatchPlanCode,sum(TbGhHg.PassCount) as PassCount from (select a.BatchPlanCode,case when c.ChackState=2 then 0 else b.PassCount end PassCount from TbInOrder a
                               left join TbInOrderItem b on a.InOrderCode=b.InOrderCode
                               left join TbSampleOrderItem c on b.ID=c.InOrderItemId) TbGhHg  group by TbGhHg.BatchPlanCode) TbGhHg on a.BatchPlanNum=TbGhHg.BatchPlanCode
							   where 1=1  and a.ProcessFactoryCode='6386683729561128960' and a.ProjectId='6245721945602523136' and (a.SiteCode in('6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896') or a.WorkAreaCode in('6276140381243441152'))) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274027775095472128
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274027775095472128
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode164) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode165))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus166)) 	
Parameters:
@ProcessFactoryCode164[String] = 6386683729561128960
@SiteCode165[String] = 6274027775095472128
@Examinestatus166[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274027775095472128
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode159) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode167))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus168)) 	
Parameters:
@ProcessFactoryCode159[String] = 6386683729561128960
@SiteCode167[String] = 6274027775095472128
@Examinestatus168[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode169)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode169[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode170)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode170[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE ((((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode158)) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode160))) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState161,@ProcessingState162,@ProcessingState163))) 	
Parameters:
@ProcessFactoryCode158[String] = 6386683729561128960
@SiteCode160[String] = 6274027775095472128
@ProcessingState161[String] = Processing
@ProcessingState162[String] = Received
@ProcessingState163[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat171) 	
Parameters:
@DaetailWorkStrat171[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[OrderCode] IN (@OrderCode172)) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime173)))) 	
Parameters:
@OrderCode172[String] = JGDD202000001
@DistributionTime173[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	 SELECT   [TbDistributionPlanInfo].[DistributionStart] FROM [TbDistributionPlanInfo]  WHERE ([TbDistributionPlanInfo].[OrderCode] IN (@OrderCode174)) 	
Parameters:
@OrderCode174[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	 SELECT   [TbDistributionEntOrder].* FROM [TbDistributionEntOrder] LEFT OUTER JOIN [TbDistributionEnt] ON ([TbDistributionEntOrder].[DistributionCode] = [TbDistributionEnt].[DistributionCode])  WHERE ([TbDistributionEntOrder].[OrderCode] IN (@OrderCode175)) 	
Parameters:
@OrderCode175[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274027775095472128
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	 SELECT   [TbOrderProgress].[ProcessingState],[TbOrderProgress].[FinishProcessingDateTime],[TbOrderProgress].[DistributionTime],[TbOrderProgress].[SiteCode] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[SiteCode] IN (@SiteCode176,@SiteCode177,@SiteCode178,@SiteCode179,@SiteCode180,@SiteCode181,@SiteCode182,@SiteCode183,@SiteCode184,@SiteCode185,@SiteCode186,@SiteCode187,@SiteCode188,@SiteCode189,@SiteCode190,@SiteCode191,@SiteCode192,@SiteCode193,@SiteCode194,@SiteCode195,@SiteCode196,@SiteCode197,@SiteCode198,@SiteCode199,@SiteCode200,@SiteCode201,@SiteCode202,@SiteCode203,@SiteCode204,@SiteCode205,@SiteCode206,@SiteCode207,@SiteCode208,@SiteCode209,@SiteCode210,@SiteCode211,@SiteCode212,@SiteCode213,@SiteCode214,@SiteCode215,@SiteCode216,@SiteCode217,@SiteCode218,@SiteCode219,@SiteCode220,@SiteCode221,@SiteCode222,@SiteCode223,@SiteCode224,@SiteCode225,@SiteCode226,@SiteCode227,@SiteCode228,@SiteCode229,@SiteCode230,@SiteCode231,@SiteCode232,@SiteCode233,@SiteCode234,@SiteCode235,@SiteCode236,@SiteCode237,@SiteCode238,@SiteCode239,@SiteCode240,@SiteCode241,@SiteCode242,@SiteCode243,@SiteCode244,@SiteCode245,@SiteCode246)) AND (YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=3)) 	
Parameters:
@SiteCode176[String] = 6274027775095472128
@SiteCode177[String] = 6274027929433276416
@SiteCode178[String] = 6417410523612188672
@SiteCode179[String] = 6274028333340557312
@SiteCode180[String] = 6274028829845487616
@SiteCode181[String] = 6274029086029381632
@SiteCode182[String] = 6274029528142577664
@SiteCode183[String] = 6274029966388625408
@SiteCode184[String] = 6274030152053686272
@SiteCode185[String] = 6274030373047369728
@SiteCode186[String] = 6274030913332445184
@SiteCode187[String] = 6267789807737372672
@SiteCode188[String] = 6267790255894560768
@SiteCode189[String] = 6267790460492709888
@SiteCode190[String] = 6267790574804271104
@SiteCode191[String] = 6267791036517449728
@SiteCode192[String] = 6267791338536697856
@SiteCode193[String] = 6267791654132908032
@SiteCode194[String] = 6267790081113718784
@SiteCode195[String] = 6267790783294734336
@SiteCode196[String] = 6267791210027417600
@SiteCode197[String] = 6267791528110850048
@SiteCode198[String] = 6437059801301262336
@SiteCode199[String] = 6308426901824208896
@SiteCode200[String] = 6276140742482067456
@SiteCode201[String] = 6276141050964738048
@SiteCode202[String] = 6276141450283450368
@SiteCode203[String] = 6276141737463250944
@SiteCode204[String] = 6276141926932545536
@SiteCode205[String] = 6267796592825204736
@SiteCode206[String] = 6267796864196673536
@SiteCode207[String] = 6267797037211713536
@SiteCode208[String] = 6267797181319610368
@SiteCode209[String] = 6276760608893304832
@SiteCode210[String] = 6267798187931598848
@SiteCode211[String] = 6267798388054425600
@SiteCode212[String] = 6267749616851091456
@SiteCode213[String] = 6267750471750909952
@SiteCode214[String] = 6267750709144322048
@SiteCode215[String] = 6267750895786655744
@SiteCode216[String] = 6267751010588950528
@SiteCode217[String] = 6267753037104676864
@SiteCode218[String] = 6267754200801738752
@SiteCode219[String] = 6267754324688896000
@SiteCode220[String] = 6267797518566817792
@SiteCode221[String] = 6267783175129268224
@SiteCode222[String] = 6267783320914886656
@SiteCode223[String] = 6267783444885929984
@SiteCode224[String] = 6267783577954418688
@SiteCode225[String] = 6267784612617912320
@SiteCode226[String] = 6267785016667799552
@SiteCode227[String] = 6267785185136214016
@SiteCode228[String] = 6267785381991677952
@SiteCode229[String] = 6267785590951903232
@SiteCode230[String] = 6267785762842869760
@SiteCode231[String] = 6267793585479876608
@SiteCode232[String] = 6267793380881727488
@SiteCode233[String] = 6437060915425845248
@SiteCode234[String] = 6284878460246556672
@SiteCode235[String] = 6284879065547538432
@SiteCode236[String] = 6285119541664022528
@SiteCode237[String] = 6285120302351384576
@SiteCode238[String] = 6285181647230861312
@SiteCode239[String] = 6285120520983674880
@SiteCode240[String] = 6285120866493661184
@SiteCode241[String] = 6285121357168508928
@SiteCode242[String] = 6285122203776188416
@SiteCode243[String] = 6437059163368595456
@SiteCode244[String] = 6374383547544903680
@SiteCode245[String] = 6374384032955899904
@SiteCode246[String] = 6374384202665828352


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode248) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode249))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus250)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode248[String] = 6386683729561128960
@WorkAreaCode249[String] = 6274027775095472128
@Examinestatus250[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274027775095472128
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274027775095472128
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274027775095472128
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274027775095472128
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE ((([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode252) AND ([TbRawMaterialStockRecord].[WorkAreaCode] IN (@WorkAreaCode259))) AND ([TbRawMaterialArchives].[RebarType] = @RebarType260)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode252[String] = 6386683729561128960
@WorkAreaCode259[String] = 6274027775095472128
@RebarType260[String] = BuildingSteel


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode253) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode261))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus262)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode253[String] = 6386683729561128960
@WorkAreaCode261[String] = 6274027775095472128
@Examinestatus262[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode258) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode263))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus264)) 	
Parameters:
@ProcessFactoryCode258[String] = 6386683729561128960
@SiteCode263[String] = 6274027775095472128
@Examinestatus264[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode266)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode266[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE ((((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode251)) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode254))) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState255,@ProcessingState256,@ProcessingState257))) 	
Parameters:
@ProcessFactoryCode251[String] = 6386683729561128960
@SiteCode254[String] = 6274027775095472128
@ProcessingState255[String] = Processing
@ProcessingState256[String] = Received
@ProcessingState257[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274027775095472128
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode265) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode267))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus268)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode265[String] = 6386683729561128960
@WorkAreaCode267[String] = 6274027775095472128
@Examinestatus268[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274027775095472128
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat270) 	
Parameters:
@DaetailWorkStrat270[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE ((([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode269) AND ([TbRawMaterialStockRecord].[WorkAreaCode] IN (@WorkAreaCode271))) AND ([TbRawMaterialArchives].[RebarType] = @RebarType272)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode269[String] = 6386683729561128960
@WorkAreaCode271[String] = 6274027775095472128
@RebarType272[String] = SectionSteel


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[OrderCode] IN (@OrderCode273)) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime274)))) 	
Parameters:
@OrderCode273[String] = JGDD202000001
@DistributionTime274[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 18:06:13
Text:	 SELECT count(*) as r_cnt FROM [TbDistributionPlanInfo] WHERE (([TbDistributionPlanInfo].[OrderCode] IN (@OrderCode275)) AND ((DistributionStart='配送完成' and DATEPART(day,DeliveryCompleteTime)>DATEPART(day,DistributionTime)) or (DistributionStart='未配送' and DistributionTime>GETDATE())))	
Parameters:
@OrderCode275[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025879437836288
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025879437836288
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode277) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode278,@SiteCode279,@SiteCode280,@SiteCode281))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus282)) 	
Parameters:
@ProcessFactoryCode277[String] = 6386683729561128960
@SiteCode278[String] = 6274027775095472128
@SiteCode279[String] = 6274027929433276416
@SiteCode280[String] = 6274028333340557312
@SiteCode281[String] = 6417410523612188672
@Examinestatus282[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025879437836288
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode290) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode291,@SiteCode292,@SiteCode293,@SiteCode294))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus295)) 	
Parameters:
@ProcessFactoryCode290[String] = 6386683729561128960
@SiteCode291[String] = 6274027775095472128
@SiteCode292[String] = 6274027929433276416
@SiteCode293[String] = 6274028333340557312
@SiteCode294[String] = 6417410523612188672
@Examinestatus295[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode296)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode296[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode297)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode297[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE ((((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode276)) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode283,@SiteCode284,@SiteCode285,@SiteCode286))) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState287,@ProcessingState288,@ProcessingState289))) 	
Parameters:
@ProcessFactoryCode276[String] = 6386683729561128960
@SiteCode283[String] = 6274027775095472128
@SiteCode284[String] = 6274027929433276416
@SiteCode285[String] = 6274028333340557312
@SiteCode286[String] = 6417410523612188672
@ProcessingState287[String] = Processing
@ProcessingState288[String] = Received
@ProcessingState289[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat298) 	
Parameters:
@DaetailWorkStrat298[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[OrderCode] IN (@OrderCode299)) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime300)))) 	
Parameters:
@OrderCode299[String] = JGDD202000001
@DistributionTime300[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	 SELECT   [TbDistributionPlanInfo].[DistributionStart] FROM [TbDistributionPlanInfo]  WHERE ([TbDistributionPlanInfo].[OrderCode] IN (@OrderCode301)) 	
Parameters:
@OrderCode301[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	 SELECT   [TbDistributionEntOrder].* FROM [TbDistributionEntOrder] LEFT OUTER JOIN [TbDistributionEnt] ON ([TbDistributionEntOrder].[DistributionCode] = [TbDistributionEnt].[DistributionCode])  WHERE ([TbDistributionEntOrder].[OrderCode] IN (@OrderCode302)) 	
Parameters:
@OrderCode302[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025879437836288
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	 SELECT   [TbOrderProgress].[ProcessingState],[TbOrderProgress].[FinishProcessingDateTime],[TbOrderProgress].[DistributionTime],[TbOrderProgress].[SiteCode] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[SiteCode] IN (@SiteCode303,@SiteCode304,@SiteCode305,@SiteCode306,@SiteCode307,@SiteCode308,@SiteCode309,@SiteCode310,@SiteCode311,@SiteCode312,@SiteCode313,@SiteCode314,@SiteCode315,@SiteCode316,@SiteCode317,@SiteCode318,@SiteCode319,@SiteCode320,@SiteCode321,@SiteCode322,@SiteCode323,@SiteCode324,@SiteCode325,@SiteCode326,@SiteCode327,@SiteCode328,@SiteCode329,@SiteCode330,@SiteCode331,@SiteCode332,@SiteCode333,@SiteCode334,@SiteCode335,@SiteCode336,@SiteCode337,@SiteCode338,@SiteCode339,@SiteCode340,@SiteCode341,@SiteCode342,@SiteCode343,@SiteCode344,@SiteCode345,@SiteCode346,@SiteCode347,@SiteCode348,@SiteCode349,@SiteCode350,@SiteCode351,@SiteCode352,@SiteCode353,@SiteCode354,@SiteCode355,@SiteCode356,@SiteCode357,@SiteCode358,@SiteCode359,@SiteCode360,@SiteCode361,@SiteCode362,@SiteCode363,@SiteCode364,@SiteCode365,@SiteCode366,@SiteCode367,@SiteCode368,@SiteCode369,@SiteCode370,@SiteCode371,@SiteCode372,@SiteCode373)) AND (YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=3)) 	
Parameters:
@SiteCode303[String] = 6274027775095472128
@SiteCode304[String] = 6274027929433276416
@SiteCode305[String] = 6417410523612188672
@SiteCode306[String] = 6274028333340557312
@SiteCode307[String] = 6274028829845487616
@SiteCode308[String] = 6274029086029381632
@SiteCode309[String] = 6274029528142577664
@SiteCode310[String] = 6274029966388625408
@SiteCode311[String] = 6274030152053686272
@SiteCode312[String] = 6274030373047369728
@SiteCode313[String] = 6274030913332445184
@SiteCode314[String] = 6267789807737372672
@SiteCode315[String] = 6267790255894560768
@SiteCode316[String] = 6267790460492709888
@SiteCode317[String] = 6267790574804271104
@SiteCode318[String] = 6267791036517449728
@SiteCode319[String] = 6267791338536697856
@SiteCode320[String] = 6267791654132908032
@SiteCode321[String] = 6267790081113718784
@SiteCode322[String] = 6267790783294734336
@SiteCode323[String] = 6267791210027417600
@SiteCode324[String] = 6267791528110850048
@SiteCode325[String] = 6437059801301262336
@SiteCode326[String] = 6308426901824208896
@SiteCode327[String] = 6276140742482067456
@SiteCode328[String] = 6276141050964738048
@SiteCode329[String] = 6276141450283450368
@SiteCode330[String] = 6276141737463250944
@SiteCode331[String] = 6276141926932545536
@SiteCode332[String] = 6267796592825204736
@SiteCode333[String] = 6267796864196673536
@SiteCode334[String] = 6267797037211713536
@SiteCode335[String] = 6267797181319610368
@SiteCode336[String] = 6276760608893304832
@SiteCode337[String] = 6267798187931598848
@SiteCode338[String] = 6267798388054425600
@SiteCode339[String] = 6267749616851091456
@SiteCode340[String] = 6267750471750909952
@SiteCode341[String] = 6267750709144322048
@SiteCode342[String] = 6267750895786655744
@SiteCode343[String] = 6267751010588950528
@SiteCode344[String] = 6267753037104676864
@SiteCode345[String] = 6267754200801738752
@SiteCode346[String] = 6267754324688896000
@SiteCode347[String] = 6267797518566817792
@SiteCode348[String] = 6267783175129268224
@SiteCode349[String] = 6267783320914886656
@SiteCode350[String] = 6267783444885929984
@SiteCode351[String] = 6267783577954418688
@SiteCode352[String] = 6267784612617912320
@SiteCode353[String] = 6267785016667799552
@SiteCode354[String] = 6267785185136214016
@SiteCode355[String] = 6267785381991677952
@SiteCode356[String] = 6267785590951903232
@SiteCode357[String] = 6267785762842869760
@SiteCode358[String] = 6267793585479876608
@SiteCode359[String] = 6267793380881727488
@SiteCode360[String] = 6437060915425845248
@SiteCode361[String] = 6284878460246556672
@SiteCode362[String] = 6284879065547538432
@SiteCode363[String] = 6285119541664022528
@SiteCode364[String] = 6285120302351384576
@SiteCode365[String] = 6285181647230861312
@SiteCode366[String] = 6285120520983674880
@SiteCode367[String] = 6285120866493661184
@SiteCode368[String] = 6285121357168508928
@SiteCode369[String] = 6285122203776188416
@SiteCode370[String] = 6437059163368595456
@SiteCode371[String] = 6374383547544903680
@SiteCode372[String] = 6374384032955899904
@SiteCode373[String] = 6374384202665828352


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode375) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode376))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus377)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode375[String] = 6386683729561128960
@WorkAreaCode376[String] = 6274025879437836288
@Examinestatus377[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025879437836288
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025879437836288
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025879437836288
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode378) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode381))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus382)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode378[String] = 6386683729561128960
@WorkAreaCode381[String] = 6274025879437836288
@Examinestatus382[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025879437836288
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE ((([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode379) AND ([TbRawMaterialStockRecord].[WorkAreaCode] IN (@WorkAreaCode384))) AND ([TbRawMaterialArchives].[RebarType] = @RebarType388)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode379[String] = 6386683729561128960
@WorkAreaCode384[String] = 6274025879437836288
@RebarType388[String] = BuildingSteel


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode392) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode393,@SiteCode394,@SiteCode395,@SiteCode396))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus397)) 	
Parameters:
@ProcessFactoryCode392[String] = 6386683729561128960
@SiteCode393[String] = 6274027775095472128
@SiteCode394[String] = 6274027929433276416
@SiteCode395[String] = 6274028333340557312
@SiteCode396[String] = 6417410523612188672
@Examinestatus397[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025879437836288
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode399)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode399[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode398) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode400))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus401)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode398[String] = 6386683729561128960
@WorkAreaCode400[String] = 6274025879437836288
@Examinestatus401[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE ((((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode380)) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode383,@SiteCode385,@SiteCode386,@SiteCode387))) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState389,@ProcessingState390,@ProcessingState391))) 	
Parameters:
@ProcessFactoryCode380[String] = 6386683729561128960
@SiteCode383[String] = 6274027775095472128
@SiteCode385[String] = 6274027929433276416
@SiteCode386[String] = 6274028333340557312
@SiteCode387[String] = 6417410523612188672
@ProcessingState389[String] = Processing
@ProcessingState390[String] = Received
@ProcessingState391[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025879437836288
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat403) 	
Parameters:
@DaetailWorkStrat403[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE ((([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode402) AND ([TbRawMaterialStockRecord].[WorkAreaCode] IN (@WorkAreaCode404))) AND ([TbRawMaterialArchives].[RebarType] = @RebarType405)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode402[String] = 6386683729561128960
@WorkAreaCode404[String] = 6274025879437836288
@RebarType405[String] = SectionSteel


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[OrderCode] IN (@OrderCode406)) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime407)))) 	
Parameters:
@OrderCode406[String] = JGDD202000001
@DistributionTime407[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 18:06:14
Text:	 SELECT count(*) as r_cnt FROM [TbDistributionPlanInfo] WHERE (([TbDistributionPlanInfo].[OrderCode] IN (@OrderCode408)) AND ((DistributionStart='配送完成' and DATEPART(day,DeliveryCompleteTime)>DATEPART(day,DistributionTime)) or (DistributionStart='未配送' and DistributionTime>GETDATE())))	
Parameters:
@OrderCode408[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274027775095472128
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274027775095472128
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274027775095472128
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode410) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode411))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus413)) 	
Parameters:
@ProcessFactoryCode410[String] = 6386683729561128960
@SiteCode411[String] = 6274027775095472128
@Examinestatus413[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode417) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode418))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus419)) 	
Parameters:
@ProcessFactoryCode417[String] = 6386683729561128960
@SiteCode418[String] = 6274027775095472128
@Examinestatus419[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode420)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode420[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode421)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode421[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE ((((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode409)) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode412))) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState414,@ProcessingState415,@ProcessingState416))) 	
Parameters:
@ProcessFactoryCode409[String] = 6386683729561128960
@SiteCode412[String] = 6274027775095472128
@ProcessingState414[String] = Processing
@ProcessingState415[String] = Received
@ProcessingState416[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat422) 	
Parameters:
@DaetailWorkStrat422[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[OrderCode] IN (@OrderCode423)) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime424)))) 	
Parameters:
@OrderCode423[String] = JGDD202000001
@DistributionTime424[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	 SELECT   [TbDistributionPlanInfo].[DistributionStart] FROM [TbDistributionPlanInfo]  WHERE ([TbDistributionPlanInfo].[OrderCode] IN (@OrderCode425)) 	
Parameters:
@OrderCode425[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	 SELECT   [TbDistributionEntOrder].* FROM [TbDistributionEntOrder] LEFT OUTER JOIN [TbDistributionEnt] ON ([TbDistributionEntOrder].[DistributionCode] = [TbDistributionEnt].[DistributionCode])  WHERE ([TbDistributionEntOrder].[OrderCode] IN (@OrderCode426)) 	
Parameters:
@OrderCode426[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274027775095472128
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	 SELECT   [TbOrderProgress].[ProcessingState],[TbOrderProgress].[FinishProcessingDateTime],[TbOrderProgress].[DistributionTime],[TbOrderProgress].[SiteCode] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[SiteCode] IN (@SiteCode428,@SiteCode429,@SiteCode430,@SiteCode431,@SiteCode432,@SiteCode433,@SiteCode434,@SiteCode435,@SiteCode436,@SiteCode437,@SiteCode438,@SiteCode439,@SiteCode440,@SiteCode441,@SiteCode442,@SiteCode443,@SiteCode444,@SiteCode445,@SiteCode446,@SiteCode447,@SiteCode448,@SiteCode449,@SiteCode450,@SiteCode451,@SiteCode452,@SiteCode453,@SiteCode454,@SiteCode455,@SiteCode456,@SiteCode457,@SiteCode458,@SiteCode459,@SiteCode460,@SiteCode461,@SiteCode462,@SiteCode463,@SiteCode464,@SiteCode465,@SiteCode466,@SiteCode467,@SiteCode468,@SiteCode469,@SiteCode470,@SiteCode471,@SiteCode472,@SiteCode473,@SiteCode474,@SiteCode475,@SiteCode476,@SiteCode477,@SiteCode478,@SiteCode479,@SiteCode480,@SiteCode481,@SiteCode482,@SiteCode483,@SiteCode484,@SiteCode485,@SiteCode486,@SiteCode487,@SiteCode488,@SiteCode489,@SiteCode490,@SiteCode491,@SiteCode492,@SiteCode493,@SiteCode494,@SiteCode495,@SiteCode496,@SiteCode497,@SiteCode498)) AND (YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=3)) 	
Parameters:
@SiteCode428[String] = 6274027775095472128
@SiteCode429[String] = 6274027929433276416
@SiteCode430[String] = 6417410523612188672
@SiteCode431[String] = 6274028333340557312
@SiteCode432[String] = 6274028829845487616
@SiteCode433[String] = 6274029086029381632
@SiteCode434[String] = 6274029528142577664
@SiteCode435[String] = 6274029966388625408
@SiteCode436[String] = 6274030152053686272
@SiteCode437[String] = 6274030373047369728
@SiteCode438[String] = 6274030913332445184
@SiteCode439[String] = 6267789807737372672
@SiteCode440[String] = 6267790255894560768
@SiteCode441[String] = 6267790460492709888
@SiteCode442[String] = 6267790574804271104
@SiteCode443[String] = 6267791036517449728
@SiteCode444[String] = 6267791338536697856
@SiteCode445[String] = 6267791654132908032
@SiteCode446[String] = 6267790081113718784
@SiteCode447[String] = 6267790783294734336
@SiteCode448[String] = 6267791210027417600
@SiteCode449[String] = 6267791528110850048
@SiteCode450[String] = 6437059801301262336
@SiteCode451[String] = 6308426901824208896
@SiteCode452[String] = 6276140742482067456
@SiteCode453[String] = 6276141050964738048
@SiteCode454[String] = 6276141450283450368
@SiteCode455[String] = 6276141737463250944
@SiteCode456[String] = 6276141926932545536
@SiteCode457[String] = 6267796592825204736
@SiteCode458[String] = 6267796864196673536
@SiteCode459[String] = 6267797037211713536
@SiteCode460[String] = 6267797181319610368
@SiteCode461[String] = 6276760608893304832
@SiteCode462[String] = 6267798187931598848
@SiteCode463[String] = 6267798388054425600
@SiteCode464[String] = 6267749616851091456
@SiteCode465[String] = 6267750471750909952
@SiteCode466[String] = 6267750709144322048
@SiteCode467[String] = 6267750895786655744
@SiteCode468[String] = 6267751010588950528
@SiteCode469[String] = 6267753037104676864
@SiteCode470[String] = 6267754200801738752
@SiteCode471[String] = 6267754324688896000
@SiteCode472[String] = 6267797518566817792
@SiteCode473[String] = 6267783175129268224
@SiteCode474[String] = 6267783320914886656
@SiteCode475[String] = 6267783444885929984
@SiteCode476[String] = 6267783577954418688
@SiteCode477[String] = 6267784612617912320
@SiteCode478[String] = 6267785016667799552
@SiteCode479[String] = 6267785185136214016
@SiteCode480[String] = 6267785381991677952
@SiteCode481[String] = 6267785590951903232
@SiteCode482[String] = 6267785762842869760
@SiteCode483[String] = 6267793585479876608
@SiteCode484[String] = 6267793380881727488
@SiteCode485[String] = 6437060915425845248
@SiteCode486[String] = 6284878460246556672
@SiteCode487[String] = 6284879065547538432
@SiteCode488[String] = 6285119541664022528
@SiteCode489[String] = 6285120302351384576
@SiteCode490[String] = 6285181647230861312
@SiteCode491[String] = 6285120520983674880
@SiteCode492[String] = 6285120866493661184
@SiteCode493[String] = 6285121357168508928
@SiteCode494[String] = 6285122203776188416
@SiteCode495[String] = 6437059163368595456
@SiteCode496[String] = 6374383547544903680
@SiteCode497[String] = 6374384032955899904
@SiteCode498[String] = 6374384202665828352


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode499) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode500))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus501)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode499[String] = 6386683729561128960
@WorkAreaCode500[String] = 6274027775095472128
@Examinestatus501[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274027775095472128
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274027775095472128
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE ((([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode502) AND ([TbRawMaterialStockRecord].[WorkAreaCode] IN (@WorkAreaCode504))) AND ([TbRawMaterialArchives].[RebarType] = @RebarType505)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode502[String] = 6386683729561128960
@WorkAreaCode504[String] = 6274027775095472128
@RebarType505[String] = BuildingSteel


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274027775095472128
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode503) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode507))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus508)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode503[String] = 6386683729561128960
@WorkAreaCode507[String] = 6274027775095472128
@Examinestatus508[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274027775095472128
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode513) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode514))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus515)) 	
Parameters:
@ProcessFactoryCode513[String] = 6386683729561128960
@SiteCode514[String] = 6274027775095472128
@Examinestatus515[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274027775095472128
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode516) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode517))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus518)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode516[String] = 6386683729561128960
@WorkAreaCode517[String] = 6274027775095472128
@Examinestatus518[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode519)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode519[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE ((((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode506)) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode509))) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState510,@ProcessingState511,@ProcessingState512))) 	
Parameters:
@ProcessFactoryCode506[String] = 6386683729561128960
@SiteCode509[String] = 6274027775095472128
@ProcessingState510[String] = Processing
@ProcessingState511[String] = Received
@ProcessingState512[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274027775095472128
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat521) 	
Parameters:
@DaetailWorkStrat521[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE ((([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode520) AND ([TbRawMaterialStockRecord].[WorkAreaCode] IN (@WorkAreaCode522))) AND ([TbRawMaterialArchives].[RebarType] = @RebarType523)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode520[String] = 6386683729561128960
@WorkAreaCode522[String] = 6274027775095472128
@RebarType523[String] = SectionSteel


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[OrderCode] IN (@OrderCode524)) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime525)))) 	
Parameters:
@OrderCode524[String] = JGDD202000001
@DistributionTime525[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 18:06:15
Text:	 SELECT count(*) as r_cnt FROM [TbDistributionPlanInfo] WHERE (([TbDistributionPlanInfo].[OrderCode] IN (@OrderCode526)) AND ((DistributionStart='配送完成' and DATEPART(day,DeliveryCompleteTime)>DATEPART(day,DistributionTime)) or (DistributionStart='未配送' and DistributionTime>GETDATE())))	
Parameters:
@OrderCode526[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:06:30
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025587078070272
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025587078070272
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:30
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:30
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode528) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode529,@SiteCode530,@SiteCode531,@SiteCode532,@SiteCode533,@SiteCode534,@SiteCode535,@SiteCode536,@SiteCode537,@SiteCode538,@SiteCode539))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus540)) 	
Parameters:
@ProcessFactoryCode528[String] = 6386683729561128960
@SiteCode529[String] = 6274028829845487616
@SiteCode530[String] = 6274029086029381632
@SiteCode531[String] = 6274029528142577664
@SiteCode532[String] = 6274029966388625408
@SiteCode533[String] = 6274030152053686272
@SiteCode534[String] = 6274030373047369728
@SiteCode535[String] = 6274030913332445184
@SiteCode536[String] = 6274027775095472128
@SiteCode537[String] = 6274027929433276416
@SiteCode538[String] = 6274028333340557312
@SiteCode539[String] = 6417410523612188672
@Examinestatus540[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025587078070272
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:30
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode556,@OrderCode557)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode556[String] = JGDD202000001
@OrderCode557[String] = JGDD202000002


-----------------------------------------------------------------------------
2020-03-27 18:06:30
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode555) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode558,@SiteCode559,@SiteCode560,@SiteCode561,@SiteCode562,@SiteCode563,@SiteCode564,@SiteCode565,@SiteCode566,@SiteCode567,@SiteCode568))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus569)) 	
Parameters:
@ProcessFactoryCode555[String] = 6386683729561128960
@SiteCode558[String] = 6274028829845487616
@SiteCode559[String] = 6274029086029381632
@SiteCode560[String] = 6274029528142577664
@SiteCode561[String] = 6274029966388625408
@SiteCode562[String] = 6274030152053686272
@SiteCode563[String] = 6274030373047369728
@SiteCode564[String] = 6274030913332445184
@SiteCode565[String] = 6274027775095472128
@SiteCode566[String] = 6274027929433276416
@SiteCode567[String] = 6274028333340557312
@SiteCode568[String] = 6417410523612188672
@Examinestatus569[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:30
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode570,@OrderCode571)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode570[String] = JGDD202000001
@OrderCode571[String] = JGDD202000002


-----------------------------------------------------------------------------
2020-03-27 18:06:30
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE ((((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode527)) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode541,@SiteCode542,@SiteCode543,@SiteCode544,@SiteCode545,@SiteCode546,@SiteCode547,@SiteCode548,@SiteCode549,@SiteCode550,@SiteCode551))) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState552,@ProcessingState553,@ProcessingState554))) 	
Parameters:
@ProcessFactoryCode527[String] = 6386683729561128960
@SiteCode541[String] = 6274028829845487616
@SiteCode542[String] = 6274029086029381632
@SiteCode543[String] = 6274029528142577664
@SiteCode544[String] = 6274029966388625408
@SiteCode545[String] = 6274030152053686272
@SiteCode546[String] = 6274030373047369728
@SiteCode547[String] = 6274030913332445184
@SiteCode548[String] = 6274027775095472128
@SiteCode549[String] = 6274027929433276416
@SiteCode550[String] = 6274028333340557312
@SiteCode551[String] = 6417410523612188672
@ProcessingState552[String] = Processing
@ProcessingState553[String] = Received
@ProcessingState554[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 18:06:30
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat572) 	
Parameters:
@DaetailWorkStrat572[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 18:06:30
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[OrderCode] IN (@OrderCode573,@OrderCode574)) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime575)))) 	
Parameters:
@OrderCode573[String] = JGDD202000001
@OrderCode574[String] = JGDD202000002
@DistributionTime575[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 18:06:30
Text:	 SELECT   [TbDistributionPlanInfo].[DistributionStart] FROM [TbDistributionPlanInfo]  WHERE ([TbDistributionPlanInfo].[OrderCode] IN (@OrderCode576,@OrderCode577)) 	
Parameters:
@OrderCode576[String] = JGDD202000001
@OrderCode577[String] = JGDD202000002


-----------------------------------------------------------------------------
2020-03-27 18:06:30
Text:	 SELECT   [TbDistributionEntOrder].* FROM [TbDistributionEntOrder] LEFT OUTER JOIN [TbDistributionEnt] ON ([TbDistributionEntOrder].[DistributionCode] = [TbDistributionEnt].[DistributionCode])  WHERE ([TbDistributionEntOrder].[OrderCode] IN (@OrderCode578,@OrderCode579)) 	
Parameters:
@OrderCode578[String] = JGDD202000001
@OrderCode579[String] = JGDD202000002


-----------------------------------------------------------------------------
2020-03-27 18:06:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025587078070272
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:31
Text:	 SELECT   [TbOrderProgress].[ProcessingState],[TbOrderProgress].[FinishProcessingDateTime],[TbOrderProgress].[DistributionTime],[TbOrderProgress].[SiteCode] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[SiteCode] IN (@SiteCode580,@SiteCode581,@SiteCode582,@SiteCode583,@SiteCode584,@SiteCode585,@SiteCode586,@SiteCode587,@SiteCode588,@SiteCode589,@SiteCode590,@SiteCode591,@SiteCode592,@SiteCode593,@SiteCode594,@SiteCode595,@SiteCode596,@SiteCode597,@SiteCode598,@SiteCode599,@SiteCode600,@SiteCode601,@SiteCode602,@SiteCode603,@SiteCode604,@SiteCode605,@SiteCode606,@SiteCode607,@SiteCode608,@SiteCode609,@SiteCode610,@SiteCode611,@SiteCode612,@SiteCode613,@SiteCode614,@SiteCode615,@SiteCode616,@SiteCode617,@SiteCode618,@SiteCode619,@SiteCode620,@SiteCode621,@SiteCode622,@SiteCode623,@SiteCode624,@SiteCode625,@SiteCode626,@SiteCode627,@SiteCode628,@SiteCode629,@SiteCode630,@SiteCode631,@SiteCode632,@SiteCode633,@SiteCode634,@SiteCode635,@SiteCode636,@SiteCode637,@SiteCode638,@SiteCode639,@SiteCode640,@SiteCode641,@SiteCode642,@SiteCode643,@SiteCode644,@SiteCode645,@SiteCode646,@SiteCode647,@SiteCode648,@SiteCode649,@SiteCode650)) AND (YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=3)) 	
Parameters:
@SiteCode580[String] = 6274027775095472128
@SiteCode581[String] = 6274027929433276416
@SiteCode582[String] = 6417410523612188672
@SiteCode583[String] = 6274028333340557312
@SiteCode584[String] = 6274028829845487616
@SiteCode585[String] = 6274029086029381632
@SiteCode586[String] = 6274029528142577664
@SiteCode587[String] = 6274029966388625408
@SiteCode588[String] = 6274030152053686272
@SiteCode589[String] = 6274030373047369728
@SiteCode590[String] = 6274030913332445184
@SiteCode591[String] = 6267789807737372672
@SiteCode592[String] = 6267790255894560768
@SiteCode593[String] = 6267790460492709888
@SiteCode594[String] = 6267790574804271104
@SiteCode595[String] = 6267791036517449728
@SiteCode596[String] = 6267791338536697856
@SiteCode597[String] = 6267791654132908032
@SiteCode598[String] = 6267790081113718784
@SiteCode599[String] = 6267790783294734336
@SiteCode600[String] = 6267791210027417600
@SiteCode601[String] = 6267791528110850048
@SiteCode602[String] = 6437059801301262336
@SiteCode603[String] = 6308426901824208896
@SiteCode604[String] = 6276140742482067456
@SiteCode605[String] = 6276141050964738048
@SiteCode606[String] = 6276141450283450368
@SiteCode607[String] = 6276141737463250944
@SiteCode608[String] = 6276141926932545536
@SiteCode609[String] = 6267796592825204736
@SiteCode610[String] = 6267796864196673536
@SiteCode611[String] = 6267797037211713536
@SiteCode612[String] = 6267797181319610368
@SiteCode613[String] = 6276760608893304832
@SiteCode614[String] = 6267798187931598848
@SiteCode615[String] = 6267798388054425600
@SiteCode616[String] = 6267749616851091456
@SiteCode617[String] = 6267750471750909952
@SiteCode618[String] = 6267750709144322048
@SiteCode619[String] = 6267750895786655744
@SiteCode620[String] = 6267751010588950528
@SiteCode621[String] = 6267753037104676864
@SiteCode622[String] = 6267754200801738752
@SiteCode623[String] = 6267754324688896000
@SiteCode624[String] = 6267797518566817792
@SiteCode625[String] = 6267783175129268224
@SiteCode626[String] = 6267783320914886656
@SiteCode627[String] = 6267783444885929984
@SiteCode628[String] = 6267783577954418688
@SiteCode629[String] = 6267784612617912320
@SiteCode630[String] = 6267785016667799552
@SiteCode631[String] = 6267785185136214016
@SiteCode632[String] = 6267785381991677952
@SiteCode633[String] = 6267785590951903232
@SiteCode634[String] = 6267785762842869760
@SiteCode635[String] = 6267793585479876608
@SiteCode636[String] = 6267793380881727488
@SiteCode637[String] = 6437060915425845248
@SiteCode638[String] = 6284878460246556672
@SiteCode639[String] = 6284879065547538432
@SiteCode640[String] = 6285119541664022528
@SiteCode641[String] = 6285120302351384576
@SiteCode642[String] = 6285181647230861312
@SiteCode643[String] = 6285120520983674880
@SiteCode644[String] = 6285120866493661184
@SiteCode645[String] = 6285121357168508928
@SiteCode646[String] = 6285122203776188416
@SiteCode647[String] = 6437059163368595456
@SiteCode648[String] = 6374383547544903680
@SiteCode649[String] = 6374384032955899904
@SiteCode650[String] = 6374384202665828352


-----------------------------------------------------------------------------
2020-03-27 18:06:31
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode652) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode653,@WorkAreaCode654))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus655)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode652[String] = 6386683729561128960
@WorkAreaCode653[String] = 6274025879437836288
@WorkAreaCode654[String] = 6274026095054422016
@Examinestatus655[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025587078070272
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025587078070272
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025587078070272
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:31
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode657) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode661,@WorkAreaCode662))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus664)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode657[String] = 6386683729561128960
@WorkAreaCode661[String] = 6274025879437836288
@WorkAreaCode662[String] = 6274026095054422016
@Examinestatus664[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:31
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE ((([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode656) AND ([TbRawMaterialStockRecord].[WorkAreaCode] IN (@WorkAreaCode660,@WorkAreaCode663))) AND ([TbRawMaterialArchives].[RebarType] = @RebarType665)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode656[String] = 6386683729561128960
@WorkAreaCode660[String] = 6274025879437836288
@WorkAreaCode663[String] = 6274026095054422016
@RebarType665[String] = BuildingSteel


-----------------------------------------------------------------------------
2020-03-27 18:06:31
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025587078070272
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025587078070272
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:31
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:31
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode659) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode681,@WorkAreaCode682))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus683)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode659[String] = 6386683729561128960
@WorkAreaCode681[String] = 6274025879437836288
@WorkAreaCode682[String] = 6274026095054422016
@Examinestatus683[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025587078070272
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:31
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode680) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode684,@SiteCode685,@SiteCode686,@SiteCode687,@SiteCode688,@SiteCode689,@SiteCode690,@SiteCode691,@SiteCode692,@SiteCode693,@SiteCode694))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus695)) 	
Parameters:
@ProcessFactoryCode680[String] = 6386683729561128960
@SiteCode684[String] = 6274028829845487616
@SiteCode685[String] = 6274029086029381632
@SiteCode686[String] = 6274029528142577664
@SiteCode687[String] = 6274029966388625408
@SiteCode688[String] = 6274030152053686272
@SiteCode689[String] = 6274030373047369728
@SiteCode690[String] = 6274030913332445184
@SiteCode691[String] = 6274027775095472128
@SiteCode692[String] = 6274027929433276416
@SiteCode693[String] = 6274028333340557312
@SiteCode694[String] = 6417410523612188672
@Examinestatus695[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:31
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode697,@OrderCode698)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode697[String] = JGDD202000001
@OrderCode698[String] = JGDD202000002


-----------------------------------------------------------------------------
2020-03-27 18:06:31
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE ((([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode696) AND ([TbRawMaterialStockRecord].[WorkAreaCode] IN (@WorkAreaCode699,@WorkAreaCode700))) AND ([TbRawMaterialArchives].[RebarType] = @RebarType701)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode696[String] = 6386683729561128960
@WorkAreaCode699[String] = 6274025879437836288
@WorkAreaCode700[String] = 6274026095054422016
@RebarType701[String] = SectionSteel


-----------------------------------------------------------------------------
2020-03-27 18:06:31
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE ((((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode658)) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode666,@SiteCode667,@SiteCode668,@SiteCode669,@SiteCode670,@SiteCode671,@SiteCode672,@SiteCode673,@SiteCode674,@SiteCode675,@SiteCode676))) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState677,@ProcessingState678,@ProcessingState679))) 	
Parameters:
@ProcessFactoryCode658[String] = 6386683729561128960
@SiteCode666[String] = 6274028829845487616
@SiteCode667[String] = 6274029086029381632
@SiteCode668[String] = 6274029528142577664
@SiteCode669[String] = 6274029966388625408
@SiteCode670[String] = 6274030152053686272
@SiteCode671[String] = 6274030373047369728
@SiteCode672[String] = 6274030913332445184
@SiteCode673[String] = 6274027775095472128
@SiteCode674[String] = 6274027929433276416
@SiteCode675[String] = 6274028333340557312
@SiteCode676[String] = 6417410523612188672
@ProcessingState677[String] = Processing
@ProcessingState678[String] = Received
@ProcessingState679[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 18:06:31
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat702) 	
Parameters:
@DaetailWorkStrat702[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 18:06:31
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[OrderCode] IN (@OrderCode703,@OrderCode704)) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime705)))) 	
Parameters:
@OrderCode703[String] = JGDD202000001
@OrderCode704[String] = JGDD202000002
@DistributionTime705[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 18:06:31
Text:	 SELECT count(*) as r_cnt FROM [TbDistributionPlanInfo] WHERE (([TbDistributionPlanInfo].[OrderCode] IN (@OrderCode706,@OrderCode707)) AND ((DistributionStart='配送完成' and DATEPART(day,DeliveryCompleteTime)>DATEPART(day,DistributionTime)) or (DistributionStart='未配送' and DistributionTime>GETDATE())))	
Parameters:
@OrderCode706[String] = JGDD202000001
@OrderCode707[String] = JGDD202000002


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6267787909240193024
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6267787909240193024
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6267787909240193024
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode709) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode726,@SiteCode727,@SiteCode728,@SiteCode729,@SiteCode730,@SiteCode731,@SiteCode732,@SiteCode733,@SiteCode734,@SiteCode735,@SiteCode736,@SiteCode737))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus738)) 	
Parameters:
@ProcessFactoryCode709[String] = 6386683729561128960
@SiteCode726[String] = 6437059801301262336
@SiteCode727[String] = 6267790081113718784
@SiteCode728[String] = 6267790783294734336
@SiteCode729[String] = 6267791210027417600
@SiteCode730[String] = 6267791528110850048
@SiteCode731[String] = 6267791338536697856
@SiteCode732[String] = 6267791654132908032
@SiteCode733[String] = 6267791036517449728
@SiteCode734[String] = 6267789807737372672
@SiteCode735[String] = 6267790255894560768
@SiteCode736[String] = 6267790460492709888
@SiteCode737[String] = 6267790574804271104
@Examinestatus738[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode739,@OrderCode740,@OrderCode741,@OrderCode742,@OrderCode743,@OrderCode744)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode739[String] = JGDD202000003
@OrderCode740[String] = JGDD202000004
@OrderCode741[String] = JGDD202000005
@OrderCode742[String] = JGDD202000006
@OrderCode743[String] = JGDD202000008
@OrderCode744[String] = JGDD202000009


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode725) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode745,@SiteCode746,@SiteCode747,@SiteCode748,@SiteCode749,@SiteCode750,@SiteCode751,@SiteCode752,@SiteCode753,@SiteCode754,@SiteCode755,@SiteCode756))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus757)) 	
Parameters:
@ProcessFactoryCode725[String] = 6386683729561128960
@SiteCode745[String] = 6437059801301262336
@SiteCode746[String] = 6267790081113718784
@SiteCode747[String] = 6267790783294734336
@SiteCode748[String] = 6267791210027417600
@SiteCode749[String] = 6267791528110850048
@SiteCode750[String] = 6267791338536697856
@SiteCode751[String] = 6267791654132908032
@SiteCode752[String] = 6267791036517449728
@SiteCode753[String] = 6267789807737372672
@SiteCode754[String] = 6267790255894560768
@SiteCode755[String] = 6267790460492709888
@SiteCode756[String] = 6267790574804271104
@Examinestatus757[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode758,@OrderCode759,@OrderCode760,@OrderCode761,@OrderCode762,@OrderCode763)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode758[String] = JGDD202000003
@OrderCode759[String] = JGDD202000004
@OrderCode760[String] = JGDD202000005
@OrderCode761[String] = JGDD202000006
@OrderCode762[String] = JGDD202000008
@OrderCode763[String] = JGDD202000009


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE ((((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode708)) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode710,@SiteCode711,@SiteCode712,@SiteCode713,@SiteCode714,@SiteCode715,@SiteCode716,@SiteCode717,@SiteCode718,@SiteCode719,@SiteCode720,@SiteCode721))) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState722,@ProcessingState723,@ProcessingState724))) 	
Parameters:
@ProcessFactoryCode708[String] = 6386683729561128960
@SiteCode710[String] = 6437059801301262336
@SiteCode711[String] = 6267790081113718784
@SiteCode712[String] = 6267790783294734336
@SiteCode713[String] = 6267791210027417600
@SiteCode714[String] = 6267791528110850048
@SiteCode715[String] = 6267791338536697856
@SiteCode716[String] = 6267791654132908032
@SiteCode717[String] = 6267791036517449728
@SiteCode718[String] = 6267789807737372672
@SiteCode719[String] = 6267790255894560768
@SiteCode720[String] = 6267790460492709888
@SiteCode721[String] = 6267790574804271104
@ProcessingState722[String] = Processing
@ProcessingState723[String] = Received
@ProcessingState724[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat764) 	
Parameters:
@DaetailWorkStrat764[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[OrderCode] IN (@OrderCode765,@OrderCode766,@OrderCode767,@OrderCode768,@OrderCode769,@OrderCode770,@OrderCode771,@OrderCode772,@OrderCode773)) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime774)))) 	
Parameters:
@OrderCode765[String] = JGDD202000003
@OrderCode766[String] = JGDD202000004
@OrderCode767[String] = JGDD202000005
@OrderCode768[String] = JGDD202000006
@OrderCode769[String] = JGDD202000008
@OrderCode770[String] = JGDD202000003
@OrderCode771[String] = JGDD202000004
@OrderCode772[String] = JGDD202000004
@OrderCode773[String] = JGDD202000004
@DistributionTime774[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   [TbDistributionPlanInfo].[DistributionStart] FROM [TbDistributionPlanInfo]  WHERE ([TbDistributionPlanInfo].[OrderCode] IN (@OrderCode775,@OrderCode776,@OrderCode777,@OrderCode778,@OrderCode779)) 	
Parameters:
@OrderCode775[String] = JGDD202000003
@OrderCode776[String] = JGDD202000004
@OrderCode777[String] = JGDD202000005
@OrderCode778[String] = JGDD202000006
@OrderCode779[String] = JGDD202000008


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   [TbDistributionEntOrder].* FROM [TbDistributionEntOrder] LEFT OUTER JOIN [TbDistributionEnt] ON ([TbDistributionEntOrder].[DistributionCode] = [TbDistributionEnt].[DistributionCode])  WHERE ([TbDistributionEntOrder].[OrderCode] IN (@OrderCode780,@OrderCode781,@OrderCode782,@OrderCode783,@OrderCode784)) 	
Parameters:
@OrderCode780[String] = JGDD202000003
@OrderCode781[String] = JGDD202000004
@OrderCode782[String] = JGDD202000005
@OrderCode783[String] = JGDD202000006
@OrderCode784[String] = JGDD202000008


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6267787909240193024
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   [TbOrderProgress].[ProcessingState],[TbOrderProgress].[FinishProcessingDateTime],[TbOrderProgress].[DistributionTime],[TbOrderProgress].[SiteCode] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[SiteCode] IN (@SiteCode785,@SiteCode786,@SiteCode787,@SiteCode788,@SiteCode789,@SiteCode790,@SiteCode791,@SiteCode792,@SiteCode793,@SiteCode794,@SiteCode795,@SiteCode796,@SiteCode797,@SiteCode798,@SiteCode799,@SiteCode800,@SiteCode801,@SiteCode802,@SiteCode803,@SiteCode804,@SiteCode805,@SiteCode806,@SiteCode807,@SiteCode808,@SiteCode809,@SiteCode810,@SiteCode811,@SiteCode812,@SiteCode813,@SiteCode814,@SiteCode815,@SiteCode816,@SiteCode817,@SiteCode818,@SiteCode819,@SiteCode820,@SiteCode821,@SiteCode822,@SiteCode823,@SiteCode824,@SiteCode825,@SiteCode826,@SiteCode827,@SiteCode828,@SiteCode829,@SiteCode830,@SiteCode831,@SiteCode832,@SiteCode833,@SiteCode834,@SiteCode835,@SiteCode836,@SiteCode837,@SiteCode838,@SiteCode839,@SiteCode840,@SiteCode841,@SiteCode842,@SiteCode843,@SiteCode844,@SiteCode845,@SiteCode846,@SiteCode847,@SiteCode848,@SiteCode849,@SiteCode850,@SiteCode851,@SiteCode852,@SiteCode853,@SiteCode854,@SiteCode855)) AND (YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=3)) 	
Parameters:
@SiteCode785[String] = 6274027775095472128
@SiteCode786[String] = 6274027929433276416
@SiteCode787[String] = 6417410523612188672
@SiteCode788[String] = 6274028333340557312
@SiteCode789[String] = 6274028829845487616
@SiteCode790[String] = 6274029086029381632
@SiteCode791[String] = 6274029528142577664
@SiteCode792[String] = 6274029966388625408
@SiteCode793[String] = 6274030152053686272
@SiteCode794[String] = 6274030373047369728
@SiteCode795[String] = 6274030913332445184
@SiteCode796[String] = 6267789807737372672
@SiteCode797[String] = 6267790255894560768
@SiteCode798[String] = 6267790460492709888
@SiteCode799[String] = 6267790574804271104
@SiteCode800[String] = 6267791036517449728
@SiteCode801[String] = 6267791338536697856
@SiteCode802[String] = 6267791654132908032
@SiteCode803[String] = 6267790081113718784
@SiteCode804[String] = 6267790783294734336
@SiteCode805[String] = 6267791210027417600
@SiteCode806[String] = 6267791528110850048
@SiteCode807[String] = 6437059801301262336
@SiteCode808[String] = 6308426901824208896
@SiteCode809[String] = 6276140742482067456
@SiteCode810[String] = 6276141050964738048
@SiteCode811[String] = 6276141450283450368
@SiteCode812[String] = 6276141737463250944
@SiteCode813[String] = 6276141926932545536
@SiteCode814[String] = 6267796592825204736
@SiteCode815[String] = 6267796864196673536
@SiteCode816[String] = 6267797037211713536
@SiteCode817[String] = 6267797181319610368
@SiteCode818[String] = 6276760608893304832
@SiteCode819[String] = 6267798187931598848
@SiteCode820[String] = 6267798388054425600
@SiteCode821[String] = 6267749616851091456
@SiteCode822[String] = 6267750471750909952
@SiteCode823[String] = 6267750709144322048
@SiteCode824[String] = 6267750895786655744
@SiteCode825[String] = 6267751010588950528
@SiteCode826[String] = 6267753037104676864
@SiteCode827[String] = 6267754200801738752
@SiteCode828[String] = 6267754324688896000
@SiteCode829[String] = 6267797518566817792
@SiteCode830[String] = 6267783175129268224
@SiteCode831[String] = 6267783320914886656
@SiteCode832[String] = 6267783444885929984
@SiteCode833[String] = 6267783577954418688
@SiteCode834[String] = 6267784612617912320
@SiteCode835[String] = 6267785016667799552
@SiteCode836[String] = 6267785185136214016
@SiteCode837[String] = 6267785381991677952
@SiteCode838[String] = 6267785590951903232
@SiteCode839[String] = 6267785762842869760
@SiteCode840[String] = 6267793585479876608
@SiteCode841[String] = 6267793380881727488
@SiteCode842[String] = 6437060915425845248
@SiteCode843[String] = 6284878460246556672
@SiteCode844[String] = 6284879065547538432
@SiteCode845[String] = 6285119541664022528
@SiteCode846[String] = 6285120302351384576
@SiteCode847[String] = 6285181647230861312
@SiteCode848[String] = 6285120520983674880
@SiteCode849[String] = 6285120866493661184
@SiteCode850[String] = 6285121357168508928
@SiteCode851[String] = 6285122203776188416
@SiteCode852[String] = 6437059163368595456
@SiteCode853[String] = 6374383547544903680
@SiteCode854[String] = 6374384032955899904
@SiteCode855[String] = 6374384202665828352


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode857) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode858,@WorkAreaCode859,@WorkAreaCode860,@WorkAreaCode861,@WorkAreaCode862))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus863)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode857[String] = 6386683729561128960
@WorkAreaCode858[String] = 6267788080908861440
@WorkAreaCode859[String] = 6267788261163270144
@WorkAreaCode860[String] = 6267788390918258688
@WorkAreaCode861[String] = 6267788788836073472
@WorkAreaCode862[String] = 6437059457770987520
@Examinestatus863[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   * FROM [TbRawMaterialMonthDemandSupplyPlan]  WHERE [TbRawMaterialMonthDemandSupplyPlan].[DemandPlanCode] IN (@DemandPlanCode864,@DemandPlanCode865,@DemandPlanCode866,@DemandPlanCode867,@DemandPlanCode868,@DemandPlanCode869) 	
Parameters:
@DemandPlanCode864[String] = XQJH202000002
@DemandPlanCode865[String] = XQJH202000004
@DemandPlanCode866[String] = XQJH202000005
@DemandPlanCode867[String] = XQJH202000007
@DemandPlanCode868[String] = XQJH202000008
@DemandPlanCode869[String] = XQJH202000009


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   [TbFactoryBatchNeedPlan].[RawMaterialDemandNum] AS [DemandPlanCode],[TbFactoryBatchNeedPlan].[BatchPlanNum],[TbFactoryBatchNeedPlan].[SteelsTypeCode] AS [RebarType],[TbFactoryBatchNeedPlan].[BatchPlanTotal] AS [TotalWeight] FROM [TbFactoryBatchNeedPlan]  WHERE (([TbFactoryBatchNeedPlan].[Examinestatus] = @Examinestatus870) AND ([TbFactoryBatchNeedPlan].[RawMaterialDemandNum] IN (@RawMaterialDemandNum871,@RawMaterialDemandNum872,@RawMaterialDemandNum873,@RawMaterialDemandNum874,@RawMaterialDemandNum875,@RawMaterialDemandNum876,@RawMaterialDemandNum877,@RawMaterialDemandNum878,@RawMaterialDemandNum879,@RawMaterialDemandNum880,@RawMaterialDemandNum881,@RawMaterialDemandNum882))) 	
Parameters:
@Examinestatus870[String] = 审核完成
@RawMaterialDemandNum871[String] = XQJH202000002
@RawMaterialDemandNum872[String] = XQJH202000004
@RawMaterialDemandNum873[String] = XQJH202000005
@RawMaterialDemandNum874[String] = XQJH202000007
@RawMaterialDemandNum875[String] = XQJH202000008
@RawMaterialDemandNum876[String] = XQJH202000009
@RawMaterialDemandNum877[String] = BCJH202000002
@RawMaterialDemandNum878[String] = BCJH202000004
@RawMaterialDemandNum879[String] = BCJH202000005
@RawMaterialDemandNum880[String] = BCJH202000007
@RawMaterialDemandNum881[String] = BCJH202000009
@RawMaterialDemandNum882[String] = BCJH202000008


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   [TbSupplyList].[SteelsTypeCode] AS [RebarType],[TbSupplyList].[HasSupplierTotal] AS [TotalWeight] FROM [TbSupplyList]  WHERE (([TbSupplyList].[StateCode] <> @StateCode856) AND ([TbSupplyList].[BatchPlanNum] IN (@BatchPlanNum883,@BatchPlanNum884,@BatchPlanNum885))) 	
Parameters:
@StateCode856[String] = 未供货
@BatchPlanNum883[String] = PCJH202000002
@BatchPlanNum884[String] = PCJH202000003
@BatchPlanNum885[String] = PCJH202000005


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6267787909240193024
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6267787909240193024
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6267787909240193024
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6267787909240193024
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode886) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode890,@WorkAreaCode891,@WorkAreaCode892,@WorkAreaCode893,@WorkAreaCode894))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus895)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode886[String] = 6386683729561128960
@WorkAreaCode890[String] = 6267788080908861440
@WorkAreaCode891[String] = 6267788261163270144
@WorkAreaCode892[String] = 6267788390918258688
@WorkAreaCode893[String] = 6267788788836073472
@WorkAreaCode894[String] = 6437059457770987520
@Examinestatus895[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE ((([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode887) AND ([TbRawMaterialStockRecord].[WorkAreaCode] IN (@WorkAreaCode896,@WorkAreaCode897,@WorkAreaCode898,@WorkAreaCode899,@WorkAreaCode900))) AND ([TbRawMaterialArchives].[RebarType] = @RebarType901)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode887[String] = 6386683729561128960
@WorkAreaCode896[String] = 6267788080908861440
@WorkAreaCode897[String] = 6267788261163270144
@WorkAreaCode898[String] = 6267788390918258688
@WorkAreaCode899[String] = 6267788788836073472
@WorkAreaCode900[String] = 6437059457770987520
@RebarType901[String] = BuildingSteel


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode888) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode902,@WorkAreaCode903,@WorkAreaCode904,@WorkAreaCode905,@WorkAreaCode906))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus907)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode888[String] = 6386683729561128960
@WorkAreaCode902[String] = 6267788080908861440
@WorkAreaCode903[String] = 6267788261163270144
@WorkAreaCode904[String] = 6267788390918258688
@WorkAreaCode905[String] = 6267788788836073472
@WorkAreaCode906[String] = 6437059457770987520
@Examinestatus907[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   * FROM [TbRawMaterialMonthDemandSupplyPlan]  WHERE [TbRawMaterialMonthDemandSupplyPlan].[DemandPlanCode] IN (@DemandPlanCode908,@DemandPlanCode909,@DemandPlanCode910,@DemandPlanCode911,@DemandPlanCode912,@DemandPlanCode913) 	
Parameters:
@DemandPlanCode908[String] = XQJH202000002
@DemandPlanCode909[String] = XQJH202000004
@DemandPlanCode910[String] = XQJH202000005
@DemandPlanCode911[String] = XQJH202000007
@DemandPlanCode912[String] = XQJH202000008
@DemandPlanCode913[String] = XQJH202000009


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6267787909240193024
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   * FROM [TbRawMaterialMonthDemandSupplyPlan]  WHERE [TbRawMaterialMonthDemandSupplyPlan].[DemandPlanCode] IN (@DemandPlanCode930,@DemandPlanCode931,@DemandPlanCode932,@DemandPlanCode933,@DemandPlanCode934,@DemandPlanCode935) 	
Parameters:
@DemandPlanCode930[String] = XQJH202000002
@DemandPlanCode931[String] = XQJH202000004
@DemandPlanCode932[String] = XQJH202000005
@DemandPlanCode933[String] = XQJH202000007
@DemandPlanCode934[String] = XQJH202000008
@DemandPlanCode935[String] = XQJH202000009


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   [TbFactoryBatchNeedPlan].[RawMaterialDemandNum] AS [DemandPlanCode],[TbFactoryBatchNeedPlan].[BatchPlanNum],[TbFactoryBatchNeedPlan].[SteelsTypeCode] AS [RebarType],[TbFactoryBatchNeedPlan].[BatchPlanTotal] AS [TotalWeight] FROM [TbFactoryBatchNeedPlan]  WHERE (([TbFactoryBatchNeedPlan].[Examinestatus] = @Examinestatus936) AND ([TbFactoryBatchNeedPlan].[RawMaterialDemandNum] IN (@RawMaterialDemandNum937,@RawMaterialDemandNum938,@RawMaterialDemandNum939,@RawMaterialDemandNum940,@RawMaterialDemandNum941,@RawMaterialDemandNum942))) 	
Parameters:
@Examinestatus936[String] = 审核完成
@RawMaterialDemandNum937[String] = XQJH202000002
@RawMaterialDemandNum938[String] = XQJH202000004
@RawMaterialDemandNum939[String] = XQJH202000005
@RawMaterialDemandNum940[String] = XQJH202000007
@RawMaterialDemandNum941[String] = XQJH202000008
@RawMaterialDemandNum942[String] = XQJH202000009


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6267787909240193024
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   [TbSupplyList].[BatchPlanTotal],[TbSupplyList].[HasSupplierTotal],[TbSupplyList].[StateCode],[TbSupplyList].[SteelsTypeCode],[TbSupplyList].[SupplyCompleteTime],[TbSupplyList].[SupplyDate] FROM [TbSupplyList]  WHERE ([TbSupplyList].[RawMaterialDemandNum] IN (@RawMaterialDemandNum944,@RawMaterialDemandNum945,@RawMaterialDemandNum946,@RawMaterialDemandNum947,@RawMaterialDemandNum948,@RawMaterialDemandNum949,@RawMaterialDemandNum950,@RawMaterialDemandNum951,@RawMaterialDemandNum952,@RawMaterialDemandNum953,@RawMaterialDemandNum954,@RawMaterialDemandNum955)) 	
Parameters:
@RawMaterialDemandNum944[String] = XQJH202000002
@RawMaterialDemandNum945[String] = XQJH202000004
@RawMaterialDemandNum946[String] = XQJH202000005
@RawMaterialDemandNum947[String] = XQJH202000007
@RawMaterialDemandNum948[String] = XQJH202000008
@RawMaterialDemandNum949[String] = XQJH202000009
@RawMaterialDemandNum950[String] = BCJH202000002
@RawMaterialDemandNum951[String] = BCJH202000004
@RawMaterialDemandNum952[String] = BCJH202000005
@RawMaterialDemandNum953[String] = BCJH202000007
@RawMaterialDemandNum954[String] = BCJH202000009
@RawMaterialDemandNum955[String] = BCJH202000008


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode929) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode956,@SiteCode957,@SiteCode958,@SiteCode959,@SiteCode960,@SiteCode961,@SiteCode962,@SiteCode963,@SiteCode964,@SiteCode965,@SiteCode966,@SiteCode967))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus968)) 	
Parameters:
@ProcessFactoryCode929[String] = 6386683729561128960
@SiteCode956[String] = 6437059801301262336
@SiteCode957[String] = 6267790081113718784
@SiteCode958[String] = 6267790783294734336
@SiteCode959[String] = 6267791210027417600
@SiteCode960[String] = 6267791528110850048
@SiteCode961[String] = 6267791338536697856
@SiteCode962[String] = 6267791654132908032
@SiteCode963[String] = 6267791036517449728
@SiteCode964[String] = 6267789807737372672
@SiteCode965[String] = 6267790255894560768
@SiteCode966[String] = 6267790460492709888
@SiteCode967[String] = 6267790574804271104
@Examinestatus968[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE ((([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode943) AND ([TbRawMaterialStockRecord].[WorkAreaCode] IN (@WorkAreaCode969,@WorkAreaCode970,@WorkAreaCode971,@WorkAreaCode972,@WorkAreaCode973))) AND ([TbRawMaterialArchives].[RebarType] = @RebarType974)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode943[String] = 6386683729561128960
@WorkAreaCode969[String] = 6267788080908861440
@WorkAreaCode970[String] = 6267788261163270144
@WorkAreaCode971[String] = 6267788390918258688
@WorkAreaCode972[String] = 6267788788836073472
@WorkAreaCode973[String] = 6437059457770987520
@RebarType974[String] = SectionSteel


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode975,@OrderCode976,@OrderCode977,@OrderCode978,@OrderCode979,@OrderCode980)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode975[String] = JGDD202000003
@OrderCode976[String] = JGDD202000004
@OrderCode977[String] = JGDD202000005
@OrderCode978[String] = JGDD202000006
@OrderCode979[String] = JGDD202000008
@OrderCode980[String] = JGDD202000009


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE ((((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode889)) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode914,@SiteCode915,@SiteCode916,@SiteCode917,@SiteCode918,@SiteCode919,@SiteCode920,@SiteCode921,@SiteCode922,@SiteCode923,@SiteCode924,@SiteCode925))) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState926,@ProcessingState927,@ProcessingState928))) 	
Parameters:
@ProcessFactoryCode889[String] = 6386683729561128960
@SiteCode914[String] = 6437059801301262336
@SiteCode915[String] = 6267790081113718784
@SiteCode916[String] = 6267790783294734336
@SiteCode917[String] = 6267791210027417600
@SiteCode918[String] = 6267791528110850048
@SiteCode919[String] = 6267791338536697856
@SiteCode920[String] = 6267791654132908032
@SiteCode921[String] = 6267791036517449728
@SiteCode922[String] = 6267789807737372672
@SiteCode923[String] = 6267790255894560768
@SiteCode924[String] = 6267790460492709888
@SiteCode925[String] = 6267790574804271104
@ProcessingState926[String] = Processing
@ProcessingState927[String] = Received
@ProcessingState928[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	select * from (select cp2.CompanyCode,cp2.CompanyFullName from (select SiteCode from TbWorkOrder where 
            (CONVERT(varchar(7) ,InsertTime, 120)='2020-02' or CONVERT(varchar(7) ,InsertTime, 120)='2020-01' or CONVERT(varchar(7) ,InsertTime, 120)='2020-03') and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId) and (ISNULL(@ProcessFactoryCode,'')='' or ProcessFactoryCode=@ProcessFactoryCode)
            group by SiteCode) TbWO
            left join TbCompany cp on TBWO.SiteCode=cp.CompanyCode
            left join TbCompany cp2 on cp2.CompanyCode=cp.ParentCompanyCode
            group by cp2.CompanyCode,cp2.CompanyFullName
            union all
            select rmdp.WorkAreaCode,cp.CompanyFullName
            from TbRawMaterialMonthDemandPlan rmdp
            left join TbCompany cp on cp.CompanyCode=rmdp.WorkAreaCode
            where (rmdp.DemandMonth='2020-02' or rmdp.DemandMonth='2020-01' or rmdp.DemandMonth='2020-03') and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId) and (ISNULL(@ProcessFactoryCode,'')='' or ProcessFactoryCode=@ProcessFactoryCode)) TbGq group by TbGq.CompanyCode,TbGq.CompanyFullName	
Parameters:
@ProjectId[String] = 6245721945602523136
@ProcessFactoryCode[String] = 6386683729561128960


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat981) 	
Parameters:
@DaetailWorkStrat981[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[OrderCode] IN (@OrderCode982,@OrderCode983,@OrderCode984,@OrderCode985,@OrderCode986,@OrderCode987,@OrderCode988,@OrderCode989,@OrderCode990)) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime991)))) 	
Parameters:
@OrderCode982[String] = JGDD202000003
@OrderCode983[String] = JGDD202000004
@OrderCode984[String] = JGDD202000005
@OrderCode985[String] = JGDD202000006
@OrderCode986[String] = JGDD202000008
@OrderCode987[String] = JGDD202000003
@OrderCode988[String] = JGDD202000004
@OrderCode989[String] = JGDD202000004
@OrderCode990[String] = JGDD202000004
@DistributionTime991[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 18:06:40
Text:	 SELECT count(*) as r_cnt FROM [TbDistributionPlanInfo] WHERE (([TbDistributionPlanInfo].[OrderCode] IN (@OrderCode992,@OrderCode993,@OrderCode994,@OrderCode995,@OrderCode996)) AND ((DistributionStart='配送完成' and DATEPART(day,DeliveryCompleteTime)>DATEPART(day,DistributionTime)) or (DistributionStart='未配送' and DistributionTime>GETDATE())))	
Parameters:
@OrderCode992[String] = JGDD202000003
@OrderCode993[String] = JGDD202000004
@OrderCode994[String] = JGDD202000005
@OrderCode995[String] = JGDD202000006
@OrderCode996[String] = JGDD202000008


-----------------------------------------------------------------------------
2020-03-27 18:09:05
Text:	select TbAll.EarlyWarningCode,TbAll.BranchCode,TbAll.BranchName,TbAll.WorkAreaCode,TbAll.WorkAreaName,TbAll.SiteCode,TbAll.SiteName,TbAll.ProjectId,TbAll.YjMonth,TbAll.MenuCode,TbAll.EWNodeCode,TbAll.EWNodeName,TbAll.PersonnelCode,TbAll.PersonnelSource,TbAll.BegEwTiemNew from (select Tb.*,case when Tb.EWTimeType='年' then DATEADD(YEAR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='月' then DATEADD(MONTH,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='天' then DATEADD(DAY,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='时' then DATEADD(HOUR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='分' then DATEADD(MINUTE,Tb.EWTime,Tb.BegEwTiem) end as BegEwTiemNew,TbYjInfo.EarlyWarningCode as YjCode from (select ewt.EarlyWarningCode,DATENAME(year,GETDATE())+'-'+ DATENAME(MONTH,GETDATE())+'-'+ CONVERT(varchar(20),ewt.EWBegDay)+' '+CONVERT(varchar(20),ewt.EWBegHour)+':'+CONVERT(varchar(20),ewt.EWBegMinute)+':00' as BegEwTiem,ewt.BranchCode,cp1.CompanyFullName as BranchName,ewt.WorkAreaCode,cp2.CompanyFullName as WorkAreaName,ewt.SiteCode,cp3.CompanyFullName as SiteName,ewt.ProjectId,MONTH(GETDATE()) as YjMonth,ewt.MenuCode,ewn.EWNodeCode,ewn.EWNodeName,ewn.EWTimeType,ewn.EWTime,ewnp.PersonnelCode,ewnp.PersonnelSource,ewnp.DeptId,ewnp.RoleId from TbFormEarlyWarningBegTime ewt 
left join TbFormEarlyWarningNode ewn on ewt.EarlyWarningCode=ewn.EarlyWarningCode and ewt.ProjectId=ewn.ProjectId and ewt.MenuCode=ewn.MenuCode
left join TbFormEarlyWarningNodePersonnel ewnp on ewn.EarlyWarningCode=ewnp.EarlyWarningCode and ewn.EWNodeCode=ewnp.EWNodeCode and  ewn.MenuCode=ewnp.MenuCode and ewn.ProjectId=ewnp.ProjectId
left join TbCompany cp1 on ewt.BranchCode=cp1.CompanyCode
left join TbCompany cp2 on ewt.WorkAreaCode=cp2.CompanyCode
left join TbCompany cp3 on ewt.SiteCode=cp3.CompanyCode
where ewt.MenuCode='RawMonthDemandPlan') Tb 
left join (select EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId from TbFormEarlyWarningNodeInfo ewni
where ewni.EWFormDataCode=MONTH(GETDATE()) group by EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId) TbYjInfo on Tb.EarlyWarningCode=TbYjInfo.EarlyWarningCode and Tb.EWNodeCode=TbYjInfo.EWNodeCode and Tb.MenuCode=TbYjInfo.MenuCode and  Tb.YjMonth=TbYjInfo.EWFormDataCode and Tb.WorkAreaCode=TbYjInfo.WorkArea and Tb.ProjectId=TbYjInfo.ProjectId
where GETDATE()>=BegEwTiem and Tb.WorkAreaCode not in(select rmdp.WorkAreaCode from TbRawMaterialMonthDemandPlan rmdp where MONTH(InsertTime)=MONTH(GETDATE())
group by rmdp.WorkAreaCode)) TbAll where TbAll.YjCode is null and TbAll.PersonnelCode is not null and GETDATE()>=TbAll.BegEwTiemNew	


-----------------------------------------------------------------------------
2020-03-27 18:09:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
left join TbFlowDefine d on p.FlowCode=d.FlowCode
where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
union all
select COUNT(1) as MsgCount from TbFlowPerformMessage m 
LEFT JOIN TbUser tu ON m.UserCode=tu.UserCode
where (m.usercode=@UserCode OR tu.UserId=@UserCode)and IsRead=-1
union all
select SUM(Tb.earlywarningcount) as earlywarningcount from (
select COUNT(1) as earlywarningcount from TbFlowEarlyWarningInfo where EarlyWarningBTUser=@UserCode and EarlyWarningStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)
union all
select COUNT(1) as earlywarningcount from TbFormEarlyWarningNodeInfo where EWUserCode=@UserCode and EWStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:12:01
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
left join TbFlowDefine d on p.FlowCode=d.FlowCode
where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
union all
select COUNT(1) as MsgCount from TbFlowPerformMessage m 
LEFT JOIN TbUser tu ON m.UserCode=tu.UserCode
where (m.usercode=@UserCode OR tu.UserId=@UserCode)and IsRead=-1
union all
select SUM(Tb.earlywarningcount) as earlywarningcount from (
select COUNT(1) as earlywarningcount from TbFlowEarlyWarningInfo where EarlyWarningBTUser=@UserCode and EarlyWarningStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)
union all
select COUNT(1) as earlywarningcount from TbFormEarlyWarningNodeInfo where EWUserCode=@UserCode and EWStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:14:05
Text:	select TbAll.EarlyWarningCode,TbAll.BranchCode,TbAll.BranchName,TbAll.WorkAreaCode,TbAll.WorkAreaName,TbAll.SiteCode,TbAll.SiteName,TbAll.ProjectId,TbAll.YjMonth,TbAll.MenuCode,TbAll.EWNodeCode,TbAll.EWNodeName,TbAll.PersonnelCode,TbAll.PersonnelSource,TbAll.BegEwTiemNew from (select Tb.*,case when Tb.EWTimeType='年' then DATEADD(YEAR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='月' then DATEADD(MONTH,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='天' then DATEADD(DAY,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='时' then DATEADD(HOUR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='分' then DATEADD(MINUTE,Tb.EWTime,Tb.BegEwTiem) end as BegEwTiemNew,TbYjInfo.EarlyWarningCode as YjCode from (select ewt.EarlyWarningCode,DATENAME(year,GETDATE())+'-'+ DATENAME(MONTH,GETDATE())+'-'+ CONVERT(varchar(20),ewt.EWBegDay)+' '+CONVERT(varchar(20),ewt.EWBegHour)+':'+CONVERT(varchar(20),ewt.EWBegMinute)+':00' as BegEwTiem,ewt.BranchCode,cp1.CompanyFullName as BranchName,ewt.WorkAreaCode,cp2.CompanyFullName as WorkAreaName,ewt.SiteCode,cp3.CompanyFullName as SiteName,ewt.ProjectId,MONTH(GETDATE()) as YjMonth,ewt.MenuCode,ewn.EWNodeCode,ewn.EWNodeName,ewn.EWTimeType,ewn.EWTime,ewnp.PersonnelCode,ewnp.PersonnelSource,ewnp.DeptId,ewnp.RoleId from TbFormEarlyWarningBegTime ewt 
left join TbFormEarlyWarningNode ewn on ewt.EarlyWarningCode=ewn.EarlyWarningCode and ewt.ProjectId=ewn.ProjectId and ewt.MenuCode=ewn.MenuCode
left join TbFormEarlyWarningNodePersonnel ewnp on ewn.EarlyWarningCode=ewnp.EarlyWarningCode and ewn.EWNodeCode=ewnp.EWNodeCode and  ewn.MenuCode=ewnp.MenuCode and ewn.ProjectId=ewnp.ProjectId
left join TbCompany cp1 on ewt.BranchCode=cp1.CompanyCode
left join TbCompany cp2 on ewt.WorkAreaCode=cp2.CompanyCode
left join TbCompany cp3 on ewt.SiteCode=cp3.CompanyCode
where ewt.MenuCode='RawMonthDemandPlan') Tb 
left join (select EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId from TbFormEarlyWarningNodeInfo ewni
where ewni.EWFormDataCode=MONTH(GETDATE()) group by EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId) TbYjInfo on Tb.EarlyWarningCode=TbYjInfo.EarlyWarningCode and Tb.EWNodeCode=TbYjInfo.EWNodeCode and Tb.MenuCode=TbYjInfo.MenuCode and  Tb.YjMonth=TbYjInfo.EWFormDataCode and Tb.WorkAreaCode=TbYjInfo.WorkArea and Tb.ProjectId=TbYjInfo.ProjectId
where GETDATE()>=BegEwTiem and Tb.WorkAreaCode not in(select rmdp.WorkAreaCode from TbRawMaterialMonthDemandPlan rmdp where MONTH(InsertTime)=MONTH(GETDATE())
group by rmdp.WorkAreaCode)) TbAll where TbAll.YjCode is null and TbAll.PersonnelCode is not null and GETDATE()>=TbAll.BegEwTiemNew	


-----------------------------------------------------------------------------
2020-03-27 18:15:01
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
left join TbFlowDefine d on p.FlowCode=d.FlowCode
where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
union all
select COUNT(1) as MsgCount from TbFlowPerformMessage m 
LEFT JOIN TbUser tu ON m.UserCode=tu.UserCode
where (m.usercode=@UserCode OR tu.UserId=@UserCode)and IsRead=-1
union all
select SUM(Tb.earlywarningcount) as earlywarningcount from (
select COUNT(1) as earlywarningcount from TbFlowEarlyWarningInfo where EarlyWarningBTUser=@UserCode and EarlyWarningStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)
union all
select COUNT(1) as earlywarningcount from TbFormEarlyWarningNodeInfo where EWUserCode=@UserCode and EWStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:18:02
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
left join TbFlowDefine d on p.FlowCode=d.FlowCode
where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
union all
select COUNT(1) as MsgCount from TbFlowPerformMessage m 
LEFT JOIN TbUser tu ON m.UserCode=tu.UserCode
where (m.usercode=@UserCode OR tu.UserId=@UserCode)and IsRead=-1
union all
select SUM(Tb.earlywarningcount) as earlywarningcount from (
select COUNT(1) as earlywarningcount from TbFlowEarlyWarningInfo where EarlyWarningBTUser=@UserCode and EarlyWarningStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)
union all
select COUNT(1) as earlywarningcount from TbFormEarlyWarningNodeInfo where EWUserCode=@UserCode and EWStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:18:31
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode1) AND ([TbUser].[UserPwd] = @UserPwd2) 	
Parameters:
@UserCode1[String] = 101629
@UserPwd2[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-03-27 18:18:31
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 101629


-----------------------------------------------------------------------------
2020-03-27 18:18:31
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 101629


-----------------------------------------------------------------------------
2020-03-27 18:18:31
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 101629
@ProjectId[String] = 6245721945602523136
@OrgId[String] = 6386683729561128960


-----------------------------------------------------------------------------
2020-03-27 18:18:31
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode3 	
Parameters:
@UserCode3[String] = 101629


-----------------------------------------------------------------------------
2020-03-27 18:18:31
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu4,@ActionType5,@HostName6,@LogDate7,@UserCode8,@UserIP9);select scope_identity()	
Parameters:
@ActionMenu4[String] = 0
@ActionType5[String] = 登录系统
@HostName6[String] = 
@LogDate7[DateTime] = 2020/3/27 18:18:31
@UserCode8[String] = 101629
@UserIP9[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-03-27 18:18:36
Text:	 SELECT   [TbDistributionPlanInfo].*,[TbCompany].[ParentCompanyCode],[TbOrderProgress].[FinishProcessingDateTime] FROM [TbDistributionPlanInfo] LEFT OUTER JOIN [TbCompany] ON ([TbDistributionPlanInfo].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbOrderProgress] ON ([TbDistributionPlanInfo].[OrderCode] = [TbOrderProgress].[OrderCode])  WHERE (([TbDistributionPlanInfo].[Examinestatus] = @Examinestatus10) AND ([TbDistributionPlanInfo].[ProcessFactoryCode] = @ProcessFactoryCode11)) 	
Parameters:
@Examinestatus10[String] = 审核完成
@ProcessFactoryCode11[String] = 6386683214299275264


-----------------------------------------------------------------------------
2020-03-27 18:18:36
Text:	select isnull(sum(TbCF.Capacity),0) as Capacity,isnull(sum(TbCF.WeightSmallPlan),0) as WeightSmallPlan,isnull(cast(sum(TbCF.WeightSmallPlan)/sum(TbCF.Capacity)*100 as decimal(18,2)),0) as ActualLoadNew from (select cf.Capacity,Tb1.WeightSmallPlan,cf.ProcessFactoryCode from TbCapacityFilling cf  
left join(
select SUM(Tb.WeightSmallPlan) as WeightSmallPlan,Tb.ProcessFactoryCode from (
                            select isnull(SUM(wod.WeightSmallPlan),0) as WeightSmallPlan,wo.ProcessFactoryCode from TbWorkOrder wo
                            left join TbWorkOrderDetail wod on wo.OrderCode=wod.OrderCode
                            where (ISNULL(@ProcessFactoryCode,'')='' or wo.ProcessFactoryCode=@ProcessFactoryCode)
                            and CONVERT(varchar(7), wo.DistributionTime, 120)=@month
                            and wod.RevokeStart='正常' and wo.ProcessingState!='ConfirmWork' and wo.ProcessingState!='Finishing'  group by wo.ProcessFactoryCode
                            union all
                            select isnull(sum(opd.NoCompleted),0) as NoCompleted,op.ProcessFactoryCode from TbOrderProgress op
                            left join TbOrderProgressDetail opd on op.OrderCode=opd.OrderCode 
                            where (ISNULL(@ProcessFactoryCode,'')='' or op.ProcessFactoryCode=@ProcessFactoryCode)
                            and CONVERT(varchar(7), op.DistributionTime, 120)=CONVERT(varchar(4),YEAR(DATEADD(MONTH,-1,@month+'-01')))+'-'+Right(100+Month(DATEADD(MONTH,-1,@month+'-01')),2)
                            and opd.RevokeStart='正常'  group by op.ProcessFactoryCode)Tb  group by Tb.ProcessFactoryCode
) Tb1 on cf.ProcessFactoryCode=Tb1.ProcessFactoryCode 
where cf.CapacityMonth=@month
and (ISNULL(@ProcessFactoryCode,'')='' or cf.ProcessFactoryCode=@ProcessFactoryCode)) TbCF where (ISNULL(@ProcessFactoryCode,'')='' or TbCF.ProcessFactoryCode=@ProcessFactoryCode)	
Parameters:
@ProcessFactoryCode[String] = 6386683214299275264
@month[String] = 2020-03


-----------------------------------------------------------------------------
2020-03-27 18:18:36
Text:	 SELECT   TOP 1 [TbStorage].[StorageAdd],[TbStorage].[Tel],[TbUser].[UserName] FROM [TbStorage] LEFT OUTER JOIN [TbUser] ON ([TbStorage].[UserCode] = [TbUser].[UserCode])  WHERE [TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode12 	
Parameters:
@ProcessFactoryCode12[String] = 6386683214299275264


-----------------------------------------------------------------------------
2020-03-27 18:18:36
Text:	 SELECT   [TbDistributionPlanInfo].*,[TbCompany].[ParentCompanyCode],[TbOrderProgress].[FinishProcessingDateTime] FROM [TbDistributionPlanInfo] LEFT OUTER JOIN [TbCompany] ON ([TbDistributionPlanInfo].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbOrderProgress] ON ([TbDistributionPlanInfo].[OrderCode] = [TbOrderProgress].[OrderCode])  WHERE (([TbDistributionPlanInfo].[Examinestatus] = @Examinestatus13) AND ([TbDistributionPlanInfo].[ProcessFactoryCode] = @ProcessFactoryCode14)) 	
Parameters:
@Examinestatus13[String] = 审核完成
@ProcessFactoryCode14[String] = 6386683729561128960


-----------------------------------------------------------------------------
2020-03-27 18:18:36
Text:	select isnull(sum(TbCF.Capacity),0) as Capacity,isnull(sum(TbCF.WeightSmallPlan),0) as WeightSmallPlan,isnull(cast(sum(TbCF.WeightSmallPlan)/sum(TbCF.Capacity)*100 as decimal(18,2)),0) as ActualLoadNew from (select cf.Capacity,Tb1.WeightSmallPlan,cf.ProcessFactoryCode from TbCapacityFilling cf  
left join(
select SUM(Tb.WeightSmallPlan) as WeightSmallPlan,Tb.ProcessFactoryCode from (
                            select isnull(SUM(wod.WeightSmallPlan),0) as WeightSmallPlan,wo.ProcessFactoryCode from TbWorkOrder wo
                            left join TbWorkOrderDetail wod on wo.OrderCode=wod.OrderCode
                            where (ISNULL(@ProcessFactoryCode,'')='' or wo.ProcessFactoryCode=@ProcessFactoryCode)
                            and CONVERT(varchar(7), wo.DistributionTime, 120)=@month
                            and wod.RevokeStart='正常' and wo.ProcessingState!='ConfirmWork' and wo.ProcessingState!='Finishing'  group by wo.ProcessFactoryCode
                            union all
                            select isnull(sum(opd.NoCompleted),0) as NoCompleted,op.ProcessFactoryCode from TbOrderProgress op
                            left join TbOrderProgressDetail opd on op.OrderCode=opd.OrderCode 
                            where (ISNULL(@ProcessFactoryCode,'')='' or op.ProcessFactoryCode=@ProcessFactoryCode)
                            and CONVERT(varchar(7), op.DistributionTime, 120)=CONVERT(varchar(4),YEAR(DATEADD(MONTH,-1,@month+'-01')))+'-'+Right(100+Month(DATEADD(MONTH,-1,@month+'-01')),2)
                            and opd.RevokeStart='正常'  group by op.ProcessFactoryCode)Tb  group by Tb.ProcessFactoryCode
) Tb1 on cf.ProcessFactoryCode=Tb1.ProcessFactoryCode 
where cf.CapacityMonth=@month
and (ISNULL(@ProcessFactoryCode,'')='' or cf.ProcessFactoryCode=@ProcessFactoryCode)) TbCF where (ISNULL(@ProcessFactoryCode,'')='' or TbCF.ProcessFactoryCode=@ProcessFactoryCode)	
Parameters:
@ProcessFactoryCode[String] = 6386683729561128960
@month[String] = 2020-03


-----------------------------------------------------------------------------
2020-03-27 18:18:36
Text:	 SELECT   TOP 1 [TbStorage].[StorageAdd],[TbStorage].[Tel],[TbUser].[UserName] FROM [TbStorage] LEFT OUTER JOIN [TbUser] ON ([TbStorage].[UserCode] = [TbUser].[UserCode])  WHERE [TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode15 	
Parameters:
@ProcessFactoryCode15[String] = 6386683729561128960


-----------------------------------------------------------------------------
2020-03-27 18:18:36
Text:	 SELECT   [TbDistributionPlanInfo].*,[TbCompany].[ParentCompanyCode],[TbOrderProgress].[FinishProcessingDateTime] FROM [TbDistributionPlanInfo] LEFT OUTER JOIN [TbCompany] ON ([TbDistributionPlanInfo].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbOrderProgress] ON ([TbDistributionPlanInfo].[OrderCode] = [TbOrderProgress].[OrderCode])  WHERE (([TbDistributionPlanInfo].[Examinestatus] = @Examinestatus16) AND ([TbDistributionPlanInfo].[ProcessFactoryCode] = @ProcessFactoryCode17)) 	
Parameters:
@Examinestatus16[String] = 审核完成
@ProcessFactoryCode17[String] = 6386683947165814784


-----------------------------------------------------------------------------
2020-03-27 18:18:36
Text:	select isnull(sum(TbCF.Capacity),0) as Capacity,isnull(sum(TbCF.WeightSmallPlan),0) as WeightSmallPlan,isnull(cast(sum(TbCF.WeightSmallPlan)/sum(TbCF.Capacity)*100 as decimal(18,2)),0) as ActualLoadNew from (select cf.Capacity,Tb1.WeightSmallPlan,cf.ProcessFactoryCode from TbCapacityFilling cf  
left join(
select SUM(Tb.WeightSmallPlan) as WeightSmallPlan,Tb.ProcessFactoryCode from (
                            select isnull(SUM(wod.WeightSmallPlan),0) as WeightSmallPlan,wo.ProcessFactoryCode from TbWorkOrder wo
                            left join TbWorkOrderDetail wod on wo.OrderCode=wod.OrderCode
                            where (ISNULL(@ProcessFactoryCode,'')='' or wo.ProcessFactoryCode=@ProcessFactoryCode)
                            and CONVERT(varchar(7), wo.DistributionTime, 120)=@month
                            and wod.RevokeStart='正常' and wo.ProcessingState!='ConfirmWork' and wo.ProcessingState!='Finishing'  group by wo.ProcessFactoryCode
                            union all
                            select isnull(sum(opd.NoCompleted),0) as NoCompleted,op.ProcessFactoryCode from TbOrderProgress op
                            left join TbOrderProgressDetail opd on op.OrderCode=opd.OrderCode 
                            where (ISNULL(@ProcessFactoryCode,'')='' or op.ProcessFactoryCode=@ProcessFactoryCode)
                            and CONVERT(varchar(7), op.DistributionTime, 120)=CONVERT(varchar(4),YEAR(DATEADD(MONTH,-1,@month+'-01')))+'-'+Right(100+Month(DATEADD(MONTH,-1,@month+'-01')),2)
                            and opd.RevokeStart='正常'  group by op.ProcessFactoryCode)Tb  group by Tb.ProcessFactoryCode
) Tb1 on cf.ProcessFactoryCode=Tb1.ProcessFactoryCode 
where cf.CapacityMonth=@month
and (ISNULL(@ProcessFactoryCode,'')='' or cf.ProcessFactoryCode=@ProcessFactoryCode)) TbCF where (ISNULL(@ProcessFactoryCode,'')='' or TbCF.ProcessFactoryCode=@ProcessFactoryCode)	
Parameters:
@ProcessFactoryCode[String] = 6386683947165814784
@month[String] = 2020-03


-----------------------------------------------------------------------------
2020-03-27 18:18:36
Text:	 SELECT   TOP 1 [TbStorage].[StorageAdd],[TbStorage].[Tel],[TbUser].[UserName] FROM [TbStorage] LEFT OUTER JOIN [TbUser] ON ([TbStorage].[UserCode] = [TbUser].[UserCode])  WHERE [TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode18 	
Parameters:
@ProcessFactoryCode18[String] = 6386683947165814784


-----------------------------------------------------------------------------
2020-03-27 18:18:41
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6386685071075708928','6475435760374910976') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-03-27 18:18:41
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6387064461265608704


-----------------------------------------------------------------------------
2020-03-27 18:18:41
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
left join TbFlowDefine d on p.FlowCode=d.FlowCode
where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
union all
select COUNT(1) as MsgCount from TbFlowPerformMessage m 
LEFT JOIN TbUser tu ON m.UserCode=tu.UserCode
where (m.usercode=@UserCode OR tu.UserId=@UserCode)and IsRead=-1
union all
select SUM(Tb.earlywarningcount) as earlywarningcount from (
select COUNT(1) as earlywarningcount from TbFlowEarlyWarningInfo where EarlyWarningBTUser=@UserCode and EarlyWarningStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)
union all
select COUNT(1) as earlywarningcount from TbFormEarlyWarningNodeInfo where EWUserCode=@UserCode and EWStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6387064461265608704
@ProjectId[String] = 


-----------------------------------------------------------------------------
2020-03-27 18:18:42
Text:	SELECT MaterialName FROM TbRawMaterialArchives
                                GROUP BY MaterialName	


-----------------------------------------------------------------------------
2020-03-27 18:18:42
Text:	SELECT MaterialName FROM TbRawMaterialArchives
                                GROUP BY MaterialName	


-----------------------------------------------------------------------------
2020-03-27 18:18:42
Text:	select isnull(sum(TbCF.Capacity),0) as Capacity,isnull(sum(TbCF.WeightSmallPlan),0) as WeightSmallPlan,isnull(cast(sum(TbCF.WeightSmallPlan)/sum(TbCF.Capacity)*100 as decimal(18,2)),0) as ActualLoadNew from (select cf.Capacity,Tb1.WeightSmallPlan,cf.ProcessFactoryCode from TbCapacityFilling cf  
left join(
select SUM(Tb.WeightSmallPlan) as WeightSmallPlan,Tb.ProcessFactoryCode from (
                            select isnull(SUM(wod.WeightSmallPlan),0) as WeightSmallPlan,wo.ProcessFactoryCode from TbWorkOrder wo
                            left join TbWorkOrderDetail wod on wo.OrderCode=wod.OrderCode
                            where (ISNULL(@ProcessFactoryCode,'')='' or wo.ProcessFactoryCode=@ProcessFactoryCode)
                            and CONVERT(varchar(7), wo.DistributionTime, 120)=@month
                            and wod.RevokeStart='正常' and wo.ProcessingState!='ConfirmWork' and wo.ProcessingState!='Finishing'  group by wo.ProcessFactoryCode
                            union all
                            select isnull(sum(opd.NoCompleted),0) as NoCompleted,op.ProcessFactoryCode from TbOrderProgress op
                            left join TbOrderProgressDetail opd on op.OrderCode=opd.OrderCode 
                            where (ISNULL(@ProcessFactoryCode,'')='' or op.ProcessFactoryCode=@ProcessFactoryCode)
                            and CONVERT(varchar(7), op.DistributionTime, 120)=CONVERT(varchar(4),YEAR(DATEADD(MONTH,-1,@month+'-01')))+'-'+Right(100+Month(DATEADD(MONTH,-1,@month+'-01')),2)
                            and opd.RevokeStart='正常'  group by op.ProcessFactoryCode)Tb  group by Tb.ProcessFactoryCode
) Tb1 on cf.ProcessFactoryCode=Tb1.ProcessFactoryCode 
where cf.CapacityMonth=@month
and (ISNULL(@ProcessFactoryCode,'')='' or cf.ProcessFactoryCode=@ProcessFactoryCode)) TbCF where (ISNULL(@ProcessFactoryCode,'')='' or TbCF.ProcessFactoryCode=@ProcessFactoryCode)	
Parameters:
@ProcessFactoryCode[String] = 6386683729561128960
@month[String] = 2020-03


-----------------------------------------------------------------------------
2020-03-27 18:18:42
Text:	
                        select fewoi.DataCode as OddNumbers,
                         fewoi.EarlyWarningContent,
                         fewoi.EWFormDataCode,
                         CONVERT(varchar(100), fewoi.EarlyWarningTime, 120) as EarlyWarningTime,
                         EWFormCode,sm.MenuName,fn.FlowNodeName,cp1.CompanyFullName as BranchName,
                         cp2.CompanyFullName as WorkAreaName,cp3.CompanyFullName as SiteName,cp4.CompanyFullName as ProcessFactoryName,
                         u1.UserName as FlowSpUserName,u2.UserName as FlowYjUserName 
                        FROM (
                        select*
                           FROM ( 
                        		SELECT a.*, row_number()over(partition BY a.FlowCode ORDER BY a.FlowNodeCode,a.EarlyWarningTime desc) as group_idx 
                        		FROM TbFlowEarlyWarningOtherInfo  a
                        		INNER JOIN  TbFlowEarlyWarningInfo b ON a.FlowCode=b.FlowCode 
                        		AND a.EWFormDataCode=b.EWFormDataCode AND a.FlowNodeCode=b.FlowNodeCode 
                        		WHERE YEAR(a.EarlyWarningTime)= @Year and MONTH(a.EarlyWarningTime)= @Month AND b.EarlyWarningStart=0
                           ) ret
                        WHERE ret.group_idx =1
                        ) fewoi
                        left join TbFlowNode fn on fewoi.FlowCode=fn.FlowCode and fewoi.FlowNodeCode=fn.FlowNodeCode
                        left join TbSysMenu sm on fewoi.EWFormCode=sm.MenuCode
                        left join TbCompany cp1 on fewoi.BranchCode=cp1.CompanyCode
                        left join TbCompany cp2 on fewoi.WorkAreaCode=cp2.CompanyCode
                        left join TbCompany cp3 on fewoi.SiteCode=cp3.CompanyCode
                        left join TbCompany cp4 on fewoi.ProcessFactoryCode=cp4.CompanyCode
                        left join TbUser u1 on fewoi.FlowSpUserCode=u1.UserId
                        left join TbUser u2 on fewoi.FlowYjUserCode=u2.UserId where 1=1 and fewoi.ProcessFactoryCode='6386683729561128960' ORDER BY fewoi.EarlyWarningTime desc	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:18:42
Text:	--配送超期
                           select dpi.OrderCode,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as ProcessFactoryName,dpi.DistributionTime,dpi.DeliveryCompleteTime,dpi.Remark from TbDistributionPlanInfo dpi
                           left join TbCompany cp1 on dpi.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on dpi.ProcessFactoryCode=cp2.CompanyCode
                           where YEAR(dpi.DistributionTime)= @Year and MONTH(dpi.DistributionTime)= @Month
                           and (dpi.DeliveryCompleteTime>dpi.DistributionTime or (GETDATE()>dpi.DistributionTime and dpi.DeliveryCompleteTime is null))  and dpi.ProcessFactoryCode='6386683729561128960' ORDER BY dpi.DistributionTime desc	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:18:42
Text:	select TbYj.*,cp1.CompanyFullName as SiteName,tcr.EnterSpaceTime,tcr.StartDischargeTime,tcr.EndDischargeTime,disEnt.ProcessFactoryCode,cp.CompanyFullName as ProcessFactoryName from (select min(EwTime) as EwTime,MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId from TbFormEarlyWarningNodeInfo where  MenuCode='SiteDischargeCargo' 
						   group by MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId) TbYj
						   left join TbTransportCarReport tcr on TbYj.EWFormDataCode=tcr.DisEntOrderId
                           left join TbDistributionEnt disEnt on tcr.DistributionCode=disEnt.DistributionCode
                           left join TbCompany cp on disEnt.ProcessFactoryCode=cp.CompanyCode
                           left join TbCompany cp1 on TbYj.SiteCode=cp1.CompanyCode
						   where YEAR(TbYj.EWTime)= @Year and MONTH(TbYj.EWTime)= @Month  and disEnt.ProcessFactoryCode='6386683729561128960' ORDER BY tcr.EnterSpaceTime desc	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:18:42
Text:	select TbYj.*,cp1.CompanyFullName as SiteName,sfs.DistributionCode,sdc.DistributionTime,sfs.SigninTime,sfs.ProcessFactoryCode,cp.CompanyFullName as ProcessFactoryName from (select min(EwTime) as EwTime,MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId from TbFormEarlyWarningNodeInfo where  MenuCode='SemiFinishedSign' 
						   group by MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId) TbYj
						   left join TbSemiFinishedSign sfs on TbYj.EWFormDataCode=sfs.ID
                           left join TbSiteDischargeCargo sdc on sfs.DistributionCode=sdc.DistributionCode and sfs.DischargeCargoCode=sdc.DischargeCargoCode
                           left join TbCompany cp on sfs.ProcessFactoryCode=cp.CompanyCode
                           left join TbCompany cp1 on TbYj.SiteCode=cp1.CompanyCode
						   where YEAR(TbYj.EWTime)= @Year and MONTH(TbYj.EWTime)= @Month and sfs.ProcessFactoryCode='6386683729561128960'	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:18:42
Text:	select T.id,T.CompanyCode,T.ParentCompanyCode,T.CompanyFullName,T.Address,T.OrgType,pc.ProjectId from  TbCompany T
                           left join TbProjectCompany pc on T.CompanyCode=pc.CompanyCode where T.OrgType!=1 order by T.id asc	


-----------------------------------------------------------------------------
2020-03-27 18:18:42
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE ((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode23) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus24)) 	
Parameters:
@ProcessFactoryCode23[String] = 6386683729561128960
@Examinestatus24[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:18:42
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode25,@OrderCode26,@OrderCode27,@OrderCode28,@OrderCode29,@OrderCode30,@OrderCode31,@OrderCode32)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode25[String] = JGDD202000001
@OrderCode26[String] = JGDD202000002
@OrderCode27[String] = JGDD202000003
@OrderCode28[String] = JGDD202000004
@OrderCode29[String] = JGDD202000005
@OrderCode30[String] = JGDD202000006
@OrderCode31[String] = JGDD202000008
@OrderCode32[String] = JGDD202000009


-----------------------------------------------------------------------------
2020-03-27 18:18:42
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE (((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode19)) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState20,@ProcessingState21,@ProcessingState22))) 	
Parameters:
@ProcessFactoryCode19[String] = 6386683729561128960
@ProcessingState20[String] = Processing
@ProcessingState21[String] = Received
@ProcessingState22[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 18:18:42
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat33) 	
Parameters:
@DaetailWorkStrat33[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 18:18:42
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[OrderCode] IN (@OrderCode34,@OrderCode35,@OrderCode36,@OrderCode37,@OrderCode38,@OrderCode39,@OrderCode40,@OrderCode41,@OrderCode42,@OrderCode43,@OrderCode44)) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime45)))) 	
Parameters:
@OrderCode34[String] = JGDD202000001
@OrderCode35[String] = JGDD202000002
@OrderCode36[String] = JGDD202000003
@OrderCode37[String] = JGDD202000004
@OrderCode38[String] = JGDD202000005
@OrderCode39[String] = JGDD202000006
@OrderCode40[String] = JGDD202000008
@OrderCode41[String] = JGDD202000003
@OrderCode42[String] = JGDD202000004
@OrderCode43[String] = JGDD202000004
@OrderCode44[String] = JGDD202000004
@DistributionTime45[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 18:18:42
Text:	 SELECT   [TbDistributionPlanInfo].[DistributionStart] FROM [TbDistributionPlanInfo]  WHERE ([TbDistributionPlanInfo].[OrderCode] IN (@OrderCode46,@OrderCode47,@OrderCode48,@OrderCode49,@OrderCode50,@OrderCode51,@OrderCode52)) 	
Parameters:
@OrderCode46[String] = JGDD202000001
@OrderCode47[String] = JGDD202000002
@OrderCode48[String] = JGDD202000003
@OrderCode49[String] = JGDD202000004
@OrderCode50[String] = JGDD202000005
@OrderCode51[String] = JGDD202000006
@OrderCode52[String] = JGDD202000008


-----------------------------------------------------------------------------
2020-03-27 18:18:42
Text:	 SELECT   [TbDistributionEntOrder].* FROM [TbDistributionEntOrder] LEFT OUTER JOIN [TbDistributionEnt] ON ([TbDistributionEntOrder].[DistributionCode] = [TbDistributionEnt].[DistributionCode])  WHERE ([TbDistributionEntOrder].[OrderCode] IN (@OrderCode53,@OrderCode54,@OrderCode55,@OrderCode56,@OrderCode57,@OrderCode58,@OrderCode59)) 	
Parameters:
@OrderCode53[String] = JGDD202000001
@OrderCode54[String] = JGDD202000002
@OrderCode55[String] = JGDD202000003
@OrderCode56[String] = JGDD202000004
@OrderCode57[String] = JGDD202000005
@OrderCode58[String] = JGDD202000006
@OrderCode59[String] = JGDD202000008


-----------------------------------------------------------------------------
2020-03-27 18:18:42
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE ((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode60) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus61)) 	
Parameters:
@ProcessFactoryCode60[String] = 6386683729561128960
@Examinestatus61[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:18:42
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode62,@OrderCode63,@OrderCode64,@OrderCode65,@OrderCode66,@OrderCode67,@OrderCode68,@OrderCode69)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode62[String] = JGDD202000001
@OrderCode63[String] = JGDD202000002
@OrderCode64[String] = JGDD202000003
@OrderCode65[String] = JGDD202000004
@OrderCode66[String] = JGDD202000005
@OrderCode67[String] = JGDD202000006
@OrderCode68[String] = JGDD202000008
@OrderCode69[String] = JGDD202000009


-----------------------------------------------------------------------------
2020-03-27 18:18:42
Text:	SELECT 
                            '审批超时' as YjTypeName,COUNT(1) as YjNum
                            FROM (
									SELECT a.*, row_number()over(partition BY a.FlowCode ORDER BY a.FlowNodeCode,a.EarlyWarningTime desc) as group_idx 
									FROM TbFlowEarlyWarningOtherInfo  a
									INNER JOIN  TbFlowEarlyWarningInfo b ON a.FlowCode=b.FlowCode 
									AND a.EWFormDataCode=b.EWFormDataCode AND a.FlowNodeCode=b.FlowNodeCode 
									WHERE  b.EarlyWarningStart=0 AND YEAR(a.EarlyWarningTime)= @Year and MONTH(a.EarlyWarningTime)= @Month  and a.ProcessFactoryCode='6386683729561128960'
							   ) Tb1
                            WHERE Tb1.group_idx =1
                           union all
                            select '未报月度需求计划' as YjTypeName,COUNT(1)as YjNum
                             FROM ( 
                                  SELECT *, row_number()over(partition BY EarlyWarningCode,EWFormDataCode ORDER BY EWNodeCode,EWTime desc) as group_idx 
                                  FROM TbFormEarlyWarningNodeInfo fwqi
                                  WHERE fwqi.MenuCode='RawMonthDemandPlan' AND fwqi.EWStart=0 AND YEAR(fwqi.EWTime)= @Year and MONTH(fwqi.EWTime)= @Month   
                             ) Tb2
                             WHERE Tb2.group_idx =1
                           union all
                           select '原材料供货超时' as YjTypeName,COUNT(1) as YjNum from (
                           select BatchPlanNum,cp1.CompanyFullName as BranchName,cp2.CompanyFullName as WorkAreaName,cp3.CompanyFullName as SiteName,cp4.CompanyFullName as ProcessFactoryName,sup.SupplyDate,sup.SupplyCompleteTime,sup.ProjectId from TbSupplyList sup
                           left join TbCompany cp1 on cp1.CompanyCode=sup.BranchCode
                           left join TbCompany cp2 on cp2.CompanyCode=sup.WorkAreaCode
                           left join TbCompany cp3 on cp3.CompanyCode=sup.SiteCode
                           left join TbCompany cp4 on cp4.CompanyCode=sup.ProcessFactoryCode
                           where (sup.SupplyCompleteTime>sup.SupplyDate or (GETDATE()>sup.SupplyDate and sup.SupplyCompleteTime is null))
						   and YEAR(sup.SupplyDate)= @Year and MONTH(sup.SupplyDate)= @Month  and sup.ProcessFactoryCode='6386683729561128960') Tb3
                           union all
                           select '加急订单' as YjTypeName,COUNT(1) as YjNum from (--加急订单个数
                           select wo.OrderCode,wo.DistributionTime,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as ProcessFactoryName from TbWorkOrder wo
                           left join TbCompany cp1 on wo.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on wo.ProcessFactoryCode=cp2.CompanyCode
                           where UrgentDegree='Urgent' 
						   and YEAR(wo.DistributionTime)= @Year and MONTH(wo.DistributionTime)= @Month  and wo.ProcessFactoryCode='6386683729561128960') Tb4
                           union all
                           select '加工进度滞后' as YjTypeName,COUNT(1) as YjNum from (--加工进度滞后
                           select op.OrderCode,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as ProcessFactoryName,op.DistributionTime,op.FinishProcessingDateTime from TbOrderProgress op 
                           left join TbCompany cp1 on op.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on op.ProcessFactoryCode=cp2.CompanyCode
                           where YEAR(op.DistributionTime)= @Year and MONTH(op.DistributionTime)= @Month
                           and (op.FinishProcessingDateTime>op.DistributionTime or (GETDATE()>op.DistributionTime and op.FinishProcessingDateTime is null))  and op.ProcessFactoryCode='6386683729561128960') Tb5
                           union all
                           select '接收配送超期' as YjTypeName,COUNT(1) as YjNum from (--配送超期
                           select dpi.OrderCode,cp1.CompanyFullName as SIteName,cp2.CompanyFullName as ProcessFactoryName,dpi.DistributionTime,dpi.DeliveryCompleteTime from TbDistributionPlanInfo dpi
                           left join TbCompany cp1 on dpi.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on dpi.ProcessFactoryCode=cp2.CompanyCode
                           where YEAR(dpi.DistributionTime)= @Year and MONTH(dpi.DistributionTime)= @Month
                           and (dpi.DeliveryCompleteTime>dpi.DistributionTime or (GETDATE()>dpi.DistributionTime and dpi.DeliveryCompleteTime is null))  and dpi.ProcessFactoryCode='6386683729561128960') Tb6 
                           union all
                           select '卸货超时' as YjTypeName,COUNT(1) as YjNum from(--卸货超时
                           select TbYj.*,cp1.CompanyFullName as SiteName,tcr.EnterSpaceTime,tcr.StartDischargeTime,tcr.EndDischargeTime,disEnt.ProcessFactoryCode,cp.CompanyFullName as ProcessFactoryName from (select min(EwTime) as EwTime,MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId from TbFormEarlyWarningNodeInfo where  MenuCode='SiteDischargeCargo' 
						   group by MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId) TbYj
						   left join TbTransportCarReport tcr on TbYj.EWFormDataCode=tcr.DisEntOrderId
                           left join TbDistributionEnt disEnt on tcr.DistributionCode=disEnt.DistributionCode
                           left join TbCompany cp on disEnt.ProcessFactoryCode=cp.CompanyCode
                           left join TbCompany cp1 on TbYj.SiteCode=cp1.CompanyCode
						   where YEAR(TbYj.EWTime)= @Year and MONTH(TbYj.EWTime)= @Month  and disEnt.ProcessFactoryCode='6386683729561128960') Tb7
                           union all
                           select '签收超时' as YjTypeName,COUNT(1) as YjNum from (select TbYj.*,cp1.CompanyFullName as SiteName,sfs.DistributionCode,sdc.DistributionTime,sfs.SigninTime,sfs.ProcessFactoryCode,cp.CompanyFullName as ProcessFactoryName from (select min(EwTime) as EwTime,MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId from TbFormEarlyWarningNodeInfo where  MenuCode='SemiFinishedSign' 
						   group by MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId) TbYj
						   left join TbSemiFinishedSign sfs on TbYj.EWFormDataCode=sfs.ID
                           left join TbSiteDischargeCargo sdc on sfs.DistributionCode=sdc.DistributionCode and sfs.DischargeCargoCode=sdc.DischargeCargoCode
                           left join TbCompany cp on sfs.ProcessFactoryCode=cp.CompanyCode
                           left join TbCompany cp1 on TbYj.SiteCode=cp1.CompanyCode
						   where YEAR(TbYj.EWTime)= @Year and MONTH(TbYj.EWTime)= @Month  and sfs.ProcessFactoryCode='6386683729561128960') Tb8	
Parameters:
@Year[String] = 2020
@Month[String] = 03


-----------------------------------------------------------------------------
2020-03-27 18:18:42
Text:	--加急订单个数
                           select wo.OrderCode,wo.DistributionTime,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as ProcessFactoryName from TbWorkOrder wo
                           left join TbCompany cp1 on wo.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on wo.ProcessFactoryCode=cp2.CompanyCode
                           where UrgentDegree='Urgent'
                           and YEAR(wo.DistributionTime)= @Year and MONTH(wo.DistributionTime)= @Month  and wo.ProcessFactoryCode='6386683729561128960' ORDER BY wo.DistributionTime desc	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:18:43
Text:	select T.id,T.CompanyCode,T.ParentCompanyCode,T.CompanyFullName,T.Address,T.OrgType,pc.ProjectId from  TbCompany T
                           left join TbProjectCompany pc on T.CompanyCode=pc.CompanyCode where T.OrgType!=1 order by T.id asc	


-----------------------------------------------------------------------------
2020-03-27 18:18:43
Text:	 SELECT   [TbOrderProgress].[ProcessingState],[TbOrderProgress].[FinishProcessingDateTime],[TbOrderProgress].[DistributionTime],[TbOrderProgress].[SiteCode] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[SiteCode] IN (@SiteCode70,@SiteCode71,@SiteCode72,@SiteCode73,@SiteCode74,@SiteCode75,@SiteCode76,@SiteCode77,@SiteCode78,@SiteCode79,@SiteCode80,@SiteCode81,@SiteCode82,@SiteCode83,@SiteCode84,@SiteCode85,@SiteCode86,@SiteCode87,@SiteCode88,@SiteCode89,@SiteCode90,@SiteCode91,@SiteCode92,@SiteCode93,@SiteCode94,@SiteCode95,@SiteCode96,@SiteCode97,@SiteCode98,@SiteCode99,@SiteCode100,@SiteCode101,@SiteCode102,@SiteCode103,@SiteCode104,@SiteCode105,@SiteCode106,@SiteCode107,@SiteCode108,@SiteCode109,@SiteCode110,@SiteCode111,@SiteCode112,@SiteCode113,@SiteCode114,@SiteCode115,@SiteCode116,@SiteCode117,@SiteCode118,@SiteCode119,@SiteCode120,@SiteCode121,@SiteCode122,@SiteCode123,@SiteCode124,@SiteCode125,@SiteCode126,@SiteCode127,@SiteCode128,@SiteCode129,@SiteCode130,@SiteCode131,@SiteCode132,@SiteCode133,@SiteCode134,@SiteCode135,@SiteCode136,@SiteCode137,@SiteCode138,@SiteCode139,@SiteCode140,@SiteCode141,@SiteCode142,@SiteCode143,@SiteCode144,@SiteCode145,@SiteCode146,@SiteCode147,@SiteCode148,@SiteCode149,@SiteCode150,@SiteCode151,@SiteCode152,@SiteCode153,@SiteCode154,@SiteCode155,@SiteCode156,@SiteCode157,@SiteCode158,@SiteCode159,@SiteCode160,@SiteCode161,@SiteCode162,@SiteCode163,@SiteCode164,@SiteCode165,@SiteCode166,@SiteCode167,@SiteCode168,@SiteCode169,@SiteCode170,@SiteCode171,@SiteCode172,@SiteCode173,@SiteCode174,@SiteCode175,@SiteCode176,@SiteCode177,@SiteCode178,@SiteCode179,@SiteCode180,@SiteCode181,@SiteCode182,@SiteCode183,@SiteCode184,@SiteCode185,@SiteCode186,@SiteCode187,@SiteCode188,@SiteCode189,@SiteCode190,@SiteCode191,@SiteCode192,@SiteCode193,@SiteCode194,@SiteCode195,@SiteCode196,@SiteCode197,@SiteCode198,@SiteCode199,@SiteCode200,@SiteCode201,@SiteCode202,@SiteCode203,@SiteCode204,@SiteCode205,@SiteCode206,@SiteCode207,@SiteCode208,@SiteCode209,@SiteCode210,@SiteCode211,@SiteCode212,@SiteCode213,@SiteCode214,@SiteCode215,@SiteCode216,@SiteCode217,@SiteCode218,@SiteCode219,@SiteCode220,@SiteCode221,@SiteCode222,@SiteCode223,@SiteCode224,@SiteCode225,@SiteCode226,@SiteCode227,@SiteCode228,@SiteCode229,@SiteCode230,@SiteCode231,@SiteCode232,@SiteCode233,@SiteCode234,@SiteCode235,@SiteCode236,@SiteCode237,@SiteCode238,@SiteCode239,@SiteCode240,@SiteCode241,@SiteCode242,@SiteCode243,@SiteCode244,@SiteCode245,@SiteCode246,@SiteCode247,@SiteCode248,@SiteCode249,@SiteCode250,@SiteCode251,@SiteCode252,@SiteCode253,@SiteCode254,@SiteCode255,@SiteCode256,@SiteCode257,@SiteCode258,@SiteCode259,@SiteCode260,@SiteCode261,@SiteCode262,@SiteCode263,@SiteCode264,@SiteCode265,@SiteCode266,@SiteCode267,@SiteCode268,@SiteCode269,@SiteCode270,@SiteCode271,@SiteCode272,@SiteCode273,@SiteCode274,@SiteCode275,@SiteCode276,@SiteCode277,@SiteCode278,@SiteCode279,@SiteCode280,@SiteCode281,@SiteCode282,@SiteCode283,@SiteCode284,@SiteCode285,@SiteCode286,@SiteCode287,@SiteCode288,@SiteCode289,@SiteCode290,@SiteCode291,@SiteCode292,@SiteCode293,@SiteCode294,@SiteCode295,@SiteCode296,@SiteCode297,@SiteCode298,@SiteCode299,@SiteCode300,@SiteCode301,@SiteCode302,@SiteCode303,@SiteCode304,@SiteCode305,@SiteCode306,@SiteCode307,@SiteCode308,@SiteCode309,@SiteCode310,@SiteCode311,@SiteCode312,@SiteCode313,@SiteCode314,@SiteCode315,@SiteCode316,@SiteCode317)) AND (YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=3)) 	
Parameters:
@SiteCode70[String] = 6274027775095472128
@SiteCode71[String] = 6274027929433276416
@SiteCode72[String] = 6417410523612188672
@SiteCode73[String] = 6274028333340557312
@SiteCode74[String] = 6274028829845487616
@SiteCode75[String] = 6274029086029381632
@SiteCode76[String] = 6274029528142577664
@SiteCode77[String] = 6274029966388625408
@SiteCode78[String] = 6274030152053686272
@SiteCode79[String] = 6274030373047369728
@SiteCode80[String] = 6274030913332445184
@SiteCode81[String] = 6267789807737372672
@SiteCode82[String] = 6267790255894560768
@SiteCode83[String] = 6267790460492709888
@SiteCode84[String] = 6267790574804271104
@SiteCode85[String] = 6267791036517449728
@SiteCode86[String] = 6267791338536697856
@SiteCode87[String] = 6267791654132908032
@SiteCode88[String] = 6267790081113718784
@SiteCode89[String] = 6267790783294734336
@SiteCode90[String] = 6267791210027417600
@SiteCode91[String] = 6267791528110850048
@SiteCode92[String] = 6437059801301262336
@SiteCode93[String] = 6308426901824208896
@SiteCode94[String] = 6276140742482067456
@SiteCode95[String] = 6276141050964738048
@SiteCode96[String] = 6276141450283450368
@SiteCode97[String] = 6276141737463250944
@SiteCode98[String] = 6276141926932545536
@SiteCode99[String] = 6267796592825204736
@SiteCode100[String] = 6267796864196673536
@SiteCode101[String] = 6267797037211713536
@SiteCode102[String] = 6267797181319610368
@SiteCode103[String] = 6276760608893304832
@SiteCode104[String] = 6267798187931598848
@SiteCode105[String] = 6267798388054425600
@SiteCode106[String] = 6267749616851091456
@SiteCode107[String] = 6267750471750909952
@SiteCode108[String] = 6267750709144322048
@SiteCode109[String] = 6267750895786655744
@SiteCode110[String] = 6267751010588950528
@SiteCode111[String] = 6267753037104676864
@SiteCode112[String] = 6267754200801738752
@SiteCode113[String] = 6267754324688896000
@SiteCode114[String] = 6267797518566817792
@SiteCode115[String] = 6267783175129268224
@SiteCode116[String] = 6267783320914886656
@SiteCode117[String] = 6267783444885929984
@SiteCode118[String] = 6267783577954418688
@SiteCode119[String] = 6267784612617912320
@SiteCode120[String] = 6267785016667799552
@SiteCode121[String] = 6267785185136214016
@SiteCode122[String] = 6267785381991677952
@SiteCode123[String] = 6267785590951903232
@SiteCode124[String] = 6267785762842869760
@SiteCode125[String] = 6267793585479876608
@SiteCode126[String] = 6267793380881727488
@SiteCode127[String] = 6437060915425845248
@SiteCode128[String] = 6284878460246556672
@SiteCode129[String] = 6284879065547538432
@SiteCode130[String] = 6285119541664022528
@SiteCode131[String] = 6285120302351384576
@SiteCode132[String] = 6285181647230861312
@SiteCode133[String] = 6285120520983674880
@SiteCode134[String] = 6285120866493661184
@SiteCode135[String] = 6285121357168508928
@SiteCode136[String] = 6285122203776188416
@SiteCode137[String] = 6437059163368595456
@SiteCode138[String] = 6374383547544903680
@SiteCode139[String] = 6374384032955899904
@SiteCode140[String] = 6374384202665828352
@SiteCode141[String] = 6274029086029381711
@SiteCode142[String] = 6274029086029381712
@SiteCode143[String] = 6274029086029381713
@SiteCode144[String] = 6274029086029381714
@SiteCode145[String] = 6274029086029381721
@SiteCode146[String] = 6274029086029381722
@SiteCode147[String] = 6274029086029381723
@SiteCode148[String] = 6274029086029381731
@SiteCode149[String] = 6274029086029381741
@SiteCode150[String] = 6274029086029381742
@SiteCode151[String] = 6274029086029381743
@SiteCode152[String] = 6274029086029381751
@SiteCode153[String] = 6274029086029381752
@SiteCode154[String] = 6274029086029381753
@SiteCode155[String] = 6274029086029381754
@SiteCode156[String] = 6274029086029381761
@SiteCode157[String] = 6274029086029381762
@SiteCode158[String] = 6274029086029381763
@SiteCode159[String] = 6274029086029381764
@SiteCode160[String] = 6274029086029381765
@SiteCode161[String] = 6274029086029381771
@SiteCode162[String] = 6274029086029381772
@SiteCode163[String] = 6274029086029381773
@SiteCode164[String] = 6274029086029381774
@SiteCode165[String] = 6274029086029381781
@SiteCode166[String] = 6247574415609991503
@SiteCode167[String] = 6247574415609991475
@SiteCode168[String] = 6247574415609991476
@SiteCode169[String] = 6247574415609991516
@SiteCode170[String] = 6247574415609991459
@SiteCode171[String] = 6247574415609991379
@SiteCode172[String] = 6247574415609991461
@SiteCode173[String] = 6247574415609991489
@SiteCode174[String] = 6247574415609991491
@SiteCode175[String] = 6247574415609991492
@SiteCode176[String] = 6247574415609991493
@SiteCode177[String] = 6247574415609991462
@SiteCode178[String] = 6247574415609991494
@SiteCode179[String] = 6247574415609991515
@SiteCode180[String] = 6247574415609991479
@SiteCode181[String] = 6247574415609991513
@SiteCode182[String] = 6247574415609991514
@SiteCode183[String] = 6247574415609991498
@SiteCode184[String] = 6247574415609991466
@SiteCode185[String] = 6247574415609991499
@SiteCode186[String] = 6247574415609991500
@SiteCode187[String] = 6247574415609991477
@SiteCode188[String] = 6247574415609991485
@SiteCode189[String] = 6247574415609991470
@SiteCode190[String] = 6247574415609991471
@SiteCode191[String] = 6247574415609991328
@SiteCode192[String] = 6247574415609991463
@SiteCode193[String] = 6247574415609991472
@SiteCode194[String] = 6247574415609991473
@SiteCode195[String] = 6247574415609991508
@SiteCode196[String] = 6247574415609991518
@SiteCode197[String] = 6247574415609991528
@SiteCode198[String] = 6247574415609991538
@SiteCode199[String] = 6247574415609991548
@SiteCode200[String] = 6247574415609991484
@SiteCode201[String] = 6247574415609991457
@SiteCode202[String] = 6247574415609991458
@SiteCode203[String] = 6247574415609991456
@SiteCode204[String] = 6247574415609991486
@SiteCode205[String] = 6247574415609991487
@SiteCode206[String] = 6247574415609991496
@SiteCode207[String] = 6247574415609991497
@SiteCode208[String] = 6247574415609991465
@SiteCode209[String] = 6247574415609991596
@SiteCode210[String] = 6247574415609991469
@SiteCode211[String] = 6247574415609991506
@SiteCode212[String] = 6247574415609991507
@SiteCode213[String] = 6247574415609991483
@SiteCode214[String] = 6247574415609991468
@SiteCode215[String] = 6247574415609991504
@SiteCode216[String] = 6247574415609991505
@SiteCode217[String] = 6247574415609991481
@SiteCode218[String] = 6247574415609991482
@SiteCode219[String] = 6247574415609991301
@SiteCode220[String] = 6247574415609991448
@SiteCode221[String] = 6247574415609991464
@SiteCode222[String] = 6247574415609991467
@SiteCode223[String] = 6247574415609991480
@SiteCode224[String] = 6247574415609991501
@SiteCode225[String] = 6247574415609991502
@SiteCode226[String] = 6247574415609991474
@SiteCode227[String] = 6353366542494859264
@SiteCode228[String] = 6353366542893318144
@SiteCode229[String] = 6353366543044313088
@SiteCode230[String] = 6353366543228862464
@SiteCode231[String] = 6353366543409217536
@SiteCode232[String] = 6353366543606349824
@SiteCode233[String] = 6353366543811870720
@SiteCode234[String] = 6353366544071917568
@SiteCode235[String] = 6353366544277438464
@SiteCode236[String] = 6353366544436822016
@SiteCode237[String] = 6353366544650731520
@SiteCode238[String] = 6353366544873029632
@SiteCode239[String] = 6353366545128882176
@SiteCode240[String] = 6353366545544118272
@SiteCode241[String] = 6353366545888051200
@SiteCode242[String] = 6353366546290704384
@SiteCode243[String] = 6353366546684968960
@SiteCode244[String] = 6353366547070844928
@SiteCode245[String] = 6353366547507052544
@SiteCode246[String] = 6353366548132003840
@SiteCode247[String] = 6353366545346985984
@SiteCode248[String] = 6353366545728667648
@SiteCode249[String] = 6353366546106155008
@SiteCode250[String] = 6353366546496225280
@SiteCode251[String] = 6353366546898878464
@SiteCode252[String] = 6353366547276365824
@SiteCode253[String] = 6353366547746127872
@SiteCode254[String] = 6353366548492713984
@SiteCode255[String] = 6353366557258809344
@SiteCode256[String] = 6353366557393027072
@SiteCode257[String] = 6353366557539827712
@SiteCode258[String] = 6353366557787291648
@SiteCode259[String] = 6353366557908926464
@SiteCode260[String] = 6353366558022172672
@SiteCode261[String] = 6353366558168973312
@SiteCode262[String] = 6353366535347765248
@SiteCode263[String] = 6353366535595229184
@SiteCode264[String] = 6353366535834304512
@SiteCode265[String] = 6353366536274706432
@SiteCode266[String] = 6353366536589279232
@SiteCode267[String] = 6353366536941600768
@SiteCode268[String] = 6353366537365225472
@SiteCode269[String] = 6353366539030364160
@SiteCode270[String] = 6353366556675801088
@SiteCode271[String] = 6353366556818407424
@SiteCode272[String] = 6353366556948430848
@SiteCode273[String] = 6353366557132980224
@SiteCode274[String] = 6353366541391757312
@SiteCode275[String] = 6353366541916045312
@SiteCode276[String] = 6353366542264172544
@SiteCode277[String] = 6353366542683602944
@SiteCode278[String] = 6353366540196380672
@SiteCode279[String] = 6353366540808749056
@SiteCode280[String] = 6353366541085573120
@SiteCode281[String] = 6353366541718913024
@SiteCode282[String] = 6353366542121566208
@SiteCode283[String] = 6353366550040412160
@SiteCode284[String] = 6353366550489202688
@SiteCode285[String] = 6353366550698917888
@SiteCode286[String] = 6353366550891855872
@SiteCode287[String] = 6353366551416143872
@SiteCode288[String] = 6353366553555238912
@SiteCode289[String] = 6353366553697845248
@SiteCode290[String] = 6353366554050166784
@SiteCode291[String] = 6353366548702429184
@SiteCode292[String] = 6353366548899561472
@SiteCode293[String] = 6353366549050556416
@SiteCode294[String] = 6353366549285437440
@SiteCode295[String] = 6353366549486764032
@SiteCode296[String] = 6353366549679702016
@SiteCode297[String] = 6353366549851668480
@SiteCode298[String] = 6353366550258515968
@SiteCode299[String] = 6353366555786608640
@SiteCode300[String] = 6353366554188578816
@SiteCode301[String] = 6353366554649952256
@SiteCode302[String] = 6353366554771587072
@SiteCode303[String] = 6353366554930970624
@SiteCode304[String] = 6353366555102937088
@SiteCode305[String] = 6353366555258126336
@SiteCode306[String] = 6353366555438481408
@SiteCode307[String] = 6353366555597864960
@SiteCode308[String] = 6353366555916632064
@SiteCode309[String] = 6353366556071821312
@SiteCode310[String] = 6353366556214427648
@SiteCode311[String] = 6353366556386394112
@SiteCode312[String] = 6353366556524806144
@SiteCode313[String] = 6353366551172874240
@SiteCode314[String] = 6353366553857228800
@SiteCode315[String] = 6374383547544903681
@SiteCode316[String] = 6374384032955899902
@SiteCode317[String] = 6374384202665828353


-----------------------------------------------------------------------------
2020-03-27 18:18:43
Text:	--原材料供货超时
                           select BatchPlanNum,cp1.CompanyFullName as BranchName,cp2.CompanyFullName as WorkAreaName,cp3.CompanyFullName as SiteName,cp4.CompanyFullName as ProcessFactoryName,sup.SupplyDate,sup.SupplyCompleteTime,sup.ProjectId,sup.Remarks from TbSupplyList sup
                           left join TbCompany cp1 on cp1.CompanyCode=sup.BranchCode
                           left join TbCompany cp2 on cp2.CompanyCode=sup.WorkAreaCode
                           left join TbCompany cp3 on cp3.CompanyCode=sup.SiteCode
                           left join TbCompany cp4 on cp4.CompanyCode=sup.ProcessFactoryCode
                           where YEAR(sup.SupplyDate)= @Year and MONTH(sup.SupplyDate)= @Month
                           and (sup.SupplyCompleteTime>sup.SupplyDate or (GETDATE()>sup.SupplyDate and sup.SupplyCompleteTime is null))  and sup.ProcessFactoryCode='6386683729561128960'	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:18:43
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE ((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode319) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus320)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode319[String] = 6386683729561128960
@Examinestatus320[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:18:43
Text:	 SELECT   * FROM [TbRawMaterialMonthDemandSupplyPlan]  WHERE [TbRawMaterialMonthDemandSupplyPlan].[DemandPlanCode] IN (@DemandPlanCode321,@DemandPlanCode322,@DemandPlanCode323,@DemandPlanCode324,@DemandPlanCode325,@DemandPlanCode326,@DemandPlanCode327,@DemandPlanCode328,@DemandPlanCode329) 	
Parameters:
@DemandPlanCode321[String] = XQJH202000002
@DemandPlanCode322[String] = XQJH202000003
@DemandPlanCode323[String] = XQJH202000004
@DemandPlanCode324[String] = XQJH202000005
@DemandPlanCode325[String] = XQJH202000006
@DemandPlanCode326[String] = XQJH202000007
@DemandPlanCode327[String] = XQJH202000008
@DemandPlanCode328[String] = XQJH202000009
@DemandPlanCode329[String] = XQJH202000010


-----------------------------------------------------------------------------
2020-03-27 18:18:43
Text:	 SELECT   [TbFactoryBatchNeedPlan].[RawMaterialDemandNum] AS [DemandPlanCode],[TbFactoryBatchNeedPlan].[BatchPlanNum],[TbFactoryBatchNeedPlan].[SteelsTypeCode] AS [RebarType],[TbFactoryBatchNeedPlan].[BatchPlanTotal] AS [TotalWeight] FROM [TbFactoryBatchNeedPlan]  WHERE (([TbFactoryBatchNeedPlan].[Examinestatus] = @Examinestatus330) AND ([TbFactoryBatchNeedPlan].[RawMaterialDemandNum] IN (@RawMaterialDemandNum331,@RawMaterialDemandNum332,@RawMaterialDemandNum333,@RawMaterialDemandNum334,@RawMaterialDemandNum335,@RawMaterialDemandNum336,@RawMaterialDemandNum337,@RawMaterialDemandNum338,@RawMaterialDemandNum339,@RawMaterialDemandNum340,@RawMaterialDemandNum341,@RawMaterialDemandNum342,@RawMaterialDemandNum343,@RawMaterialDemandNum344,@RawMaterialDemandNum345,@RawMaterialDemandNum346,@RawMaterialDemandNum347))) 	
Parameters:
@Examinestatus330[String] = 审核完成
@RawMaterialDemandNum331[String] = XQJH202000002
@RawMaterialDemandNum332[String] = XQJH202000003
@RawMaterialDemandNum333[String] = XQJH202000004
@RawMaterialDemandNum334[String] = XQJH202000005
@RawMaterialDemandNum335[String] = XQJH202000006
@RawMaterialDemandNum336[String] = XQJH202000007
@RawMaterialDemandNum337[String] = XQJH202000008
@RawMaterialDemandNum338[String] = XQJH202000009
@RawMaterialDemandNum339[String] = XQJH202000010
@RawMaterialDemandNum340[String] = BCJH202000002
@RawMaterialDemandNum341[String] = BCJH202000003
@RawMaterialDemandNum342[String] = BCJH202000004
@RawMaterialDemandNum343[String] = BCJH202000005
@RawMaterialDemandNum344[String] = BCJH202000006
@RawMaterialDemandNum345[String] = BCJH202000007
@RawMaterialDemandNum346[String] = BCJH202000009
@RawMaterialDemandNum347[String] = BCJH202000008


-----------------------------------------------------------------------------
2020-03-27 18:18:43
Text:	 SELECT   [TbSupplyList].[SteelsTypeCode] AS [RebarType],[TbSupplyList].[HasSupplierTotal] AS [TotalWeight] FROM [TbSupplyList]  WHERE (([TbSupplyList].[StateCode] <> @StateCode318) AND ([TbSupplyList].[BatchPlanNum] IN (@BatchPlanNum348,@BatchPlanNum349,@BatchPlanNum350,@BatchPlanNum351,@BatchPlanNum352,@BatchPlanNum353))) 	
Parameters:
@StateCode318[String] = 未供货
@BatchPlanNum348[String] = PCJH202000002
@BatchPlanNum349[String] = PCJH202000003
@BatchPlanNum350[String] = PCJH202000004
@BatchPlanNum351[String] = PCJH202000005
@BatchPlanNum352[String] = PCJH202000006
@BatchPlanNum353[String] = PCJH202000007


-----------------------------------------------------------------------------
2020-03-27 18:18:43
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE (([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode354) AND ([TbRawMaterialArchives].[RebarType] = @RebarType355)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode354[String] = 6386683729561128960
@RebarType355[String] = BuildingSteel


-----------------------------------------------------------------------------
2020-03-27 18:18:43
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE (([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode356) AND ([TbRawMaterialArchives].[RebarType] = @RebarType357)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode356[String] = 6386683729561128960
@RebarType357[String] = SectionSteel


-----------------------------------------------------------------------------
2020-03-27 18:18:43
Text:	--加工进度滞后
                           select op.OrderCode,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as ProcessFactoryName,op.DistributionTime,op.FinishProcessingDateTime from TbOrderProgress op 
                           left join TbCompany cp1 on op.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on op.ProcessFactoryCode=cp2.CompanyCode
                           where YEAR(op.DistributionTime)= @Year and MONTH(op.DistributionTime)= @Month
                           and (op.FinishProcessingDateTime>op.DistributionTime or (GETDATE()>op.DistributionTime and op.FinishProcessingDateTime is null))  and op.ProcessFactoryCode='6386683729561128960' ORDER BY op.DistributionTime desc	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:18:44
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE ((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode362) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus363)) 	
Parameters:
@ProcessFactoryCode362[String] = 6386683729561128960
@Examinestatus363[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:18:44
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode364,@OrderCode365,@OrderCode366,@OrderCode367,@OrderCode368,@OrderCode369,@OrderCode370,@OrderCode371)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode364[String] = JGDD202000001
@OrderCode365[String] = JGDD202000002
@OrderCode366[String] = JGDD202000003
@OrderCode367[String] = JGDD202000004
@OrderCode368[String] = JGDD202000005
@OrderCode369[String] = JGDD202000006
@OrderCode370[String] = JGDD202000008
@OrderCode371[String] = JGDD202000009


-----------------------------------------------------------------------------
2020-03-27 18:18:44
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE (((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode358)) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState359,@ProcessingState360,@ProcessingState361))) 	
Parameters:
@ProcessFactoryCode358[String] = 6386683729561128960
@ProcessingState359[String] = Processing
@ProcessingState360[String] = Received
@ProcessingState361[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 18:18:44
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat372) 	
Parameters:
@DaetailWorkStrat372[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 18:18:44
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[OrderCode] IN (@OrderCode373,@OrderCode374,@OrderCode375,@OrderCode376,@OrderCode377,@OrderCode378,@OrderCode379,@OrderCode380,@OrderCode381,@OrderCode382,@OrderCode383)) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime384)))) 	
Parameters:
@OrderCode373[String] = JGDD202000001
@OrderCode374[String] = JGDD202000002
@OrderCode375[String] = JGDD202000003
@OrderCode376[String] = JGDD202000004
@OrderCode377[String] = JGDD202000005
@OrderCode378[String] = JGDD202000006
@OrderCode379[String] = JGDD202000008
@OrderCode380[String] = JGDD202000003
@OrderCode381[String] = JGDD202000004
@OrderCode382[String] = JGDD202000004
@OrderCode383[String] = JGDD202000004
@DistributionTime384[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 18:18:44
Text:	 SELECT count(*) as r_cnt FROM [TbDistributionPlanInfo] WHERE (([TbDistributionPlanInfo].[OrderCode] IN (@OrderCode385,@OrderCode386,@OrderCode387,@OrderCode388,@OrderCode389,@OrderCode390,@OrderCode391)) AND ((DistributionStart='配送完成' and DATEPART(day,DeliveryCompleteTime)>DATEPART(day,DistributionTime)) or (DistributionStart='未配送' and DistributionTime>GETDATE())))	
Parameters:
@OrderCode385[String] = JGDD202000001
@OrderCode386[String] = JGDD202000002
@OrderCode387[String] = JGDD202000003
@OrderCode388[String] = JGDD202000004
@OrderCode389[String] = JGDD202000005
@OrderCode390[String] = JGDD202000006
@OrderCode391[String] = JGDD202000008


-----------------------------------------------------------------------------
2020-03-27 18:18:44
Text:	SELECT sm.MenuName,fwqi.EWContent,fwqi.EWUserCode,u.UserName,fwqi.EWFormDataCode,cp1.CompanyFullName as  FbName,cp2.CompanyFullName as GqName,fwqi.EWTime,sdd.DictionaryText as RebarType  
                   FROM (  
                    select ret.*
                    FROM ( 
                         SELECT *, row_number()over(partition BY EarlyWarningCode,EWFormDataCode ORDER BY EWNodeCode,EWTime desc) as group_idx 
                         FROM TbFormEarlyWarningNodeInfo fwqi
                         WHERE YEAR(fwqi.EWTime)= @Year and MONTH(fwqi.EWTime)= @Month AND fwqi.MenuCode='RawMonthDemandPlan' AND fwqi.EWStart=0
                    ) ret
                    WHERE ret.group_idx = 1
                   ) fwqi
                    left join TbSysMenu sm on fwqi.MenuCode=sm.MenuCode
                            left join TbCompany cp1 on fwqi.CompanyCode=cp1.CompanyCode
                            left join TbCompany cp2 on fwqi.WorkArea=cp2.CompanyCode
                            left join TbCompany cp3 on fwqi.SiteCode=cp3.CompanyCode
                            left join TbUser u on fwqi.EWUserCode=u.UserId
                            left join TbRawMaterialMonthDemandPlan rmp on fwqi.EWFormDataCode=rmp.ID
                            left join TbSysDictionaryData sdd on sdd.DictionaryCode=rmp.RebarType
                    where 1=1 ORDER BY fwqi.EWTime DESC	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:18:44
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE ((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode392) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus393)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode392[String] = 6386683729561128960
@Examinestatus393[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:18:44
Text:	 SELECT   * FROM [TbRawMaterialMonthDemandSupplyPlan]  WHERE [TbRawMaterialMonthDemandSupplyPlan].[DemandPlanCode] IN (@DemandPlanCode394,@DemandPlanCode395,@DemandPlanCode396,@DemandPlanCode397,@DemandPlanCode398,@DemandPlanCode399,@DemandPlanCode400,@DemandPlanCode401,@DemandPlanCode402) 	
Parameters:
@DemandPlanCode394[String] = XQJH202000002
@DemandPlanCode395[String] = XQJH202000003
@DemandPlanCode396[String] = XQJH202000004
@DemandPlanCode397[String] = XQJH202000005
@DemandPlanCode398[String] = XQJH202000006
@DemandPlanCode399[String] = XQJH202000007
@DemandPlanCode400[String] = XQJH202000008
@DemandPlanCode401[String] = XQJH202000009
@DemandPlanCode402[String] = XQJH202000010


-----------------------------------------------------------------------------
2020-03-27 18:18:44
Text:	 SELECT   [TbFactoryBatchNeedPlan].[RawMaterialDemandNum] AS [DemandPlanCode],[TbFactoryBatchNeedPlan].[BatchPlanNum],[TbFactoryBatchNeedPlan].[SteelsTypeCode] AS [RebarType],[TbFactoryBatchNeedPlan].[BatchPlanTotal] AS [TotalWeight] FROM [TbFactoryBatchNeedPlan]  WHERE (([TbFactoryBatchNeedPlan].[Examinestatus] = @Examinestatus403) AND ([TbFactoryBatchNeedPlan].[RawMaterialDemandNum] IN (@RawMaterialDemandNum404,@RawMaterialDemandNum405,@RawMaterialDemandNum406,@RawMaterialDemandNum407,@RawMaterialDemandNum408,@RawMaterialDemandNum409,@RawMaterialDemandNum410,@RawMaterialDemandNum411,@RawMaterialDemandNum412))) 	
Parameters:
@Examinestatus403[String] = 审核完成
@RawMaterialDemandNum404[String] = XQJH202000002
@RawMaterialDemandNum405[String] = XQJH202000003
@RawMaterialDemandNum406[String] = XQJH202000004
@RawMaterialDemandNum407[String] = XQJH202000005
@RawMaterialDemandNum408[String] = XQJH202000006
@RawMaterialDemandNum409[String] = XQJH202000007
@RawMaterialDemandNum410[String] = XQJH202000008
@RawMaterialDemandNum411[String] = XQJH202000009
@RawMaterialDemandNum412[String] = XQJH202000010


-----------------------------------------------------------------------------
2020-03-27 18:18:44
Text:	select * from (select cp2.CompanyCode,cp2.CompanyFullName from (select SiteCode from TbWorkOrder where 
            (CONVERT(varchar(7) ,InsertTime, 120)='2020-02' or CONVERT(varchar(7) ,InsertTime, 120)='2020-01' or CONVERT(varchar(7) ,InsertTime, 120)='2020-03') and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId) and (ISNULL(@ProcessFactoryCode,'')='' or ProcessFactoryCode=@ProcessFactoryCode)
            group by SiteCode) TbWO
            left join TbCompany cp on TBWO.SiteCode=cp.CompanyCode
            left join TbCompany cp2 on cp2.CompanyCode=cp.ParentCompanyCode
            group by cp2.CompanyCode,cp2.CompanyFullName
            union all
            select rmdp.WorkAreaCode,cp.CompanyFullName
            from TbRawMaterialMonthDemandPlan rmdp
            left join TbCompany cp on cp.CompanyCode=rmdp.WorkAreaCode
            where (rmdp.DemandMonth='2020-02' or rmdp.DemandMonth='2020-01' or rmdp.DemandMonth='2020-03') and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId) and (ISNULL(@ProcessFactoryCode,'')='' or ProcessFactoryCode=@ProcessFactoryCode)) TbGq group by TbGq.CompanyCode,TbGq.CompanyFullName	
Parameters:
@ProjectId[String] = 
@ProcessFactoryCode[String] = 6386683729561128960


-----------------------------------------------------------------------------
2020-03-27 18:18:45
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE ((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode413) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus414)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode413[String] = 6386683729561128960
@Examinestatus414[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:18:45
Text:	 SELECT   * FROM [TbRawMaterialMonthDemandSupplyPlan]  WHERE [TbRawMaterialMonthDemandSupplyPlan].[DemandPlanCode] IN (@DemandPlanCode415,@DemandPlanCode416,@DemandPlanCode417,@DemandPlanCode418,@DemandPlanCode419,@DemandPlanCode420,@DemandPlanCode421,@DemandPlanCode422,@DemandPlanCode423) 	
Parameters:
@DemandPlanCode415[String] = XQJH202000002
@DemandPlanCode416[String] = XQJH202000003
@DemandPlanCode417[String] = XQJH202000004
@DemandPlanCode418[String] = XQJH202000005
@DemandPlanCode419[String] = XQJH202000006
@DemandPlanCode420[String] = XQJH202000007
@DemandPlanCode421[String] = XQJH202000008
@DemandPlanCode422[String] = XQJH202000009
@DemandPlanCode423[String] = XQJH202000010


-----------------------------------------------------------------------------
2020-03-27 18:18:45
Text:	 SELECT   [TbSupplyList].[BatchPlanTotal],[TbSupplyList].[HasSupplierTotal],[TbSupplyList].[StateCode],[TbSupplyList].[SteelsTypeCode],[TbSupplyList].[SupplyCompleteTime],[TbSupplyList].[SupplyDate] FROM [TbSupplyList]  WHERE ([TbSupplyList].[RawMaterialDemandNum] IN (@RawMaterialDemandNum424,@RawMaterialDemandNum425,@RawMaterialDemandNum426,@RawMaterialDemandNum427,@RawMaterialDemandNum428,@RawMaterialDemandNum429,@RawMaterialDemandNum430,@RawMaterialDemandNum431,@RawMaterialDemandNum432,@RawMaterialDemandNum433,@RawMaterialDemandNum434,@RawMaterialDemandNum435,@RawMaterialDemandNum436,@RawMaterialDemandNum437,@RawMaterialDemandNum438,@RawMaterialDemandNum439,@RawMaterialDemandNum440)) 	
Parameters:
@RawMaterialDemandNum424[String] = XQJH202000002
@RawMaterialDemandNum425[String] = XQJH202000003
@RawMaterialDemandNum426[String] = XQJH202000004
@RawMaterialDemandNum427[String] = XQJH202000005
@RawMaterialDemandNum428[String] = XQJH202000006
@RawMaterialDemandNum429[String] = XQJH202000007
@RawMaterialDemandNum430[String] = XQJH202000008
@RawMaterialDemandNum431[String] = XQJH202000009
@RawMaterialDemandNum432[String] = XQJH202000010
@RawMaterialDemandNum433[String] = BCJH202000002
@RawMaterialDemandNum434[String] = BCJH202000003
@RawMaterialDemandNum435[String] = BCJH202000004
@RawMaterialDemandNum436[String] = BCJH202000005
@RawMaterialDemandNum437[String] = BCJH202000006
@RawMaterialDemandNum438[String] = BCJH202000007
@RawMaterialDemandNum439[String] = BCJH202000009
@RawMaterialDemandNum440[String] = BCJH202000008


-----------------------------------------------------------------------------
2020-03-27 18:19:05
Text:	select TbAll.EarlyWarningCode,TbAll.BranchCode,TbAll.BranchName,TbAll.WorkAreaCode,TbAll.WorkAreaName,TbAll.SiteCode,TbAll.SiteName,TbAll.ProjectId,TbAll.YjMonth,TbAll.MenuCode,TbAll.EWNodeCode,TbAll.EWNodeName,TbAll.PersonnelCode,TbAll.PersonnelSource,TbAll.BegEwTiemNew from (select Tb.*,case when Tb.EWTimeType='年' then DATEADD(YEAR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='月' then DATEADD(MONTH,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='天' then DATEADD(DAY,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='时' then DATEADD(HOUR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='分' then DATEADD(MINUTE,Tb.EWTime,Tb.BegEwTiem) end as BegEwTiemNew,TbYjInfo.EarlyWarningCode as YjCode from (select ewt.EarlyWarningCode,DATENAME(year,GETDATE())+'-'+ DATENAME(MONTH,GETDATE())+'-'+ CONVERT(varchar(20),ewt.EWBegDay)+' '+CONVERT(varchar(20),ewt.EWBegHour)+':'+CONVERT(varchar(20),ewt.EWBegMinute)+':00' as BegEwTiem,ewt.BranchCode,cp1.CompanyFullName as BranchName,ewt.WorkAreaCode,cp2.CompanyFullName as WorkAreaName,ewt.SiteCode,cp3.CompanyFullName as SiteName,ewt.ProjectId,MONTH(GETDATE()) as YjMonth,ewt.MenuCode,ewn.EWNodeCode,ewn.EWNodeName,ewn.EWTimeType,ewn.EWTime,ewnp.PersonnelCode,ewnp.PersonnelSource,ewnp.DeptId,ewnp.RoleId from TbFormEarlyWarningBegTime ewt 
left join TbFormEarlyWarningNode ewn on ewt.EarlyWarningCode=ewn.EarlyWarningCode and ewt.ProjectId=ewn.ProjectId and ewt.MenuCode=ewn.MenuCode
left join TbFormEarlyWarningNodePersonnel ewnp on ewn.EarlyWarningCode=ewnp.EarlyWarningCode and ewn.EWNodeCode=ewnp.EWNodeCode and  ewn.MenuCode=ewnp.MenuCode and ewn.ProjectId=ewnp.ProjectId
left join TbCompany cp1 on ewt.BranchCode=cp1.CompanyCode
left join TbCompany cp2 on ewt.WorkAreaCode=cp2.CompanyCode
left join TbCompany cp3 on ewt.SiteCode=cp3.CompanyCode
where ewt.MenuCode='RawMonthDemandPlan') Tb 
left join (select EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId from TbFormEarlyWarningNodeInfo ewni
where ewni.EWFormDataCode=MONTH(GETDATE()) group by EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId) TbYjInfo on Tb.EarlyWarningCode=TbYjInfo.EarlyWarningCode and Tb.EWNodeCode=TbYjInfo.EWNodeCode and Tb.MenuCode=TbYjInfo.MenuCode and  Tb.YjMonth=TbYjInfo.EWFormDataCode and Tb.WorkAreaCode=TbYjInfo.WorkArea and Tb.ProjectId=TbYjInfo.ProjectId
where GETDATE()>=BegEwTiem and Tb.WorkAreaCode not in(select rmdp.WorkAreaCode from TbRawMaterialMonthDemandPlan rmdp where MONTH(InsertTime)=MONTH(GETDATE())
group by rmdp.WorkAreaCode)) TbAll where TbAll.YjCode is null and TbAll.PersonnelCode is not null and GETDATE()>=TbAll.BegEwTiemNew	


-----------------------------------------------------------------------------
2020-03-27 18:21:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
left join TbFlowDefine d on p.FlowCode=d.FlowCode
where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
union all
select COUNT(1) as MsgCount from TbFlowPerformMessage m 
LEFT JOIN TbUser tu ON m.UserCode=tu.UserCode
where (m.usercode=@UserCode OR tu.UserId=@UserCode)and IsRead=-1
union all
select SUM(Tb.earlywarningcount) as earlywarningcount from (
select COUNT(1) as earlywarningcount from TbFlowEarlyWarningInfo where EarlyWarningBTUser=@UserCode and EarlyWarningStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)
union all
select COUNT(1) as earlywarningcount from TbFormEarlyWarningNodeInfo where EWUserCode=@UserCode and EWStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6387064461265608704
@ProjectId[String] = 


-----------------------------------------------------------------------------
2020-03-27 18:24:06
Text:	select TbAll.EarlyWarningCode,TbAll.BranchCode,TbAll.BranchName,TbAll.WorkAreaCode,TbAll.WorkAreaName,TbAll.SiteCode,TbAll.SiteName,TbAll.ProjectId,TbAll.YjMonth,TbAll.MenuCode,TbAll.EWNodeCode,TbAll.EWNodeName,TbAll.PersonnelCode,TbAll.PersonnelSource,TbAll.BegEwTiemNew from (select Tb.*,case when Tb.EWTimeType='年' then DATEADD(YEAR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='月' then DATEADD(MONTH,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='天' then DATEADD(DAY,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='时' then DATEADD(HOUR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='分' then DATEADD(MINUTE,Tb.EWTime,Tb.BegEwTiem) end as BegEwTiemNew,TbYjInfo.EarlyWarningCode as YjCode from (select ewt.EarlyWarningCode,DATENAME(year,GETDATE())+'-'+ DATENAME(MONTH,GETDATE())+'-'+ CONVERT(varchar(20),ewt.EWBegDay)+' '+CONVERT(varchar(20),ewt.EWBegHour)+':'+CONVERT(varchar(20),ewt.EWBegMinute)+':00' as BegEwTiem,ewt.BranchCode,cp1.CompanyFullName as BranchName,ewt.WorkAreaCode,cp2.CompanyFullName as WorkAreaName,ewt.SiteCode,cp3.CompanyFullName as SiteName,ewt.ProjectId,MONTH(GETDATE()) as YjMonth,ewt.MenuCode,ewn.EWNodeCode,ewn.EWNodeName,ewn.EWTimeType,ewn.EWTime,ewnp.PersonnelCode,ewnp.PersonnelSource,ewnp.DeptId,ewnp.RoleId from TbFormEarlyWarningBegTime ewt 
left join TbFormEarlyWarningNode ewn on ewt.EarlyWarningCode=ewn.EarlyWarningCode and ewt.ProjectId=ewn.ProjectId and ewt.MenuCode=ewn.MenuCode
left join TbFormEarlyWarningNodePersonnel ewnp on ewn.EarlyWarningCode=ewnp.EarlyWarningCode and ewn.EWNodeCode=ewnp.EWNodeCode and  ewn.MenuCode=ewnp.MenuCode and ewn.ProjectId=ewnp.ProjectId
left join TbCompany cp1 on ewt.BranchCode=cp1.CompanyCode
left join TbCompany cp2 on ewt.WorkAreaCode=cp2.CompanyCode
left join TbCompany cp3 on ewt.SiteCode=cp3.CompanyCode
where ewt.MenuCode='RawMonthDemandPlan') Tb 
left join (select EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId from TbFormEarlyWarningNodeInfo ewni
where ewni.EWFormDataCode=MONTH(GETDATE()) group by EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId) TbYjInfo on Tb.EarlyWarningCode=TbYjInfo.EarlyWarningCode and Tb.EWNodeCode=TbYjInfo.EWNodeCode and Tb.MenuCode=TbYjInfo.MenuCode and  Tb.YjMonth=TbYjInfo.EWFormDataCode and Tb.WorkAreaCode=TbYjInfo.WorkArea and Tb.ProjectId=TbYjInfo.ProjectId
where GETDATE()>=BegEwTiem and Tb.WorkAreaCode not in(select rmdp.WorkAreaCode from TbRawMaterialMonthDemandPlan rmdp where MONTH(InsertTime)=MONTH(GETDATE())
group by rmdp.WorkAreaCode)) TbAll where TbAll.YjCode is null and TbAll.PersonnelCode is not null and GETDATE()>=TbAll.BegEwTiemNew	


-----------------------------------------------------------------------------
2020-03-27 18:24:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
left join TbFlowDefine d on p.FlowCode=d.FlowCode
where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
union all
select COUNT(1) as MsgCount from TbFlowPerformMessage m 
LEFT JOIN TbUser tu ON m.UserCode=tu.UserCode
where (m.usercode=@UserCode OR tu.UserId=@UserCode)and IsRead=-1
union all
select SUM(Tb.earlywarningcount) as earlywarningcount from (
select COUNT(1) as earlywarningcount from TbFlowEarlyWarningInfo where EarlyWarningBTUser=@UserCode and EarlyWarningStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)
union all
select COUNT(1) as earlywarningcount from TbFormEarlyWarningNodeInfo where EWUserCode=@UserCode and EWStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6387064461265608704
@ProjectId[String] = 


-----------------------------------------------------------------------------
2020-03-27 18:27:35
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6386685071075708928','6475435760374910976') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-03-27 18:27:35
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6387064461265608704


-----------------------------------------------------------------------------
2020-03-27 18:27:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
left join TbFlowDefine d on p.FlowCode=d.FlowCode
where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
union all
select COUNT(1) as MsgCount from TbFlowPerformMessage m 
LEFT JOIN TbUser tu ON m.UserCode=tu.UserCode
where (m.usercode=@UserCode OR tu.UserId=@UserCode)and IsRead=-1
union all
select SUM(Tb.earlywarningcount) as earlywarningcount from (
select COUNT(1) as earlywarningcount from TbFlowEarlyWarningInfo where EarlyWarningBTUser=@UserCode and EarlyWarningStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)
union all
select COUNT(1) as earlywarningcount from TbFormEarlyWarningNodeInfo where EWUserCode=@UserCode and EWStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6387064461265608704
@ProjectId[String] = 


-----------------------------------------------------------------------------
2020-03-27 18:27:35
Text:	SELECT MaterialName FROM TbRawMaterialArchives
                                GROUP BY MaterialName	


-----------------------------------------------------------------------------
2020-03-27 18:27:35
Text:	SELECT MaterialName FROM TbRawMaterialArchives
                                GROUP BY MaterialName	


-----------------------------------------------------------------------------
2020-03-27 18:27:36
Text:	select isnull(sum(TbCF.Capacity),0) as Capacity,isnull(sum(TbCF.WeightSmallPlan),0) as WeightSmallPlan,isnull(cast(sum(TbCF.WeightSmallPlan)/sum(TbCF.Capacity)*100 as decimal(18,2)),0) as ActualLoadNew from (select cf.Capacity,Tb1.WeightSmallPlan,cf.ProcessFactoryCode from TbCapacityFilling cf  
left join(
select SUM(Tb.WeightSmallPlan) as WeightSmallPlan,Tb.ProcessFactoryCode from (
                            select isnull(SUM(wod.WeightSmallPlan),0) as WeightSmallPlan,wo.ProcessFactoryCode from TbWorkOrder wo
                            left join TbWorkOrderDetail wod on wo.OrderCode=wod.OrderCode
                            where (ISNULL(@ProcessFactoryCode,'')='' or wo.ProcessFactoryCode=@ProcessFactoryCode)
                            and CONVERT(varchar(7), wo.DistributionTime, 120)=@month
                            and wod.RevokeStart='正常' and wo.ProcessingState!='ConfirmWork' and wo.ProcessingState!='Finishing'  group by wo.ProcessFactoryCode
                            union all
                            select isnull(sum(opd.NoCompleted),0) as NoCompleted,op.ProcessFactoryCode from TbOrderProgress op
                            left join TbOrderProgressDetail opd on op.OrderCode=opd.OrderCode 
                            where (ISNULL(@ProcessFactoryCode,'')='' or op.ProcessFactoryCode=@ProcessFactoryCode)
                            and CONVERT(varchar(7), op.DistributionTime, 120)=CONVERT(varchar(4),YEAR(DATEADD(MONTH,-1,@month+'-01')))+'-'+Right(100+Month(DATEADD(MONTH,-1,@month+'-01')),2)
                            and opd.RevokeStart='正常'  group by op.ProcessFactoryCode)Tb  group by Tb.ProcessFactoryCode
) Tb1 on cf.ProcessFactoryCode=Tb1.ProcessFactoryCode 
where cf.CapacityMonth=@month
and (ISNULL(@ProcessFactoryCode,'')='' or cf.ProcessFactoryCode=@ProcessFactoryCode)) TbCF where (ISNULL(@ProcessFactoryCode,'')='' or TbCF.ProcessFactoryCode=@ProcessFactoryCode)	
Parameters:
@ProcessFactoryCode[String] = 6386683729561128960
@month[String] = 2020-03


-----------------------------------------------------------------------------
2020-03-27 18:27:36
Text:	
                        select fewoi.DataCode as OddNumbers,
                         fewoi.EarlyWarningContent,
                         fewoi.EWFormDataCode,
                         CONVERT(varchar(100), fewoi.EarlyWarningTime, 120) as EarlyWarningTime,
                         EWFormCode,sm.MenuName,fn.FlowNodeName,cp1.CompanyFullName as BranchName,
                         cp2.CompanyFullName as WorkAreaName,cp3.CompanyFullName as SiteName,cp4.CompanyFullName as ProcessFactoryName,
                         u1.UserName as FlowSpUserName,u2.UserName as FlowYjUserName 
                        FROM (
                        select*
                           FROM ( 
                        		SELECT a.*, row_number()over(partition BY a.FlowCode ORDER BY a.FlowNodeCode,a.EarlyWarningTime desc) as group_idx 
                        		FROM TbFlowEarlyWarningOtherInfo  a
                        		INNER JOIN  TbFlowEarlyWarningInfo b ON a.FlowCode=b.FlowCode 
                        		AND a.EWFormDataCode=b.EWFormDataCode AND a.FlowNodeCode=b.FlowNodeCode 
                        		WHERE YEAR(a.EarlyWarningTime)= @Year and MONTH(a.EarlyWarningTime)= @Month AND b.EarlyWarningStart=0
                           ) ret
                        WHERE ret.group_idx =1
                        ) fewoi
                        left join TbFlowNode fn on fewoi.FlowCode=fn.FlowCode and fewoi.FlowNodeCode=fn.FlowNodeCode
                        left join TbSysMenu sm on fewoi.EWFormCode=sm.MenuCode
                        left join TbCompany cp1 on fewoi.BranchCode=cp1.CompanyCode
                        left join TbCompany cp2 on fewoi.WorkAreaCode=cp2.CompanyCode
                        left join TbCompany cp3 on fewoi.SiteCode=cp3.CompanyCode
                        left join TbCompany cp4 on fewoi.ProcessFactoryCode=cp4.CompanyCode
                        left join TbUser u1 on fewoi.FlowSpUserCode=u1.UserId
                        left join TbUser u2 on fewoi.FlowYjUserCode=u2.UserId where 1=1 and fewoi.ProcessFactoryCode='6386683729561128960' ORDER BY fewoi.EarlyWarningTime desc	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:27:36
Text:	--原材料供货超时
                           select BatchPlanNum,cp1.CompanyFullName as BranchName,cp2.CompanyFullName as WorkAreaName,cp3.CompanyFullName as SiteName,cp4.CompanyFullName as ProcessFactoryName,sup.SupplyDate,sup.SupplyCompleteTime,sup.ProjectId,sup.Remarks from TbSupplyList sup
                           left join TbCompany cp1 on cp1.CompanyCode=sup.BranchCode
                           left join TbCompany cp2 on cp2.CompanyCode=sup.WorkAreaCode
                           left join TbCompany cp3 on cp3.CompanyCode=sup.SiteCode
                           left join TbCompany cp4 on cp4.CompanyCode=sup.ProcessFactoryCode
                           where YEAR(sup.SupplyDate)= @Year and MONTH(sup.SupplyDate)= @Month
                           and (sup.SupplyCompleteTime>sup.SupplyDate or (GETDATE()>sup.SupplyDate and sup.SupplyCompleteTime is null))  and sup.ProcessFactoryCode='6386683729561128960'	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:27:36
Text:	--加工进度滞后
                           select op.OrderCode,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as ProcessFactoryName,op.DistributionTime,op.FinishProcessingDateTime from TbOrderProgress op 
                           left join TbCompany cp1 on op.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on op.ProcessFactoryCode=cp2.CompanyCode
                           where YEAR(op.DistributionTime)= @Year and MONTH(op.DistributionTime)= @Month
                           and (op.FinishProcessingDateTime>op.DistributionTime or (GETDATE()>op.DistributionTime and op.FinishProcessingDateTime is null))  and op.ProcessFactoryCode='6386683729561128960' ORDER BY op.DistributionTime desc	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:27:36
Text:	--配送超期
                           select dpi.OrderCode,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as ProcessFactoryName,dpi.DistributionTime,dpi.DeliveryCompleteTime,dpi.Remark from TbDistributionPlanInfo dpi
                           left join TbCompany cp1 on dpi.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on dpi.ProcessFactoryCode=cp2.CompanyCode
                           where YEAR(dpi.DistributionTime)= @Year and MONTH(dpi.DistributionTime)= @Month
                           and (dpi.DeliveryCompleteTime>dpi.DistributionTime or (GETDATE()>dpi.DistributionTime and dpi.DeliveryCompleteTime is null))  and dpi.ProcessFactoryCode='6386683729561128960' ORDER BY dpi.DistributionTime desc	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:27:36
Text:	select TbYj.*,cp1.CompanyFullName as SiteName,sfs.DistributionCode,sdc.DistributionTime,sfs.SigninTime,sfs.ProcessFactoryCode,cp.CompanyFullName as ProcessFactoryName from (select min(EwTime) as EwTime,MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId from TbFormEarlyWarningNodeInfo where  MenuCode='SemiFinishedSign' 
						   group by MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId) TbYj
						   left join TbSemiFinishedSign sfs on TbYj.EWFormDataCode=sfs.ID
                           left join TbSiteDischargeCargo sdc on sfs.DistributionCode=sdc.DistributionCode and sfs.DischargeCargoCode=sdc.DischargeCargoCode
                           left join TbCompany cp on sfs.ProcessFactoryCode=cp.CompanyCode
                           left join TbCompany cp1 on TbYj.SiteCode=cp1.CompanyCode
						   where YEAR(TbYj.EWTime)= @Year and MONTH(TbYj.EWTime)= @Month and sfs.ProcessFactoryCode='6386683729561128960'	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:27:36
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE ((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode445) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus446)) 	
Parameters:
@ProcessFactoryCode445[String] = 6386683729561128960
@Examinestatus446[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:27:36
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode447,@OrderCode448,@OrderCode449,@OrderCode450,@OrderCode451,@OrderCode452,@OrderCode453,@OrderCode454)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode447[String] = JGDD202000001
@OrderCode448[String] = JGDD202000002
@OrderCode449[String] = JGDD202000003
@OrderCode450[String] = JGDD202000004
@OrderCode451[String] = JGDD202000005
@OrderCode452[String] = JGDD202000006
@OrderCode453[String] = JGDD202000008
@OrderCode454[String] = JGDD202000009


-----------------------------------------------------------------------------
2020-03-27 18:27:36
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE (((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode441)) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState442,@ProcessingState443,@ProcessingState444))) 	
Parameters:
@ProcessFactoryCode441[String] = 6386683729561128960
@ProcessingState442[String] = Processing
@ProcessingState443[String] = Received
@ProcessingState444[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 18:27:36
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat455) 	
Parameters:
@DaetailWorkStrat455[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 18:27:36
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[OrderCode] IN (@OrderCode456,@OrderCode457,@OrderCode458,@OrderCode459,@OrderCode460,@OrderCode461,@OrderCode462,@OrderCode463,@OrderCode464,@OrderCode465,@OrderCode466)) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime467)))) 	
Parameters:
@OrderCode456[String] = JGDD202000001
@OrderCode457[String] = JGDD202000002
@OrderCode458[String] = JGDD202000003
@OrderCode459[String] = JGDD202000004
@OrderCode460[String] = JGDD202000005
@OrderCode461[String] = JGDD202000006
@OrderCode462[String] = JGDD202000008
@OrderCode463[String] = JGDD202000003
@OrderCode464[String] = JGDD202000004
@OrderCode465[String] = JGDD202000004
@OrderCode466[String] = JGDD202000004
@DistributionTime467[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 18:27:36
Text:	 SELECT   [TbDistributionPlanInfo].[DistributionStart] FROM [TbDistributionPlanInfo]  WHERE ([TbDistributionPlanInfo].[OrderCode] IN (@OrderCode468,@OrderCode469,@OrderCode470,@OrderCode471,@OrderCode472,@OrderCode473,@OrderCode474)) 	
Parameters:
@OrderCode468[String] = JGDD202000001
@OrderCode469[String] = JGDD202000002
@OrderCode470[String] = JGDD202000003
@OrderCode471[String] = JGDD202000004
@OrderCode472[String] = JGDD202000005
@OrderCode473[String] = JGDD202000006
@OrderCode474[String] = JGDD202000008


-----------------------------------------------------------------------------
2020-03-27 18:27:36
Text:	 SELECT   [TbDistributionEntOrder].* FROM [TbDistributionEntOrder] LEFT OUTER JOIN [TbDistributionEnt] ON ([TbDistributionEntOrder].[DistributionCode] = [TbDistributionEnt].[DistributionCode])  WHERE ([TbDistributionEntOrder].[OrderCode] IN (@OrderCode475,@OrderCode476,@OrderCode477,@OrderCode478,@OrderCode479,@OrderCode480,@OrderCode481)) 	
Parameters:
@OrderCode475[String] = JGDD202000001
@OrderCode476[String] = JGDD202000002
@OrderCode477[String] = JGDD202000003
@OrderCode478[String] = JGDD202000004
@OrderCode479[String] = JGDD202000005
@OrderCode480[String] = JGDD202000006
@OrderCode481[String] = JGDD202000008


-----------------------------------------------------------------------------
2020-03-27 18:27:36
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE ((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode482) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus483)) 	
Parameters:
@ProcessFactoryCode482[String] = 6386683729561128960
@Examinestatus483[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:27:36
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode484,@OrderCode485,@OrderCode486,@OrderCode487,@OrderCode488,@OrderCode489,@OrderCode490,@OrderCode491)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode484[String] = JGDD202000001
@OrderCode485[String] = JGDD202000002
@OrderCode486[String] = JGDD202000003
@OrderCode487[String] = JGDD202000004
@OrderCode488[String] = JGDD202000005
@OrderCode489[String] = JGDD202000006
@OrderCode490[String] = JGDD202000008
@OrderCode491[String] = JGDD202000009


-----------------------------------------------------------------------------
2020-03-27 18:27:36
Text:	SELECT 
                            '审批超时' as YjTypeName,COUNT(1) as YjNum
                            FROM (
									SELECT a.*, row_number()over(partition BY a.FlowCode ORDER BY a.FlowNodeCode,a.EarlyWarningTime desc) as group_idx 
									FROM TbFlowEarlyWarningOtherInfo  a
									INNER JOIN  TbFlowEarlyWarningInfo b ON a.FlowCode=b.FlowCode 
									AND a.EWFormDataCode=b.EWFormDataCode AND a.FlowNodeCode=b.FlowNodeCode 
									WHERE  b.EarlyWarningStart=0 AND YEAR(a.EarlyWarningTime)= @Year and MONTH(a.EarlyWarningTime)= @Month  and a.ProcessFactoryCode='6386683729561128960'
							   ) Tb1
                            WHERE Tb1.group_idx =1
                           union all
                            select '未报月度需求计划' as YjTypeName,COUNT(1)as YjNum
                             FROM ( 
                                  SELECT *, row_number()over(partition BY EarlyWarningCode,EWFormDataCode ORDER BY EWNodeCode,EWTime desc) as group_idx 
                                  FROM TbFormEarlyWarningNodeInfo fwqi
                                  WHERE fwqi.MenuCode='RawMonthDemandPlan' AND fwqi.EWStart=0 AND YEAR(fwqi.EWTime)= @Year and MONTH(fwqi.EWTime)= @Month   
                             ) Tb2
                             WHERE Tb2.group_idx =1
                           union all
                           select '原材料供货超时' as YjTypeName,COUNT(1) as YjNum from (
                           select BatchPlanNum,cp1.CompanyFullName as BranchName,cp2.CompanyFullName as WorkAreaName,cp3.CompanyFullName as SiteName,cp4.CompanyFullName as ProcessFactoryName,sup.SupplyDate,sup.SupplyCompleteTime,sup.ProjectId from TbSupplyList sup
                           left join TbCompany cp1 on cp1.CompanyCode=sup.BranchCode
                           left join TbCompany cp2 on cp2.CompanyCode=sup.WorkAreaCode
                           left join TbCompany cp3 on cp3.CompanyCode=sup.SiteCode
                           left join TbCompany cp4 on cp4.CompanyCode=sup.ProcessFactoryCode
                           where (sup.SupplyCompleteTime>sup.SupplyDate or (GETDATE()>sup.SupplyDate and sup.SupplyCompleteTime is null))
						   and YEAR(sup.SupplyDate)= @Year and MONTH(sup.SupplyDate)= @Month  and sup.ProcessFactoryCode='6386683729561128960') Tb3
                           union all
                           select '加急订单' as YjTypeName,COUNT(1) as YjNum from (--加急订单个数
                           select wo.OrderCode,wo.DistributionTime,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as ProcessFactoryName from TbWorkOrder wo
                           left join TbCompany cp1 on wo.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on wo.ProcessFactoryCode=cp2.CompanyCode
                           where UrgentDegree='Urgent' 
						   and YEAR(wo.DistributionTime)= @Year and MONTH(wo.DistributionTime)= @Month  and wo.ProcessFactoryCode='6386683729561128960') Tb4
                           union all
                           select '加工进度滞后' as YjTypeName,COUNT(1) as YjNum from (--加工进度滞后
                           select op.OrderCode,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as ProcessFactoryName,op.DistributionTime,op.FinishProcessingDateTime from TbOrderProgress op 
                           left join TbCompany cp1 on op.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on op.ProcessFactoryCode=cp2.CompanyCode
                           where YEAR(op.DistributionTime)= @Year and MONTH(op.DistributionTime)= @Month
                           and (op.FinishProcessingDateTime>op.DistributionTime or (GETDATE()>op.DistributionTime and op.FinishProcessingDateTime is null))  and op.ProcessFactoryCode='6386683729561128960') Tb5
                           union all
                           select '接收配送超期' as YjTypeName,COUNT(1) as YjNum from (--配送超期
                           select dpi.OrderCode,cp1.CompanyFullName as SIteName,cp2.CompanyFullName as ProcessFactoryName,dpi.DistributionTime,dpi.DeliveryCompleteTime from TbDistributionPlanInfo dpi
                           left join TbCompany cp1 on dpi.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on dpi.ProcessFactoryCode=cp2.CompanyCode
                           where YEAR(dpi.DistributionTime)= @Year and MONTH(dpi.DistributionTime)= @Month
                           and (dpi.DeliveryCompleteTime>dpi.DistributionTime or (GETDATE()>dpi.DistributionTime and dpi.DeliveryCompleteTime is null))  and dpi.ProcessFactoryCode='6386683729561128960') Tb6 
                           union all
                           select '卸货超时' as YjTypeName,COUNT(1) as YjNum from(--卸货超时
                           select TbYj.*,cp1.CompanyFullName as SiteName,tcr.EnterSpaceTime,tcr.StartDischargeTime,tcr.EndDischargeTime,disEnt.ProcessFactoryCode,cp.CompanyFullName as ProcessFactoryName from (select min(EwTime) as EwTime,MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId from TbFormEarlyWarningNodeInfo where  MenuCode='SiteDischargeCargo' 
						   group by MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId) TbYj
						   left join TbTransportCarReport tcr on TbYj.EWFormDataCode=tcr.DisEntOrderId
                           left join TbDistributionEnt disEnt on tcr.DistributionCode=disEnt.DistributionCode
                           left join TbCompany cp on disEnt.ProcessFactoryCode=cp.CompanyCode
                           left join TbCompany cp1 on TbYj.SiteCode=cp1.CompanyCode
						   where YEAR(TbYj.EWTime)= @Year and MONTH(TbYj.EWTime)= @Month  and disEnt.ProcessFactoryCode='6386683729561128960') Tb7
                           union all
                           select '签收超时' as YjTypeName,COUNT(1) as YjNum from (select TbYj.*,cp1.CompanyFullName as SiteName,sfs.DistributionCode,sdc.DistributionTime,sfs.SigninTime,sfs.ProcessFactoryCode,cp.CompanyFullName as ProcessFactoryName from (select min(EwTime) as EwTime,MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId from TbFormEarlyWarningNodeInfo where  MenuCode='SemiFinishedSign' 
						   group by MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId) TbYj
						   left join TbSemiFinishedSign sfs on TbYj.EWFormDataCode=sfs.ID
                           left join TbSiteDischargeCargo sdc on sfs.DistributionCode=sdc.DistributionCode and sfs.DischargeCargoCode=sdc.DischargeCargoCode
                           left join TbCompany cp on sfs.ProcessFactoryCode=cp.CompanyCode
                           left join TbCompany cp1 on TbYj.SiteCode=cp1.CompanyCode
						   where YEAR(TbYj.EWTime)= @Year and MONTH(TbYj.EWTime)= @Month  and sfs.ProcessFactoryCode='6386683729561128960') Tb8	
Parameters:
@Year[String] = 2020
@Month[String] = 03


-----------------------------------------------------------------------------
2020-03-27 18:27:36
Text:	--加急订单个数
                           select wo.OrderCode,wo.DistributionTime,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as ProcessFactoryName from TbWorkOrder wo
                           left join TbCompany cp1 on wo.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on wo.ProcessFactoryCode=cp2.CompanyCode
                           where UrgentDegree='Urgent'
                           and YEAR(wo.DistributionTime)= @Year and MONTH(wo.DistributionTime)= @Month  and wo.ProcessFactoryCode='6386683729561128960' ORDER BY wo.DistributionTime desc	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:27:36
Text:	select TbYj.*,cp1.CompanyFullName as SiteName,tcr.EnterSpaceTime,tcr.StartDischargeTime,tcr.EndDischargeTime,disEnt.ProcessFactoryCode,cp.CompanyFullName as ProcessFactoryName from (select min(EwTime) as EwTime,MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId from TbFormEarlyWarningNodeInfo where  MenuCode='SiteDischargeCargo' 
						   group by MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId) TbYj
						   left join TbTransportCarReport tcr on TbYj.EWFormDataCode=tcr.DisEntOrderId
                           left join TbDistributionEnt disEnt on tcr.DistributionCode=disEnt.DistributionCode
                           left join TbCompany cp on disEnt.ProcessFactoryCode=cp.CompanyCode
                           left join TbCompany cp1 on TbYj.SiteCode=cp1.CompanyCode
						   where YEAR(TbYj.EWTime)= @Year and MONTH(TbYj.EWTime)= @Month  and disEnt.ProcessFactoryCode='6386683729561128960' ORDER BY tcr.EnterSpaceTime desc	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:27:36
Text:	select T.id,T.CompanyCode,T.ParentCompanyCode,T.CompanyFullName,T.Address,T.OrgType,pc.ProjectId from  TbCompany T
                           left join TbProjectCompany pc on T.CompanyCode=pc.CompanyCode where T.OrgType!=1 order by T.id asc	


-----------------------------------------------------------------------------
2020-03-27 18:27:36
Text:	select T.id,T.CompanyCode,T.ParentCompanyCode,T.CompanyFullName,T.Address,T.OrgType,pc.ProjectId from  TbCompany T
                           left join TbProjectCompany pc on T.CompanyCode=pc.CompanyCode where T.OrgType!=1 order by T.id asc	


-----------------------------------------------------------------------------
2020-03-27 18:27:36
Text:	 SELECT   [TbOrderProgress].[ProcessingState],[TbOrderProgress].[FinishProcessingDateTime],[TbOrderProgress].[DistributionTime],[TbOrderProgress].[SiteCode] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[SiteCode] IN (@SiteCode492,@SiteCode493,@SiteCode494,@SiteCode495,@SiteCode496,@SiteCode497,@SiteCode498,@SiteCode499,@SiteCode500,@SiteCode501,@SiteCode502,@SiteCode503,@SiteCode504,@SiteCode505,@SiteCode506,@SiteCode507,@SiteCode508,@SiteCode509,@SiteCode510,@SiteCode511,@SiteCode512,@SiteCode513,@SiteCode514,@SiteCode515,@SiteCode516,@SiteCode517,@SiteCode518,@SiteCode519,@SiteCode520,@SiteCode521,@SiteCode522,@SiteCode523,@SiteCode524,@SiteCode525,@SiteCode526,@SiteCode527,@SiteCode528,@SiteCode529,@SiteCode530,@SiteCode531,@SiteCode532,@SiteCode533,@SiteCode534,@SiteCode535,@SiteCode536,@SiteCode537,@SiteCode538,@SiteCode539,@SiteCode540,@SiteCode541,@SiteCode542,@SiteCode543,@SiteCode544,@SiteCode545,@SiteCode546,@SiteCode547,@SiteCode548,@SiteCode549,@SiteCode550,@SiteCode551,@SiteCode552,@SiteCode553,@SiteCode554,@SiteCode555,@SiteCode556,@SiteCode557,@SiteCode558,@SiteCode559,@SiteCode560,@SiteCode561,@SiteCode562,@SiteCode563,@SiteCode564,@SiteCode565,@SiteCode566,@SiteCode567,@SiteCode568,@SiteCode569,@SiteCode570,@SiteCode571,@SiteCode572,@SiteCode573,@SiteCode574,@SiteCode575,@SiteCode576,@SiteCode577,@SiteCode578,@SiteCode579,@SiteCode580,@SiteCode581,@SiteCode582,@SiteCode583,@SiteCode584,@SiteCode585,@SiteCode586,@SiteCode587,@SiteCode588,@SiteCode589,@SiteCode590,@SiteCode591,@SiteCode592,@SiteCode593,@SiteCode594,@SiteCode595,@SiteCode596,@SiteCode597,@SiteCode598,@SiteCode599,@SiteCode600,@SiteCode601,@SiteCode602,@SiteCode603,@SiteCode604,@SiteCode605,@SiteCode606,@SiteCode607,@SiteCode608,@SiteCode609,@SiteCode610,@SiteCode611,@SiteCode612,@SiteCode613,@SiteCode614,@SiteCode615,@SiteCode616,@SiteCode617,@SiteCode618,@SiteCode619,@SiteCode620,@SiteCode621,@SiteCode622,@SiteCode623,@SiteCode624,@SiteCode625,@SiteCode626,@SiteCode627,@SiteCode628,@SiteCode629,@SiteCode630,@SiteCode631,@SiteCode632,@SiteCode633,@SiteCode634,@SiteCode635,@SiteCode636,@SiteCode637,@SiteCode638,@SiteCode639,@SiteCode640,@SiteCode641,@SiteCode642,@SiteCode643,@SiteCode644,@SiteCode645,@SiteCode646,@SiteCode647,@SiteCode648,@SiteCode649,@SiteCode650,@SiteCode651,@SiteCode652,@SiteCode653,@SiteCode654,@SiteCode655,@SiteCode656,@SiteCode657,@SiteCode658,@SiteCode659,@SiteCode660,@SiteCode661,@SiteCode662,@SiteCode663,@SiteCode664,@SiteCode665,@SiteCode666,@SiteCode667,@SiteCode668,@SiteCode669,@SiteCode670,@SiteCode671,@SiteCode672,@SiteCode673,@SiteCode674,@SiteCode675,@SiteCode676,@SiteCode677,@SiteCode678,@SiteCode679,@SiteCode680,@SiteCode681,@SiteCode682,@SiteCode683,@SiteCode684,@SiteCode685,@SiteCode686,@SiteCode687,@SiteCode688,@SiteCode689,@SiteCode690,@SiteCode691,@SiteCode692,@SiteCode693,@SiteCode694,@SiteCode695,@SiteCode696,@SiteCode697,@SiteCode698,@SiteCode699,@SiteCode700,@SiteCode701,@SiteCode702,@SiteCode703,@SiteCode704,@SiteCode705,@SiteCode706,@SiteCode707,@SiteCode708,@SiteCode709,@SiteCode710,@SiteCode711,@SiteCode712,@SiteCode713,@SiteCode714,@SiteCode715,@SiteCode716,@SiteCode717,@SiteCode718,@SiteCode719,@SiteCode720,@SiteCode721,@SiteCode722,@SiteCode723,@SiteCode724,@SiteCode725,@SiteCode726,@SiteCode727,@SiteCode728,@SiteCode729,@SiteCode730,@SiteCode731,@SiteCode732,@SiteCode733,@SiteCode734,@SiteCode735,@SiteCode736,@SiteCode737,@SiteCode738,@SiteCode739)) AND (YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=3)) 	
Parameters:
@SiteCode492[String] = 6274027775095472128
@SiteCode493[String] = 6274027929433276416
@SiteCode494[String] = 6417410523612188672
@SiteCode495[String] = 6274028333340557312
@SiteCode496[String] = 6274028829845487616
@SiteCode497[String] = 6274029086029381632
@SiteCode498[String] = 6274029528142577664
@SiteCode499[String] = 6274029966388625408
@SiteCode500[String] = 6274030152053686272
@SiteCode501[String] = 6274030373047369728
@SiteCode502[String] = 6274030913332445184
@SiteCode503[String] = 6267789807737372672
@SiteCode504[String] = 6267790255894560768
@SiteCode505[String] = 6267790460492709888
@SiteCode506[String] = 6267790574804271104
@SiteCode507[String] = 6267791036517449728
@SiteCode508[String] = 6267791338536697856
@SiteCode509[String] = 6267791654132908032
@SiteCode510[String] = 6267790081113718784
@SiteCode511[String] = 6267790783294734336
@SiteCode512[String] = 6267791210027417600
@SiteCode513[String] = 6267791528110850048
@SiteCode514[String] = 6437059801301262336
@SiteCode515[String] = 6308426901824208896
@SiteCode516[String] = 6276140742482067456
@SiteCode517[String] = 6276141050964738048
@SiteCode518[String] = 6276141450283450368
@SiteCode519[String] = 6276141737463250944
@SiteCode520[String] = 6276141926932545536
@SiteCode521[String] = 6267796592825204736
@SiteCode522[String] = 6267796864196673536
@SiteCode523[String] = 6267797037211713536
@SiteCode524[String] = 6267797181319610368
@SiteCode525[String] = 6276760608893304832
@SiteCode526[String] = 6267798187931598848
@SiteCode527[String] = 6267798388054425600
@SiteCode528[String] = 6267749616851091456
@SiteCode529[String] = 6267750471750909952
@SiteCode530[String] = 6267750709144322048
@SiteCode531[String] = 6267750895786655744
@SiteCode532[String] = 6267751010588950528
@SiteCode533[String] = 6267753037104676864
@SiteCode534[String] = 6267754200801738752
@SiteCode535[String] = 6267754324688896000
@SiteCode536[String] = 6267797518566817792
@SiteCode537[String] = 6267783175129268224
@SiteCode538[String] = 6267783320914886656
@SiteCode539[String] = 6267783444885929984
@SiteCode540[String] = 6267783577954418688
@SiteCode541[String] = 6267784612617912320
@SiteCode542[String] = 6267785016667799552
@SiteCode543[String] = 6267785185136214016
@SiteCode544[String] = 6267785381991677952
@SiteCode545[String] = 6267785590951903232
@SiteCode546[String] = 6267785762842869760
@SiteCode547[String] = 6267793585479876608
@SiteCode548[String] = 6267793380881727488
@SiteCode549[String] = 6437060915425845248
@SiteCode550[String] = 6284878460246556672
@SiteCode551[String] = 6284879065547538432
@SiteCode552[String] = 6285119541664022528
@SiteCode553[String] = 6285120302351384576
@SiteCode554[String] = 6285181647230861312
@SiteCode555[String] = 6285120520983674880
@SiteCode556[String] = 6285120866493661184
@SiteCode557[String] = 6285121357168508928
@SiteCode558[String] = 6285122203776188416
@SiteCode559[String] = 6437059163368595456
@SiteCode560[String] = 6374383547544903680
@SiteCode561[String] = 6374384032955899904
@SiteCode562[String] = 6374384202665828352
@SiteCode563[String] = 6274029086029381711
@SiteCode564[String] = 6274029086029381712
@SiteCode565[String] = 6274029086029381713
@SiteCode566[String] = 6274029086029381714
@SiteCode567[String] = 6274029086029381721
@SiteCode568[String] = 6274029086029381722
@SiteCode569[String] = 6274029086029381723
@SiteCode570[String] = 6274029086029381731
@SiteCode571[String] = 6274029086029381741
@SiteCode572[String] = 6274029086029381742
@SiteCode573[String] = 6274029086029381743
@SiteCode574[String] = 6274029086029381751
@SiteCode575[String] = 6274029086029381752
@SiteCode576[String] = 6274029086029381753
@SiteCode577[String] = 6274029086029381754
@SiteCode578[String] = 6274029086029381761
@SiteCode579[String] = 6274029086029381762
@SiteCode580[String] = 6274029086029381763
@SiteCode581[String] = 6274029086029381764
@SiteCode582[String] = 6274029086029381765
@SiteCode583[String] = 6274029086029381771
@SiteCode584[String] = 6274029086029381772
@SiteCode585[String] = 6274029086029381773
@SiteCode586[String] = 6274029086029381774
@SiteCode587[String] = 6274029086029381781
@SiteCode588[String] = 6247574415609991503
@SiteCode589[String] = 6247574415609991475
@SiteCode590[String] = 6247574415609991476
@SiteCode591[String] = 6247574415609991516
@SiteCode592[String] = 6247574415609991459
@SiteCode593[String] = 6247574415609991379
@SiteCode594[String] = 6247574415609991461
@SiteCode595[String] = 6247574415609991489
@SiteCode596[String] = 6247574415609991491
@SiteCode597[String] = 6247574415609991492
@SiteCode598[String] = 6247574415609991493
@SiteCode599[String] = 6247574415609991462
@SiteCode600[String] = 6247574415609991494
@SiteCode601[String] = 6247574415609991515
@SiteCode602[String] = 6247574415609991479
@SiteCode603[String] = 6247574415609991513
@SiteCode604[String] = 6247574415609991514
@SiteCode605[String] = 6247574415609991498
@SiteCode606[String] = 6247574415609991466
@SiteCode607[String] = 6247574415609991499
@SiteCode608[String] = 6247574415609991500
@SiteCode609[String] = 6247574415609991477
@SiteCode610[String] = 6247574415609991485
@SiteCode611[String] = 6247574415609991470
@SiteCode612[String] = 6247574415609991471
@SiteCode613[String] = 6247574415609991328
@SiteCode614[String] = 6247574415609991463
@SiteCode615[String] = 6247574415609991472
@SiteCode616[String] = 6247574415609991473
@SiteCode617[String] = 6247574415609991508
@SiteCode618[String] = 6247574415609991518
@SiteCode619[String] = 6247574415609991528
@SiteCode620[String] = 6247574415609991538
@SiteCode621[String] = 6247574415609991548
@SiteCode622[String] = 6247574415609991484
@SiteCode623[String] = 6247574415609991457
@SiteCode624[String] = 6247574415609991458
@SiteCode625[String] = 6247574415609991456
@SiteCode626[String] = 6247574415609991486
@SiteCode627[String] = 6247574415609991487
@SiteCode628[String] = 6247574415609991496
@SiteCode629[String] = 6247574415609991497
@SiteCode630[String] = 6247574415609991465
@SiteCode631[String] = 6247574415609991596
@SiteCode632[String] = 6247574415609991469
@SiteCode633[String] = 6247574415609991506
@SiteCode634[String] = 6247574415609991507
@SiteCode635[String] = 6247574415609991483
@SiteCode636[String] = 6247574415609991468
@SiteCode637[String] = 6247574415609991504
@SiteCode638[String] = 6247574415609991505
@SiteCode639[String] = 6247574415609991481
@SiteCode640[String] = 6247574415609991482
@SiteCode641[String] = 6247574415609991301
@SiteCode642[String] = 6247574415609991448
@SiteCode643[String] = 6247574415609991464
@SiteCode644[String] = 6247574415609991467
@SiteCode645[String] = 6247574415609991480
@SiteCode646[String] = 6247574415609991501
@SiteCode647[String] = 6247574415609991502
@SiteCode648[String] = 6247574415609991474
@SiteCode649[String] = 6353366542494859264
@SiteCode650[String] = 6353366542893318144
@SiteCode651[String] = 6353366543044313088
@SiteCode652[String] = 6353366543228862464
@SiteCode653[String] = 6353366543409217536
@SiteCode654[String] = 6353366543606349824
@SiteCode655[String] = 6353366543811870720
@SiteCode656[String] = 6353366544071917568
@SiteCode657[String] = 6353366544277438464
@SiteCode658[String] = 6353366544436822016
@SiteCode659[String] = 6353366544650731520
@SiteCode660[String] = 6353366544873029632
@SiteCode661[String] = 6353366545128882176
@SiteCode662[String] = 6353366545544118272
@SiteCode663[String] = 6353366545888051200
@SiteCode664[String] = 6353366546290704384
@SiteCode665[String] = 6353366546684968960
@SiteCode666[String] = 6353366547070844928
@SiteCode667[String] = 6353366547507052544
@SiteCode668[String] = 6353366548132003840
@SiteCode669[String] = 6353366545346985984
@SiteCode670[String] = 6353366545728667648
@SiteCode671[String] = 6353366546106155008
@SiteCode672[String] = 6353366546496225280
@SiteCode673[String] = 6353366546898878464
@SiteCode674[String] = 6353366547276365824
@SiteCode675[String] = 6353366547746127872
@SiteCode676[String] = 6353366548492713984
@SiteCode677[String] = 6353366557258809344
@SiteCode678[String] = 6353366557393027072
@SiteCode679[String] = 6353366557539827712
@SiteCode680[String] = 6353366557787291648
@SiteCode681[String] = 6353366557908926464
@SiteCode682[String] = 6353366558022172672
@SiteCode683[String] = 6353366558168973312
@SiteCode684[String] = 6353366535347765248
@SiteCode685[String] = 6353366535595229184
@SiteCode686[String] = 6353366535834304512
@SiteCode687[String] = 6353366536274706432
@SiteCode688[String] = 6353366536589279232
@SiteCode689[String] = 6353366536941600768
@SiteCode690[String] = 6353366537365225472
@SiteCode691[String] = 6353366539030364160
@SiteCode692[String] = 6353366556675801088
@SiteCode693[String] = 6353366556818407424
@SiteCode694[String] = 6353366556948430848
@SiteCode695[String] = 6353366557132980224
@SiteCode696[String] = 6353366541391757312
@SiteCode697[String] = 6353366541916045312
@SiteCode698[String] = 6353366542264172544
@SiteCode699[String] = 6353366542683602944
@SiteCode700[String] = 6353366540196380672
@SiteCode701[String] = 6353366540808749056
@SiteCode702[String] = 6353366541085573120
@SiteCode703[String] = 6353366541718913024
@SiteCode704[String] = 6353366542121566208
@SiteCode705[String] = 6353366550040412160
@SiteCode706[String] = 6353366550489202688
@SiteCode707[String] = 6353366550698917888
@SiteCode708[String] = 6353366550891855872
@SiteCode709[String] = 6353366551416143872
@SiteCode710[String] = 6353366553555238912
@SiteCode711[String] = 6353366553697845248
@SiteCode712[String] = 6353366554050166784
@SiteCode713[String] = 6353366548702429184
@SiteCode714[String] = 6353366548899561472
@SiteCode715[String] = 6353366549050556416
@SiteCode716[String] = 6353366549285437440
@SiteCode717[String] = 6353366549486764032
@SiteCode718[String] = 6353366549679702016
@SiteCode719[String] = 6353366549851668480
@SiteCode720[String] = 6353366550258515968
@SiteCode721[String] = 6353366555786608640
@SiteCode722[String] = 6353366554188578816
@SiteCode723[String] = 6353366554649952256
@SiteCode724[String] = 6353366554771587072
@SiteCode725[String] = 6353366554930970624
@SiteCode726[String] = 6353366555102937088
@SiteCode727[String] = 6353366555258126336
@SiteCode728[String] = 6353366555438481408
@SiteCode729[String] = 6353366555597864960
@SiteCode730[String] = 6353366555916632064
@SiteCode731[String] = 6353366556071821312
@SiteCode732[String] = 6353366556214427648
@SiteCode733[String] = 6353366556386394112
@SiteCode734[String] = 6353366556524806144
@SiteCode735[String] = 6353366551172874240
@SiteCode736[String] = 6353366553857228800
@SiteCode737[String] = 6374383547544903681
@SiteCode738[String] = 6374384032955899902
@SiteCode739[String] = 6374384202665828353


-----------------------------------------------------------------------------
2020-03-27 18:27:37
Text:	SELECT sm.MenuName,fwqi.EWContent,fwqi.EWUserCode,u.UserName,fwqi.EWFormDataCode,cp1.CompanyFullName as  FbName,cp2.CompanyFullName as GqName,fwqi.EWTime,sdd.DictionaryText as RebarType  
                   FROM (  
                    select ret.*
                    FROM ( 
                         SELECT *, row_number()over(partition BY EarlyWarningCode,EWFormDataCode ORDER BY EWNodeCode,EWTime desc) as group_idx 
                         FROM TbFormEarlyWarningNodeInfo fwqi
                         WHERE YEAR(fwqi.EWTime)= @Year and MONTH(fwqi.EWTime)= @Month AND fwqi.MenuCode='RawMonthDemandPlan' AND fwqi.EWStart=0
                    ) ret
                    WHERE ret.group_idx = 1
                   ) fwqi
                    left join TbSysMenu sm on fwqi.MenuCode=sm.MenuCode
                            left join TbCompany cp1 on fwqi.CompanyCode=cp1.CompanyCode
                            left join TbCompany cp2 on fwqi.WorkArea=cp2.CompanyCode
                            left join TbCompany cp3 on fwqi.SiteCode=cp3.CompanyCode
                            left join TbUser u on fwqi.EWUserCode=u.UserId
                            left join TbRawMaterialMonthDemandPlan rmp on fwqi.EWFormDataCode=rmp.ID
                            left join TbSysDictionaryData sdd on sdd.DictionaryCode=rmp.RebarType
                    where 1=1 ORDER BY fwqi.EWTime DESC	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:27:37
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE ((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode741) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus742)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode741[String] = 6386683729561128960
@Examinestatus742[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:27:37
Text:	 SELECT   * FROM [TbRawMaterialMonthDemandSupplyPlan]  WHERE [TbRawMaterialMonthDemandSupplyPlan].[DemandPlanCode] IN (@DemandPlanCode743,@DemandPlanCode744,@DemandPlanCode745,@DemandPlanCode746,@DemandPlanCode747,@DemandPlanCode748,@DemandPlanCode749,@DemandPlanCode750,@DemandPlanCode751) 	
Parameters:
@DemandPlanCode743[String] = XQJH202000002
@DemandPlanCode744[String] = XQJH202000003
@DemandPlanCode745[String] = XQJH202000004
@DemandPlanCode746[String] = XQJH202000005
@DemandPlanCode747[String] = XQJH202000006
@DemandPlanCode748[String] = XQJH202000007
@DemandPlanCode749[String] = XQJH202000008
@DemandPlanCode750[String] = XQJH202000009
@DemandPlanCode751[String] = XQJH202000010


-----------------------------------------------------------------------------
2020-03-27 18:27:37
Text:	 SELECT   [TbFactoryBatchNeedPlan].[RawMaterialDemandNum] AS [DemandPlanCode],[TbFactoryBatchNeedPlan].[BatchPlanNum],[TbFactoryBatchNeedPlan].[SteelsTypeCode] AS [RebarType],[TbFactoryBatchNeedPlan].[BatchPlanTotal] AS [TotalWeight] FROM [TbFactoryBatchNeedPlan]  WHERE (([TbFactoryBatchNeedPlan].[Examinestatus] = @Examinestatus752) AND ([TbFactoryBatchNeedPlan].[RawMaterialDemandNum] IN (@RawMaterialDemandNum753,@RawMaterialDemandNum754,@RawMaterialDemandNum755,@RawMaterialDemandNum756,@RawMaterialDemandNum757,@RawMaterialDemandNum758,@RawMaterialDemandNum759,@RawMaterialDemandNum760,@RawMaterialDemandNum761,@RawMaterialDemandNum762,@RawMaterialDemandNum763,@RawMaterialDemandNum764,@RawMaterialDemandNum765,@RawMaterialDemandNum766,@RawMaterialDemandNum767,@RawMaterialDemandNum768,@RawMaterialDemandNum769))) 	
Parameters:
@Examinestatus752[String] = 审核完成
@RawMaterialDemandNum753[String] = XQJH202000002
@RawMaterialDemandNum754[String] = XQJH202000003
@RawMaterialDemandNum755[String] = XQJH202000004
@RawMaterialDemandNum756[String] = XQJH202000005
@RawMaterialDemandNum757[String] = XQJH202000006
@RawMaterialDemandNum758[String] = XQJH202000007
@RawMaterialDemandNum759[String] = XQJH202000008
@RawMaterialDemandNum760[String] = XQJH202000009
@RawMaterialDemandNum761[String] = XQJH202000010
@RawMaterialDemandNum762[String] = BCJH202000002
@RawMaterialDemandNum763[String] = BCJH202000003
@RawMaterialDemandNum764[String] = BCJH202000004
@RawMaterialDemandNum765[String] = BCJH202000005
@RawMaterialDemandNum766[String] = BCJH202000006
@RawMaterialDemandNum767[String] = BCJH202000007
@RawMaterialDemandNum768[String] = BCJH202000009
@RawMaterialDemandNum769[String] = BCJH202000008


-----------------------------------------------------------------------------
2020-03-27 18:27:37
Text:	 SELECT   [TbSupplyList].[SteelsTypeCode] AS [RebarType],[TbSupplyList].[HasSupplierTotal] AS [TotalWeight] FROM [TbSupplyList]  WHERE (([TbSupplyList].[StateCode] <> @StateCode740) AND ([TbSupplyList].[BatchPlanNum] IN (@BatchPlanNum770,@BatchPlanNum771,@BatchPlanNum772,@BatchPlanNum773,@BatchPlanNum774,@BatchPlanNum775))) 	
Parameters:
@StateCode740[String] = 未供货
@BatchPlanNum770[String] = PCJH202000002
@BatchPlanNum771[String] = PCJH202000003
@BatchPlanNum772[String] = PCJH202000004
@BatchPlanNum773[String] = PCJH202000005
@BatchPlanNum774[String] = PCJH202000006
@BatchPlanNum775[String] = PCJH202000007


-----------------------------------------------------------------------------
2020-03-27 18:27:37
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE (([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode776) AND ([TbRawMaterialArchives].[RebarType] = @RebarType777)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode776[String] = 6386683729561128960
@RebarType777[String] = BuildingSteel


-----------------------------------------------------------------------------
2020-03-27 18:27:37
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE (([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode778) AND ([TbRawMaterialArchives].[RebarType] = @RebarType779)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode778[String] = 6386683729561128960
@RebarType779[String] = SectionSteel


-----------------------------------------------------------------------------
2020-03-27 18:27:37
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE ((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode780) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus781)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode780[String] = 6386683729561128960
@Examinestatus781[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:27:37
Text:	 SELECT   * FROM [TbRawMaterialMonthDemandSupplyPlan]  WHERE [TbRawMaterialMonthDemandSupplyPlan].[DemandPlanCode] IN (@DemandPlanCode782,@DemandPlanCode783,@DemandPlanCode784,@DemandPlanCode785,@DemandPlanCode786,@DemandPlanCode787,@DemandPlanCode788,@DemandPlanCode789,@DemandPlanCode790) 	
Parameters:
@DemandPlanCode782[String] = XQJH202000002
@DemandPlanCode783[String] = XQJH202000003
@DemandPlanCode784[String] = XQJH202000004
@DemandPlanCode785[String] = XQJH202000005
@DemandPlanCode786[String] = XQJH202000006
@DemandPlanCode787[String] = XQJH202000007
@DemandPlanCode788[String] = XQJH202000008
@DemandPlanCode789[String] = XQJH202000009
@DemandPlanCode790[String] = XQJH202000010


-----------------------------------------------------------------------------
2020-03-27 18:27:37
Text:	 SELECT   [TbSupplyList].[BatchPlanTotal],[TbSupplyList].[HasSupplierTotal],[TbSupplyList].[StateCode],[TbSupplyList].[SteelsTypeCode],[TbSupplyList].[SupplyCompleteTime],[TbSupplyList].[SupplyDate] FROM [TbSupplyList]  WHERE ([TbSupplyList].[RawMaterialDemandNum] IN (@RawMaterialDemandNum791,@RawMaterialDemandNum792,@RawMaterialDemandNum793,@RawMaterialDemandNum794,@RawMaterialDemandNum795,@RawMaterialDemandNum796,@RawMaterialDemandNum797,@RawMaterialDemandNum798,@RawMaterialDemandNum799,@RawMaterialDemandNum800,@RawMaterialDemandNum801,@RawMaterialDemandNum802,@RawMaterialDemandNum803,@RawMaterialDemandNum804,@RawMaterialDemandNum805,@RawMaterialDemandNum806,@RawMaterialDemandNum807)) 	
Parameters:
@RawMaterialDemandNum791[String] = XQJH202000002
@RawMaterialDemandNum792[String] = XQJH202000003
@RawMaterialDemandNum793[String] = XQJH202000004
@RawMaterialDemandNum794[String] = XQJH202000005
@RawMaterialDemandNum795[String] = XQJH202000006
@RawMaterialDemandNum796[String] = XQJH202000007
@RawMaterialDemandNum797[String] = XQJH202000008
@RawMaterialDemandNum798[String] = XQJH202000009
@RawMaterialDemandNum799[String] = XQJH202000010
@RawMaterialDemandNum800[String] = BCJH202000002
@RawMaterialDemandNum801[String] = BCJH202000003
@RawMaterialDemandNum802[String] = BCJH202000004
@RawMaterialDemandNum803[String] = BCJH202000005
@RawMaterialDemandNum804[String] = BCJH202000006
@RawMaterialDemandNum805[String] = BCJH202000007
@RawMaterialDemandNum806[String] = BCJH202000009
@RawMaterialDemandNum807[String] = BCJH202000008


-----------------------------------------------------------------------------
2020-03-27 18:27:38
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE ((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode812) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus813)) 	
Parameters:
@ProcessFactoryCode812[String] = 6386683729561128960
@Examinestatus813[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:27:38
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode814,@OrderCode815,@OrderCode816,@OrderCode817,@OrderCode818,@OrderCode819,@OrderCode820,@OrderCode821)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode814[String] = JGDD202000001
@OrderCode815[String] = JGDD202000002
@OrderCode816[String] = JGDD202000003
@OrderCode817[String] = JGDD202000004
@OrderCode818[String] = JGDD202000005
@OrderCode819[String] = JGDD202000006
@OrderCode820[String] = JGDD202000008
@OrderCode821[String] = JGDD202000009


-----------------------------------------------------------------------------
2020-03-27 18:27:38
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE (((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode808)) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState809,@ProcessingState810,@ProcessingState811))) 	
Parameters:
@ProcessFactoryCode808[String] = 6386683729561128960
@ProcessingState809[String] = Processing
@ProcessingState810[String] = Received
@ProcessingState811[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 18:27:38
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat822) 	
Parameters:
@DaetailWorkStrat822[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 18:27:38
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE ((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode823) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus824)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode823[String] = 6386683729561128960
@Examinestatus824[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:27:38
Text:	 SELECT   * FROM [TbRawMaterialMonthDemandSupplyPlan]  WHERE [TbRawMaterialMonthDemandSupplyPlan].[DemandPlanCode] IN (@DemandPlanCode825,@DemandPlanCode826,@DemandPlanCode827,@DemandPlanCode828,@DemandPlanCode829,@DemandPlanCode830,@DemandPlanCode831,@DemandPlanCode832,@DemandPlanCode833) 	
Parameters:
@DemandPlanCode825[String] = XQJH202000002
@DemandPlanCode826[String] = XQJH202000003
@DemandPlanCode827[String] = XQJH202000004
@DemandPlanCode828[String] = XQJH202000005
@DemandPlanCode829[String] = XQJH202000006
@DemandPlanCode830[String] = XQJH202000007
@DemandPlanCode831[String] = XQJH202000008
@DemandPlanCode832[String] = XQJH202000009
@DemandPlanCode833[String] = XQJH202000010


-----------------------------------------------------------------------------
2020-03-27 18:27:38
Text:	 SELECT   [TbFactoryBatchNeedPlan].[RawMaterialDemandNum] AS [DemandPlanCode],[TbFactoryBatchNeedPlan].[BatchPlanNum],[TbFactoryBatchNeedPlan].[SteelsTypeCode] AS [RebarType],[TbFactoryBatchNeedPlan].[BatchPlanTotal] AS [TotalWeight] FROM [TbFactoryBatchNeedPlan]  WHERE (([TbFactoryBatchNeedPlan].[Examinestatus] = @Examinestatus834) AND ([TbFactoryBatchNeedPlan].[RawMaterialDemandNum] IN (@RawMaterialDemandNum835,@RawMaterialDemandNum836,@RawMaterialDemandNum837,@RawMaterialDemandNum838,@RawMaterialDemandNum839,@RawMaterialDemandNum840,@RawMaterialDemandNum841,@RawMaterialDemandNum842,@RawMaterialDemandNum843))) 	
Parameters:
@Examinestatus834[String] = 审核完成
@RawMaterialDemandNum835[String] = XQJH202000002
@RawMaterialDemandNum836[String] = XQJH202000003
@RawMaterialDemandNum837[String] = XQJH202000004
@RawMaterialDemandNum838[String] = XQJH202000005
@RawMaterialDemandNum839[String] = XQJH202000006
@RawMaterialDemandNum840[String] = XQJH202000007
@RawMaterialDemandNum841[String] = XQJH202000008
@RawMaterialDemandNum842[String] = XQJH202000009
@RawMaterialDemandNum843[String] = XQJH202000010


-----------------------------------------------------------------------------
2020-03-27 18:27:38
Text:	select * from (select cp2.CompanyCode,cp2.CompanyFullName from (select SiteCode from TbWorkOrder where 
            (CONVERT(varchar(7) ,InsertTime, 120)='2020-02' or CONVERT(varchar(7) ,InsertTime, 120)='2020-01' or CONVERT(varchar(7) ,InsertTime, 120)='2020-03') and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId) and (ISNULL(@ProcessFactoryCode,'')='' or ProcessFactoryCode=@ProcessFactoryCode)
            group by SiteCode) TbWO
            left join TbCompany cp on TBWO.SiteCode=cp.CompanyCode
            left join TbCompany cp2 on cp2.CompanyCode=cp.ParentCompanyCode
            group by cp2.CompanyCode,cp2.CompanyFullName
            union all
            select rmdp.WorkAreaCode,cp.CompanyFullName
            from TbRawMaterialMonthDemandPlan rmdp
            left join TbCompany cp on cp.CompanyCode=rmdp.WorkAreaCode
            where (rmdp.DemandMonth='2020-02' or rmdp.DemandMonth='2020-01' or rmdp.DemandMonth='2020-03') and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId) and (ISNULL(@ProcessFactoryCode,'')='' or ProcessFactoryCode=@ProcessFactoryCode)) TbGq group by TbGq.CompanyCode,TbGq.CompanyFullName	
Parameters:
@ProjectId[String] = 
@ProcessFactoryCode[String] = 6386683729561128960


-----------------------------------------------------------------------------
2020-03-27 18:29:06
Text:	select TbAll.EarlyWarningCode,TbAll.BranchCode,TbAll.BranchName,TbAll.WorkAreaCode,TbAll.WorkAreaName,TbAll.SiteCode,TbAll.SiteName,TbAll.ProjectId,TbAll.YjMonth,TbAll.MenuCode,TbAll.EWNodeCode,TbAll.EWNodeName,TbAll.PersonnelCode,TbAll.PersonnelSource,TbAll.BegEwTiemNew from (select Tb.*,case when Tb.EWTimeType='年' then DATEADD(YEAR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='月' then DATEADD(MONTH,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='天' then DATEADD(DAY,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='时' then DATEADD(HOUR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='分' then DATEADD(MINUTE,Tb.EWTime,Tb.BegEwTiem) end as BegEwTiemNew,TbYjInfo.EarlyWarningCode as YjCode from (select ewt.EarlyWarningCode,DATENAME(year,GETDATE())+'-'+ DATENAME(MONTH,GETDATE())+'-'+ CONVERT(varchar(20),ewt.EWBegDay)+' '+CONVERT(varchar(20),ewt.EWBegHour)+':'+CONVERT(varchar(20),ewt.EWBegMinute)+':00' as BegEwTiem,ewt.BranchCode,cp1.CompanyFullName as BranchName,ewt.WorkAreaCode,cp2.CompanyFullName as WorkAreaName,ewt.SiteCode,cp3.CompanyFullName as SiteName,ewt.ProjectId,MONTH(GETDATE()) as YjMonth,ewt.MenuCode,ewn.EWNodeCode,ewn.EWNodeName,ewn.EWTimeType,ewn.EWTime,ewnp.PersonnelCode,ewnp.PersonnelSource,ewnp.DeptId,ewnp.RoleId from TbFormEarlyWarningBegTime ewt 
left join TbFormEarlyWarningNode ewn on ewt.EarlyWarningCode=ewn.EarlyWarningCode and ewt.ProjectId=ewn.ProjectId and ewt.MenuCode=ewn.MenuCode
left join TbFormEarlyWarningNodePersonnel ewnp on ewn.EarlyWarningCode=ewnp.EarlyWarningCode and ewn.EWNodeCode=ewnp.EWNodeCode and  ewn.MenuCode=ewnp.MenuCode and ewn.ProjectId=ewnp.ProjectId
left join TbCompany cp1 on ewt.BranchCode=cp1.CompanyCode
left join TbCompany cp2 on ewt.WorkAreaCode=cp2.CompanyCode
left join TbCompany cp3 on ewt.SiteCode=cp3.CompanyCode
where ewt.MenuCode='RawMonthDemandPlan') Tb 
left join (select EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId from TbFormEarlyWarningNodeInfo ewni
where ewni.EWFormDataCode=MONTH(GETDATE()) group by EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId) TbYjInfo on Tb.EarlyWarningCode=TbYjInfo.EarlyWarningCode and Tb.EWNodeCode=TbYjInfo.EWNodeCode and Tb.MenuCode=TbYjInfo.MenuCode and  Tb.YjMonth=TbYjInfo.EWFormDataCode and Tb.WorkAreaCode=TbYjInfo.WorkArea and Tb.ProjectId=TbYjInfo.ProjectId
where GETDATE()>=BegEwTiem and Tb.WorkAreaCode not in(select rmdp.WorkAreaCode from TbRawMaterialMonthDemandPlan rmdp where MONTH(InsertTime)=MONTH(GETDATE())
group by rmdp.WorkAreaCode)) TbAll where TbAll.YjCode is null and TbAll.PersonnelCode is not null and GETDATE()>=TbAll.BegEwTiemNew	


-----------------------------------------------------------------------------
2020-03-27 18:30:24
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode844) AND ([TbUser].[UserPwd] = @UserPwd845) 	
Parameters:
@UserCode844[String] = 102787
@UserPwd845[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-03-27 18:30:24
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 102787


-----------------------------------------------------------------------------
2020-03-27 18:30:24
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 102787


-----------------------------------------------------------------------------
2020-03-27 18:30:24
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 102787
@ProjectId[String] = 6245721945602523136
@OrgId[String] = 6247574415609954304


-----------------------------------------------------------------------------
2020-03-27 18:30:24
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode846 	
Parameters:
@UserCode846[String] = 102787


-----------------------------------------------------------------------------
2020-03-27 18:30:24
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu847,@ActionType848,@HostName849,@LogDate850,@UserCode851,@UserIP852);select scope_identity()	
Parameters:
@ActionMenu847[String] = 0
@ActionType848[String] = 登录系统
@HostName849[String] = 
@LogDate850[DateTime] = 2020/3/27 18:30:24
@UserCode851[String] = 102787
@UserIP852[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-03-27 18:30:29
Text:	 SELECT   [TbDistributionPlanInfo].*,[TbCompany].[ParentCompanyCode],[TbOrderProgress].[FinishProcessingDateTime] FROM [TbDistributionPlanInfo] LEFT OUTER JOIN [TbCompany] ON ([TbDistributionPlanInfo].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbOrderProgress] ON ([TbDistributionPlanInfo].[OrderCode] = [TbOrderProgress].[OrderCode])  WHERE (([TbDistributionPlanInfo].[Examinestatus] = @Examinestatus853) AND ([TbDistributionPlanInfo].[ProcessFactoryCode] = @ProcessFactoryCode854)) 	
Parameters:
@Examinestatus853[String] = 审核完成
@ProcessFactoryCode854[String] = 6386683214299275264


-----------------------------------------------------------------------------
2020-03-27 18:30:29
Text:	select isnull(sum(TbCF.Capacity),0) as Capacity,isnull(sum(TbCF.WeightSmallPlan),0) as WeightSmallPlan,isnull(cast(sum(TbCF.WeightSmallPlan)/sum(TbCF.Capacity)*100 as decimal(18,2)),0) as ActualLoadNew from (select cf.Capacity,Tb1.WeightSmallPlan,cf.ProcessFactoryCode from TbCapacityFilling cf  
left join(
select SUM(Tb.WeightSmallPlan) as WeightSmallPlan,Tb.ProcessFactoryCode from (
                            select isnull(SUM(wod.WeightSmallPlan),0) as WeightSmallPlan,wo.ProcessFactoryCode from TbWorkOrder wo
                            left join TbWorkOrderDetail wod on wo.OrderCode=wod.OrderCode
                            where (ISNULL(@ProcessFactoryCode,'')='' or wo.ProcessFactoryCode=@ProcessFactoryCode)
                            and CONVERT(varchar(7), wo.DistributionTime, 120)=@month
                            and wod.RevokeStart='正常' and wo.ProcessingState!='ConfirmWork' and wo.ProcessingState!='Finishing'  group by wo.ProcessFactoryCode
                            union all
                            select isnull(sum(opd.NoCompleted),0) as NoCompleted,op.ProcessFactoryCode from TbOrderProgress op
                            left join TbOrderProgressDetail opd on op.OrderCode=opd.OrderCode 
                            where (ISNULL(@ProcessFactoryCode,'')='' or op.ProcessFactoryCode=@ProcessFactoryCode)
                            and CONVERT(varchar(7), op.DistributionTime, 120)=CONVERT(varchar(4),YEAR(DATEADD(MONTH,-1,@month+'-01')))+'-'+Right(100+Month(DATEADD(MONTH,-1,@month+'-01')),2)
                            and opd.RevokeStart='正常'  group by op.ProcessFactoryCode)Tb  group by Tb.ProcessFactoryCode
) Tb1 on cf.ProcessFactoryCode=Tb1.ProcessFactoryCode 
where cf.CapacityMonth=@month
and (ISNULL(@ProcessFactoryCode,'')='' or cf.ProcessFactoryCode=@ProcessFactoryCode)) TbCF where (ISNULL(@ProcessFactoryCode,'')='' or TbCF.ProcessFactoryCode=@ProcessFactoryCode)	
Parameters:
@ProcessFactoryCode[String] = 6386683214299275264
@month[String] = 2020-03


-----------------------------------------------------------------------------
2020-03-27 18:30:29
Text:	 SELECT   TOP 1 [TbStorage].[StorageAdd],[TbStorage].[Tel],[TbUser].[UserName] FROM [TbStorage] LEFT OUTER JOIN [TbUser] ON ([TbStorage].[UserCode] = [TbUser].[UserCode])  WHERE [TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode855 	
Parameters:
@ProcessFactoryCode855[String] = 6386683214299275264


-----------------------------------------------------------------------------
2020-03-27 18:30:29
Text:	 SELECT   [TbDistributionPlanInfo].*,[TbCompany].[ParentCompanyCode],[TbOrderProgress].[FinishProcessingDateTime] FROM [TbDistributionPlanInfo] LEFT OUTER JOIN [TbCompany] ON ([TbDistributionPlanInfo].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbOrderProgress] ON ([TbDistributionPlanInfo].[OrderCode] = [TbOrderProgress].[OrderCode])  WHERE (([TbDistributionPlanInfo].[Examinestatus] = @Examinestatus856) AND ([TbDistributionPlanInfo].[ProcessFactoryCode] = @ProcessFactoryCode857)) 	
Parameters:
@Examinestatus856[String] = 审核完成
@ProcessFactoryCode857[String] = 6386683729561128960


-----------------------------------------------------------------------------
2020-03-27 18:30:29
Text:	select isnull(sum(TbCF.Capacity),0) as Capacity,isnull(sum(TbCF.WeightSmallPlan),0) as WeightSmallPlan,isnull(cast(sum(TbCF.WeightSmallPlan)/sum(TbCF.Capacity)*100 as decimal(18,2)),0) as ActualLoadNew from (select cf.Capacity,Tb1.WeightSmallPlan,cf.ProcessFactoryCode from TbCapacityFilling cf  
left join(
select SUM(Tb.WeightSmallPlan) as WeightSmallPlan,Tb.ProcessFactoryCode from (
                            select isnull(SUM(wod.WeightSmallPlan),0) as WeightSmallPlan,wo.ProcessFactoryCode from TbWorkOrder wo
                            left join TbWorkOrderDetail wod on wo.OrderCode=wod.OrderCode
                            where (ISNULL(@ProcessFactoryCode,'')='' or wo.ProcessFactoryCode=@ProcessFactoryCode)
                            and CONVERT(varchar(7), wo.DistributionTime, 120)=@month
                            and wod.RevokeStart='正常' and wo.ProcessingState!='ConfirmWork' and wo.ProcessingState!='Finishing'  group by wo.ProcessFactoryCode
                            union all
                            select isnull(sum(opd.NoCompleted),0) as NoCompleted,op.ProcessFactoryCode from TbOrderProgress op
                            left join TbOrderProgressDetail opd on op.OrderCode=opd.OrderCode 
                            where (ISNULL(@ProcessFactoryCode,'')='' or op.ProcessFactoryCode=@ProcessFactoryCode)
                            and CONVERT(varchar(7), op.DistributionTime, 120)=CONVERT(varchar(4),YEAR(DATEADD(MONTH,-1,@month+'-01')))+'-'+Right(100+Month(DATEADD(MONTH,-1,@month+'-01')),2)
                            and opd.RevokeStart='正常'  group by op.ProcessFactoryCode)Tb  group by Tb.ProcessFactoryCode
) Tb1 on cf.ProcessFactoryCode=Tb1.ProcessFactoryCode 
where cf.CapacityMonth=@month
and (ISNULL(@ProcessFactoryCode,'')='' or cf.ProcessFactoryCode=@ProcessFactoryCode)) TbCF where (ISNULL(@ProcessFactoryCode,'')='' or TbCF.ProcessFactoryCode=@ProcessFactoryCode)	
Parameters:
@ProcessFactoryCode[String] = 6386683729561128960
@month[String] = 2020-03


-----------------------------------------------------------------------------
2020-03-27 18:30:29
Text:	 SELECT   TOP 1 [TbStorage].[StorageAdd],[TbStorage].[Tel],[TbUser].[UserName] FROM [TbStorage] LEFT OUTER JOIN [TbUser] ON ([TbStorage].[UserCode] = [TbUser].[UserCode])  WHERE [TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode858 	
Parameters:
@ProcessFactoryCode858[String] = 6386683729561128960


-----------------------------------------------------------------------------
2020-03-27 18:30:29
Text:	 SELECT   [TbDistributionPlanInfo].*,[TbCompany].[ParentCompanyCode],[TbOrderProgress].[FinishProcessingDateTime] FROM [TbDistributionPlanInfo] LEFT OUTER JOIN [TbCompany] ON ([TbDistributionPlanInfo].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbOrderProgress] ON ([TbDistributionPlanInfo].[OrderCode] = [TbOrderProgress].[OrderCode])  WHERE (([TbDistributionPlanInfo].[Examinestatus] = @Examinestatus859) AND ([TbDistributionPlanInfo].[ProcessFactoryCode] = @ProcessFactoryCode860)) 	
Parameters:
@Examinestatus859[String] = 审核完成
@ProcessFactoryCode860[String] = 6386683947165814784


-----------------------------------------------------------------------------
2020-03-27 18:30:29
Text:	select isnull(sum(TbCF.Capacity),0) as Capacity,isnull(sum(TbCF.WeightSmallPlan),0) as WeightSmallPlan,isnull(cast(sum(TbCF.WeightSmallPlan)/sum(TbCF.Capacity)*100 as decimal(18,2)),0) as ActualLoadNew from (select cf.Capacity,Tb1.WeightSmallPlan,cf.ProcessFactoryCode from TbCapacityFilling cf  
left join(
select SUM(Tb.WeightSmallPlan) as WeightSmallPlan,Tb.ProcessFactoryCode from (
                            select isnull(SUM(wod.WeightSmallPlan),0) as WeightSmallPlan,wo.ProcessFactoryCode from TbWorkOrder wo
                            left join TbWorkOrderDetail wod on wo.OrderCode=wod.OrderCode
                            where (ISNULL(@ProcessFactoryCode,'')='' or wo.ProcessFactoryCode=@ProcessFactoryCode)
                            and CONVERT(varchar(7), wo.DistributionTime, 120)=@month
                            and wod.RevokeStart='正常' and wo.ProcessingState!='ConfirmWork' and wo.ProcessingState!='Finishing'  group by wo.ProcessFactoryCode
                            union all
                            select isnull(sum(opd.NoCompleted),0) as NoCompleted,op.ProcessFactoryCode from TbOrderProgress op
                            left join TbOrderProgressDetail opd on op.OrderCode=opd.OrderCode 
                            where (ISNULL(@ProcessFactoryCode,'')='' or op.ProcessFactoryCode=@ProcessFactoryCode)
                            and CONVERT(varchar(7), op.DistributionTime, 120)=CONVERT(varchar(4),YEAR(DATEADD(MONTH,-1,@month+'-01')))+'-'+Right(100+Month(DATEADD(MONTH,-1,@month+'-01')),2)
                            and opd.RevokeStart='正常'  group by op.ProcessFactoryCode)Tb  group by Tb.ProcessFactoryCode
) Tb1 on cf.ProcessFactoryCode=Tb1.ProcessFactoryCode 
where cf.CapacityMonth=@month
and (ISNULL(@ProcessFactoryCode,'')='' or cf.ProcessFactoryCode=@ProcessFactoryCode)) TbCF where (ISNULL(@ProcessFactoryCode,'')='' or TbCF.ProcessFactoryCode=@ProcessFactoryCode)	
Parameters:
@ProcessFactoryCode[String] = 6386683947165814784
@month[String] = 2020-03


-----------------------------------------------------------------------------
2020-03-27 18:30:29
Text:	 SELECT   TOP 1 [TbStorage].[StorageAdd],[TbStorage].[Tel],[TbUser].[UserName] FROM [TbStorage] LEFT OUTER JOIN [TbUser] ON ([TbStorage].[UserCode] = [TbUser].[UserCode])  WHERE [TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode861 	
Parameters:
@ProcessFactoryCode861[String] = 6386683947165814784


-----------------------------------------------------------------------------
2020-03-27 18:30:31
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6337324142387400704','6352967650544590848') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-03-27 18:30:32
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6487716734823440384


-----------------------------------------------------------------------------
2020-03-27 18:30:32
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
left join TbFlowDefine d on p.FlowCode=d.FlowCode
where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
union all
select COUNT(1) as MsgCount from TbFlowPerformMessage m 
LEFT JOIN TbUser tu ON m.UserCode=tu.UserCode
where (m.usercode=@UserCode OR tu.UserId=@UserCode)and IsRead=-1
union all
select SUM(Tb.earlywarningcount) as earlywarningcount from (
select COUNT(1) as earlywarningcount from TbFlowEarlyWarningInfo where EarlyWarningBTUser=@UserCode and EarlyWarningStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)
union all
select COUNT(1) as earlywarningcount from TbFormEarlyWarningNodeInfo where EWUserCode=@UserCode and EWStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:30:32
Text:	SELECT MaterialName FROM TbRawMaterialArchives
                                GROUP BY MaterialName	


-----------------------------------------------------------------------------
2020-03-27 18:30:32
Text:	SELECT MaterialName FROM TbRawMaterialArchives
                                GROUP BY MaterialName	


-----------------------------------------------------------------------------
2020-03-27 18:30:32
Text:	select isnull(sum(TbCF.Capacity),0) as Capacity,isnull(sum(TbCF.WeightSmallPlan),0) as WeightSmallPlan,isnull(cast(sum(TbCF.WeightSmallPlan)/sum(TbCF.Capacity)*100 as decimal(18,2)),0) as ActualLoadNew from (select cf.Capacity,Tb1.WeightSmallPlan,cf.ProcessFactoryCode from TbCapacityFilling cf  
left join(
select SUM(Tb.WeightSmallPlan) as WeightSmallPlan,Tb.ProcessFactoryCode from (
                            select isnull(SUM(wod.WeightSmallPlan),0) as WeightSmallPlan,wo.ProcessFactoryCode from TbWorkOrder wo
                            left join TbWorkOrderDetail wod on wo.OrderCode=wod.OrderCode
                            where (ISNULL(@ProcessFactoryCode,'')='' or wo.ProcessFactoryCode=@ProcessFactoryCode)
                            and CONVERT(varchar(7), wo.DistributionTime, 120)=@month
                            and wod.RevokeStart='正常' and wo.ProcessingState!='ConfirmWork' and wo.ProcessingState!='Finishing'  group by wo.ProcessFactoryCode
                            union all
                            select isnull(sum(opd.NoCompleted),0) as NoCompleted,op.ProcessFactoryCode from TbOrderProgress op
                            left join TbOrderProgressDetail opd on op.OrderCode=opd.OrderCode 
                            where (ISNULL(@ProcessFactoryCode,'')='' or op.ProcessFactoryCode=@ProcessFactoryCode)
                            and CONVERT(varchar(7), op.DistributionTime, 120)=CONVERT(varchar(4),YEAR(DATEADD(MONTH,-1,@month+'-01')))+'-'+Right(100+Month(DATEADD(MONTH,-1,@month+'-01')),2)
                            and opd.RevokeStart='正常'  group by op.ProcessFactoryCode)Tb  group by Tb.ProcessFactoryCode
) Tb1 on cf.ProcessFactoryCode=Tb1.ProcessFactoryCode 
where cf.CapacityMonth=@month
and (ISNULL(@ProcessFactoryCode,'')='' or cf.ProcessFactoryCode=@ProcessFactoryCode)) TbCF where (ISNULL(@ProcessFactoryCode,'')='' or TbCF.ProcessFactoryCode=@ProcessFactoryCode)	
Parameters:
@ProcessFactoryCode[String] = 6386683729561128960
@month[String] = 2020-03


-----------------------------------------------------------------------------
2020-03-27 18:30:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:30:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:30:32
Text:	
                        select fewoi.DataCode as OddNumbers,
                         fewoi.EarlyWarningContent,
                         fewoi.EWFormDataCode,
                         CONVERT(varchar(100), fewoi.EarlyWarningTime, 120) as EarlyWarningTime,
                         EWFormCode,sm.MenuName,fn.FlowNodeName,cp1.CompanyFullName as BranchName,
                         cp2.CompanyFullName as WorkAreaName,cp3.CompanyFullName as SiteName,cp4.CompanyFullName as ProcessFactoryName,
                         u1.UserName as FlowSpUserName,u2.UserName as FlowYjUserName 
                        FROM (
                        select*
                           FROM ( 
                        		SELECT a.*, row_number()over(partition BY a.FlowCode ORDER BY a.FlowNodeCode,a.EarlyWarningTime desc) as group_idx 
                        		FROM TbFlowEarlyWarningOtherInfo  a
                        		INNER JOIN  TbFlowEarlyWarningInfo b ON a.FlowCode=b.FlowCode 
                        		AND a.EWFormDataCode=b.EWFormDataCode AND a.FlowNodeCode=b.FlowNodeCode 
                        		WHERE YEAR(a.EarlyWarningTime)= @Year and MONTH(a.EarlyWarningTime)= @Month AND b.EarlyWarningStart=0
                           ) ret
                        WHERE ret.group_idx =1
                        ) fewoi
                        left join TbFlowNode fn on fewoi.FlowCode=fn.FlowCode and fewoi.FlowNodeCode=fn.FlowNodeCode
                        left join TbSysMenu sm on fewoi.EWFormCode=sm.MenuCode
                        left join TbCompany cp1 on fewoi.BranchCode=cp1.CompanyCode
                        left join TbCompany cp2 on fewoi.WorkAreaCode=cp2.CompanyCode
                        left join TbCompany cp3 on fewoi.SiteCode=cp3.CompanyCode
                        left join TbCompany cp4 on fewoi.ProcessFactoryCode=cp4.CompanyCode
                        left join TbUser u1 on fewoi.FlowSpUserCode=u1.UserId
                        left join TbUser u2 on fewoi.FlowYjUserCode=u2.UserId where 1=1 and fewoi.ProjectId='6245721945602523136' and fewoi.ProcessFactoryCode='6386683729561128960' and (fewoi.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') or fewoi.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688')) ORDER BY fewoi.EarlyWarningTime desc	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:30:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:30:32
Text:	--配送超期
                           select dpi.OrderCode,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as ProcessFactoryName,dpi.DistributionTime,dpi.DeliveryCompleteTime,dpi.Remark from TbDistributionPlanInfo dpi
                           left join TbCompany cp1 on dpi.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on dpi.ProcessFactoryCode=cp2.CompanyCode
                           where YEAR(dpi.DistributionTime)= @Year and MONTH(dpi.DistributionTime)= @Month
                           and (dpi.DeliveryCompleteTime>dpi.DistributionTime or (GETDATE()>dpi.DistributionTime and dpi.DeliveryCompleteTime is null))  and dpi.ProjectId='6245721945602523136' and dpi.ProcessFactoryCode='6386683729561128960' and dpi.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') ORDER BY dpi.DistributionTime desc	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:30:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:30:32
Text:	select TbYj.*,cp1.CompanyFullName as SiteName,tcr.EnterSpaceTime,tcr.StartDischargeTime,tcr.EndDischargeTime,disEnt.ProcessFactoryCode,cp.CompanyFullName as ProcessFactoryName from (select min(EwTime) as EwTime,MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId from TbFormEarlyWarningNodeInfo where  MenuCode='SiteDischargeCargo' 
						   group by MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId) TbYj
						   left join TbTransportCarReport tcr on TbYj.EWFormDataCode=tcr.DisEntOrderId
                           left join TbDistributionEnt disEnt on tcr.DistributionCode=disEnt.DistributionCode
                           left join TbCompany cp on disEnt.ProcessFactoryCode=cp.CompanyCode
                           left join TbCompany cp1 on TbYj.SiteCode=cp1.CompanyCode
						   where YEAR(TbYj.EWTime)= @Year and MONTH(TbYj.EWTime)= @Month  and TbYj.ProjectId='6245721945602523136' and disEnt.ProcessFactoryCode='6386683729561128960' and TbYj.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') ORDER BY tcr.EnterSpaceTime desc	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:30:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:30:32
Text:	select TbYj.*,cp1.CompanyFullName as SiteName,sfs.DistributionCode,sdc.DistributionTime,sfs.SigninTime,sfs.ProcessFactoryCode,cp.CompanyFullName as ProcessFactoryName from (select min(EwTime) as EwTime,MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId from TbFormEarlyWarningNodeInfo where  MenuCode='SemiFinishedSign' 
						   group by MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId) TbYj
						   left join TbSemiFinishedSign sfs on TbYj.EWFormDataCode=sfs.ID
                           left join TbSiteDischargeCargo sdc on sfs.DistributionCode=sdc.DistributionCode and sfs.DischargeCargoCode=sdc.DischargeCargoCode
                           left join TbCompany cp on sfs.ProcessFactoryCode=cp.CompanyCode
                           left join TbCompany cp1 on TbYj.SiteCode=cp1.CompanyCode
						   where YEAR(TbYj.EWTime)= @Year and MONTH(TbYj.EWTime)= @Month and TbYj.ProjectId='6245721945602523136' and sfs.ProcessFactoryCode='6386683729561128960' and TbYj.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792')	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:30:32
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:30:32
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:30:32
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE ((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode866) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus867)) 	
Parameters:
@ProcessFactoryCode866[String] = 6386683729561128960
@Examinestatus867[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:30:32
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode868,@OrderCode869,@OrderCode870,@OrderCode871,@OrderCode872,@OrderCode873,@OrderCode874,@OrderCode875)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode868[String] = JGDD202000001
@OrderCode869[String] = JGDD202000002
@OrderCode870[String] = JGDD202000003
@OrderCode871[String] = JGDD202000004
@OrderCode872[String] = JGDD202000005
@OrderCode873[String] = JGDD202000006
@OrderCode874[String] = JGDD202000008
@OrderCode875[String] = JGDD202000009


-----------------------------------------------------------------------------
2020-03-27 18:30:32
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE (((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode862)) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState863,@ProcessingState864,@ProcessingState865))) 	
Parameters:
@ProcessFactoryCode862[String] = 6386683729561128960
@ProcessingState863[String] = Processing
@ProcessingState864[String] = Received
@ProcessingState865[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 18:30:32
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat876) 	
Parameters:
@DaetailWorkStrat876[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 18:30:33
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[OrderCode] IN (@OrderCode877,@OrderCode878,@OrderCode879,@OrderCode880,@OrderCode881,@OrderCode882,@OrderCode883,@OrderCode884,@OrderCode885,@OrderCode886,@OrderCode887)) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime888)))) 	
Parameters:
@OrderCode877[String] = JGDD202000001
@OrderCode878[String] = JGDD202000002
@OrderCode879[String] = JGDD202000003
@OrderCode880[String] = JGDD202000004
@OrderCode881[String] = JGDD202000005
@OrderCode882[String] = JGDD202000006
@OrderCode883[String] = JGDD202000008
@OrderCode884[String] = JGDD202000003
@OrderCode885[String] = JGDD202000004
@OrderCode886[String] = JGDD202000004
@OrderCode887[String] = JGDD202000004
@DistributionTime888[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 18:30:33
Text:	 SELECT   [TbDistributionPlanInfo].[DistributionStart] FROM [TbDistributionPlanInfo]  WHERE ([TbDistributionPlanInfo].[OrderCode] IN (@OrderCode889,@OrderCode890,@OrderCode891,@OrderCode892,@OrderCode893,@OrderCode894,@OrderCode895)) 	
Parameters:
@OrderCode889[String] = JGDD202000001
@OrderCode890[String] = JGDD202000002
@OrderCode891[String] = JGDD202000003
@OrderCode892[String] = JGDD202000004
@OrderCode893[String] = JGDD202000005
@OrderCode894[String] = JGDD202000006
@OrderCode895[String] = JGDD202000008


-----------------------------------------------------------------------------
2020-03-27 18:30:33
Text:	 SELECT   [TbDistributionEntOrder].* FROM [TbDistributionEntOrder] LEFT OUTER JOIN [TbDistributionEnt] ON ([TbDistributionEntOrder].[DistributionCode] = [TbDistributionEnt].[DistributionCode])  WHERE ([TbDistributionEntOrder].[OrderCode] IN (@OrderCode896,@OrderCode897,@OrderCode898,@OrderCode899,@OrderCode900,@OrderCode901,@OrderCode902)) 	
Parameters:
@OrderCode896[String] = JGDD202000001
@OrderCode897[String] = JGDD202000002
@OrderCode898[String] = JGDD202000003
@OrderCode899[String] = JGDD202000004
@OrderCode900[String] = JGDD202000005
@OrderCode901[String] = JGDD202000006
@OrderCode902[String] = JGDD202000008


-----------------------------------------------------------------------------
2020-03-27 18:30:33
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE ((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode903) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus904)) 	
Parameters:
@ProcessFactoryCode903[String] = 6386683729561128960
@Examinestatus904[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:30:33
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode905,@OrderCode906,@OrderCode907,@OrderCode908,@OrderCode909,@OrderCode910,@OrderCode911,@OrderCode912)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode905[String] = JGDD202000001
@OrderCode906[String] = JGDD202000002
@OrderCode907[String] = JGDD202000003
@OrderCode908[String] = JGDD202000004
@OrderCode909[String] = JGDD202000005
@OrderCode910[String] = JGDD202000006
@OrderCode911[String] = JGDD202000008
@OrderCode912[String] = JGDD202000009


-----------------------------------------------------------------------------
2020-03-27 18:30:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:30:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:30:33
Text:	--原材料供货超时
                           select BatchPlanNum,cp1.CompanyFullName as BranchName,cp2.CompanyFullName as WorkAreaName,cp3.CompanyFullName as SiteName,cp4.CompanyFullName as ProcessFactoryName,sup.SupplyDate,sup.SupplyCompleteTime,sup.ProjectId,sup.Remarks from TbSupplyList sup
                           left join TbCompany cp1 on cp1.CompanyCode=sup.BranchCode
                           left join TbCompany cp2 on cp2.CompanyCode=sup.WorkAreaCode
                           left join TbCompany cp3 on cp3.CompanyCode=sup.SiteCode
                           left join TbCompany cp4 on cp4.CompanyCode=sup.ProcessFactoryCode
                           where YEAR(sup.SupplyDate)= @Year and MONTH(sup.SupplyDate)= @Month
                           and (sup.SupplyCompleteTime>sup.SupplyDate or (GETDATE()>sup.SupplyDate and sup.SupplyCompleteTime is null))  and sup.ProjectId='6245721945602523136' and sup.ProcessFactoryCode='6386683729561128960' and (sup.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') or sup.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688'))	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:30:33
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:30:33
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:30:33
Text:	 SELECT   [TbOrderProgress].[ProcessingState],[TbOrderProgress].[FinishProcessingDateTime],[TbOrderProgress].[DistributionTime],[TbOrderProgress].[SiteCode] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[SiteCode] IN (@SiteCode913,@SiteCode914,@SiteCode915,@SiteCode916,@SiteCode917,@SiteCode918,@SiteCode919,@SiteCode920,@SiteCode921,@SiteCode922,@SiteCode923,@SiteCode924,@SiteCode925,@SiteCode926,@SiteCode927,@SiteCode928,@SiteCode929,@SiteCode930,@SiteCode931,@SiteCode932,@SiteCode933,@SiteCode934,@SiteCode935,@SiteCode936,@SiteCode937,@SiteCode938,@SiteCode939,@SiteCode940,@SiteCode941,@SiteCode942,@SiteCode943,@SiteCode944,@SiteCode945,@SiteCode946,@SiteCode947,@SiteCode948,@SiteCode949,@SiteCode950,@SiteCode951,@SiteCode952,@SiteCode953,@SiteCode954,@SiteCode955,@SiteCode956,@SiteCode957,@SiteCode958,@SiteCode959,@SiteCode960,@SiteCode961,@SiteCode962,@SiteCode963,@SiteCode964,@SiteCode965,@SiteCode966,@SiteCode967,@SiteCode968,@SiteCode969,@SiteCode970,@SiteCode971,@SiteCode972,@SiteCode973,@SiteCode974,@SiteCode975,@SiteCode976,@SiteCode977,@SiteCode978,@SiteCode979,@SiteCode980,@SiteCode981,@SiteCode982,@SiteCode983)) AND (YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=3)) 	
Parameters:
@SiteCode913[String] = 6274027775095472128
@SiteCode914[String] = 6274027929433276416
@SiteCode915[String] = 6417410523612188672
@SiteCode916[String] = 6274028333340557312
@SiteCode917[String] = 6274028829845487616
@SiteCode918[String] = 6274029086029381632
@SiteCode919[String] = 6274029528142577664
@SiteCode920[String] = 6274029966388625408
@SiteCode921[String] = 6274030152053686272
@SiteCode922[String] = 6274030373047369728
@SiteCode923[String] = 6274030913332445184
@SiteCode924[String] = 6267789807737372672
@SiteCode925[String] = 6267790255894560768
@SiteCode926[String] = 6267790460492709888
@SiteCode927[String] = 6267790574804271104
@SiteCode928[String] = 6267791036517449728
@SiteCode929[String] = 6267791338536697856
@SiteCode930[String] = 6267791654132908032
@SiteCode931[String] = 6267790081113718784
@SiteCode932[String] = 6267790783294734336
@SiteCode933[String] = 6267791210027417600
@SiteCode934[String] = 6267791528110850048
@SiteCode935[String] = 6437059801301262336
@SiteCode936[String] = 6308426901824208896
@SiteCode937[String] = 6276140742482067456
@SiteCode938[String] = 6276141050964738048
@SiteCode939[String] = 6276141450283450368
@SiteCode940[String] = 6276141737463250944
@SiteCode941[String] = 6276141926932545536
@SiteCode942[String] = 6267796592825204736
@SiteCode943[String] = 6267796864196673536
@SiteCode944[String] = 6267797037211713536
@SiteCode945[String] = 6267797181319610368
@SiteCode946[String] = 6276760608893304832
@SiteCode947[String] = 6267798187931598848
@SiteCode948[String] = 6267798388054425600
@SiteCode949[String] = 6267749616851091456
@SiteCode950[String] = 6267750471750909952
@SiteCode951[String] = 6267750709144322048
@SiteCode952[String] = 6267750895786655744
@SiteCode953[String] = 6267751010588950528
@SiteCode954[String] = 6267753037104676864
@SiteCode955[String] = 6267754200801738752
@SiteCode956[String] = 6267754324688896000
@SiteCode957[String] = 6267797518566817792
@SiteCode958[String] = 6267783175129268224
@SiteCode959[String] = 6267783320914886656
@SiteCode960[String] = 6267783444885929984
@SiteCode961[String] = 6267783577954418688
@SiteCode962[String] = 6267784612617912320
@SiteCode963[String] = 6267785016667799552
@SiteCode964[String] = 6267785185136214016
@SiteCode965[String] = 6267785381991677952
@SiteCode966[String] = 6267785590951903232
@SiteCode967[String] = 6267785762842869760
@SiteCode968[String] = 6267793585479876608
@SiteCode969[String] = 6267793380881727488
@SiteCode970[String] = 6437060915425845248
@SiteCode971[String] = 6284878460246556672
@SiteCode972[String] = 6284879065547538432
@SiteCode973[String] = 6285119541664022528
@SiteCode974[String] = 6285120302351384576
@SiteCode975[String] = 6285181647230861312
@SiteCode976[String] = 6285120520983674880
@SiteCode977[String] = 6285120866493661184
@SiteCode978[String] = 6285121357168508928
@SiteCode979[String] = 6285122203776188416
@SiteCode980[String] = 6437059163368595456
@SiteCode981[String] = 6374383547544903680
@SiteCode982[String] = 6374384032955899904
@SiteCode983[String] = 6374384202665828352


-----------------------------------------------------------------------------
2020-03-27 18:30:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:30:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:30:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:30:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:30:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:30:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:30:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:30:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:30:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:30:34
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:30:34
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:30:34
Text:	SELECT 
                            '审批超时' as YjTypeName,COUNT(1) as YjNum
                            FROM (
									SELECT a.*, row_number()over(partition BY a.FlowCode ORDER BY a.FlowNodeCode,a.EarlyWarningTime desc) as group_idx 
									FROM TbFlowEarlyWarningOtherInfo  a
									INNER JOIN  TbFlowEarlyWarningInfo b ON a.FlowCode=b.FlowCode 
									AND a.EWFormDataCode=b.EWFormDataCode AND a.FlowNodeCode=b.FlowNodeCode 
									WHERE  b.EarlyWarningStart=0 AND YEAR(a.EarlyWarningTime)= @Year and MONTH(a.EarlyWarningTime)= @Month  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and (a.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') or a.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688'))
							   ) Tb1
                            WHERE Tb1.group_idx =1
                           union all
                            select '未报月度需求计划' as YjTypeName,COUNT(1)as YjNum
                             FROM ( 
                                  SELECT *, row_number()over(partition BY EarlyWarningCode,EWFormDataCode ORDER BY EWNodeCode,EWTime desc) as group_idx 
                                  FROM TbFormEarlyWarningNodeInfo fwqi
                                  WHERE fwqi.MenuCode='RawMonthDemandPlan' AND fwqi.EWStart=0 AND YEAR(fwqi.EWTime)= @Year and MONTH(fwqi.EWTime)= @Month  and fwqi.ProjectId='6245721945602523136' and (fwqi.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') or fwqi.WorkArea in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688'))  
                             ) Tb2
                             WHERE Tb2.group_idx =1
                           union all
                           select '原材料供货超时' as YjTypeName,COUNT(1) as YjNum from (
                           select BatchPlanNum,cp1.CompanyFullName as BranchName,cp2.CompanyFullName as WorkAreaName,cp3.CompanyFullName as SiteName,cp4.CompanyFullName as ProcessFactoryName,sup.SupplyDate,sup.SupplyCompleteTime,sup.ProjectId from TbSupplyList sup
                           left join TbCompany cp1 on cp1.CompanyCode=sup.BranchCode
                           left join TbCompany cp2 on cp2.CompanyCode=sup.WorkAreaCode
                           left join TbCompany cp3 on cp3.CompanyCode=sup.SiteCode
                           left join TbCompany cp4 on cp4.CompanyCode=sup.ProcessFactoryCode
                           where (sup.SupplyCompleteTime>sup.SupplyDate or (GETDATE()>sup.SupplyDate and sup.SupplyCompleteTime is null))
						   and YEAR(sup.SupplyDate)= @Year and MONTH(sup.SupplyDate)= @Month  and sup.ProjectId='6245721945602523136' and sup.ProcessFactoryCode='6386683729561128960' and (sup.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') or sup.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688'))) Tb3
                           union all
                           select '加急订单' as YjTypeName,COUNT(1) as YjNum from (--加急订单个数
                           select wo.OrderCode,wo.DistributionTime,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as ProcessFactoryName from TbWorkOrder wo
                           left join TbCompany cp1 on wo.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on wo.ProcessFactoryCode=cp2.CompanyCode
                           where UrgentDegree='Urgent' 
						   and YEAR(wo.DistributionTime)= @Year and MONTH(wo.DistributionTime)= @Month  and wo.ProjectId='6245721945602523136' and wo.ProcessFactoryCode='6386683729561128960' and wo.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') ) Tb4
                           union all
                           select '加工进度滞后' as YjTypeName,COUNT(1) as YjNum from (--加工进度滞后
                           select op.OrderCode,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as ProcessFactoryName,op.DistributionTime,op.FinishProcessingDateTime from TbOrderProgress op 
                           left join TbCompany cp1 on op.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on op.ProcessFactoryCode=cp2.CompanyCode
                           where YEAR(op.DistributionTime)= @Year and MONTH(op.DistributionTime)= @Month
                           and (op.FinishProcessingDateTime>op.DistributionTime or (GETDATE()>op.DistributionTime and op.FinishProcessingDateTime is null))  and op.ProjectId='6245721945602523136' and op.ProcessFactoryCode='6386683729561128960' and op.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') ) Tb5
                           union all
                           select '接收配送超期' as YjTypeName,COUNT(1) as YjNum from (--配送超期
                           select dpi.OrderCode,cp1.CompanyFullName as SIteName,cp2.CompanyFullName as ProcessFactoryName,dpi.DistributionTime,dpi.DeliveryCompleteTime from TbDistributionPlanInfo dpi
                           left join TbCompany cp1 on dpi.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on dpi.ProcessFactoryCode=cp2.CompanyCode
                           where YEAR(dpi.DistributionTime)= @Year and MONTH(dpi.DistributionTime)= @Month
                           and (dpi.DeliveryCompleteTime>dpi.DistributionTime or (GETDATE()>dpi.DistributionTime and dpi.DeliveryCompleteTime is null))  and dpi.ProjectId='6245721945602523136' and dpi.ProcessFactoryCode='6386683729561128960' and dpi.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') ) Tb6 
                           union all
                           select '卸货超时' as YjTypeName,COUNT(1) as YjNum from(--卸货超时
                           select TbYj.*,cp1.CompanyFullName as SiteName,tcr.EnterSpaceTime,tcr.StartDischargeTime,tcr.EndDischargeTime,disEnt.ProcessFactoryCode,cp.CompanyFullName as ProcessFactoryName from (select min(EwTime) as EwTime,MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId from TbFormEarlyWarningNodeInfo where  MenuCode='SiteDischargeCargo' 
						   group by MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId) TbYj
						   left join TbTransportCarReport tcr on TbYj.EWFormDataCode=tcr.DisEntOrderId
                           left join TbDistributionEnt disEnt on tcr.DistributionCode=disEnt.DistributionCode
                           left join TbCompany cp on disEnt.ProcessFactoryCode=cp.CompanyCode
                           left join TbCompany cp1 on TbYj.SiteCode=cp1.CompanyCode
						   where YEAR(TbYj.EWTime)= @Year and MONTH(TbYj.EWTime)= @Month  and TbYj.ProjectId='6245721945602523136' and disEnt.ProcessFactoryCode='6386683729561128960' and TbYj.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') ) Tb7
                           union all
                           select '签收超时' as YjTypeName,COUNT(1) as YjNum from (select TbYj.*,cp1.CompanyFullName as SiteName,sfs.DistributionCode,sdc.DistributionTime,sfs.SigninTime,sfs.ProcessFactoryCode,cp.CompanyFullName as ProcessFactoryName from (select min(EwTime) as EwTime,MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId from TbFormEarlyWarningNodeInfo where  MenuCode='SemiFinishedSign' 
						   group by MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId) TbYj
						   left join TbSemiFinishedSign sfs on TbYj.EWFormDataCode=sfs.ID
                           left join TbSiteDischargeCargo sdc on sfs.DistributionCode=sdc.DistributionCode and sfs.DischargeCargoCode=sdc.DischargeCargoCode
                           left join TbCompany cp on sfs.ProcessFactoryCode=cp.CompanyCode
                           left join TbCompany cp1 on TbYj.SiteCode=cp1.CompanyCode
						   where YEAR(TbYj.EWTime)= @Year and MONTH(TbYj.EWTime)= @Month  and TbYj.ProjectId='6245721945602523136' and sfs.ProcessFactoryCode='6386683729561128960' and TbYj.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') ) Tb8	
Parameters:
@Year[String] = 2020
@Month[String] = 03


-----------------------------------------------------------------------------
2020-03-27 18:30:34
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:30:34
Text:	--加工进度滞后
                           select op.OrderCode,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as ProcessFactoryName,op.DistributionTime,op.FinishProcessingDateTime from TbOrderProgress op 
                           left join TbCompany cp1 on op.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on op.ProcessFactoryCode=cp2.CompanyCode
                           where YEAR(op.DistributionTime)= @Year and MONTH(op.DistributionTime)= @Month
                           and (op.FinishProcessingDateTime>op.DistributionTime or (GETDATE()>op.DistributionTime and op.FinishProcessingDateTime is null))  and op.ProjectId='6245721945602523136' and op.ProcessFactoryCode='6386683729561128960' and op.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') ORDER BY op.DistributionTime desc	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:30:34
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE ((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode985) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus986)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode985[String] = 6386683729561128960
@Examinestatus986[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:30:34
Text:	 SELECT   * FROM [TbRawMaterialMonthDemandSupplyPlan]  WHERE [TbRawMaterialMonthDemandSupplyPlan].[DemandPlanCode] IN (@DemandPlanCode987,@DemandPlanCode988,@DemandPlanCode989,@DemandPlanCode990,@DemandPlanCode991,@DemandPlanCode992,@DemandPlanCode993,@DemandPlanCode994,@DemandPlanCode995) 	
Parameters:
@DemandPlanCode987[String] = XQJH202000002
@DemandPlanCode988[String] = XQJH202000003
@DemandPlanCode989[String] = XQJH202000004
@DemandPlanCode990[String] = XQJH202000005
@DemandPlanCode991[String] = XQJH202000006
@DemandPlanCode992[String] = XQJH202000007
@DemandPlanCode993[String] = XQJH202000008
@DemandPlanCode994[String] = XQJH202000009
@DemandPlanCode995[String] = XQJH202000010


-----------------------------------------------------------------------------
2020-03-27 18:30:34
Text:	 SELECT   [TbFactoryBatchNeedPlan].[RawMaterialDemandNum] AS [DemandPlanCode],[TbFactoryBatchNeedPlan].[BatchPlanNum],[TbFactoryBatchNeedPlan].[SteelsTypeCode] AS [RebarType],[TbFactoryBatchNeedPlan].[BatchPlanTotal] AS [TotalWeight] FROM [TbFactoryBatchNeedPlan]  WHERE (([TbFactoryBatchNeedPlan].[Examinestatus] = @Examinestatus996) AND ([TbFactoryBatchNeedPlan].[RawMaterialDemandNum] IN (@RawMaterialDemandNum997,@RawMaterialDemandNum998,@RawMaterialDemandNum999,@RawMaterialDemandNum1000,@RawMaterialDemandNum1001,@RawMaterialDemandNum1002,@RawMaterialDemandNum1003,@RawMaterialDemandNum1004,@RawMaterialDemandNum1005,@RawMaterialDemandNum1006,@RawMaterialDemandNum1007,@RawMaterialDemandNum1008,@RawMaterialDemandNum1009,@RawMaterialDemandNum1010,@RawMaterialDemandNum1011,@RawMaterialDemandNum1012,@RawMaterialDemandNum1013))) 	
Parameters:
@Examinestatus996[String] = 审核完成
@RawMaterialDemandNum997[String] = XQJH202000002
@RawMaterialDemandNum998[String] = XQJH202000003
@RawMaterialDemandNum999[String] = XQJH202000004
@RawMaterialDemandNum1000[String] = XQJH202000005
@RawMaterialDemandNum1001[String] = XQJH202000006
@RawMaterialDemandNum1002[String] = XQJH202000007
@RawMaterialDemandNum1003[String] = XQJH202000008
@RawMaterialDemandNum1004[String] = XQJH202000009
@RawMaterialDemandNum1005[String] = XQJH202000010
@RawMaterialDemandNum1006[String] = BCJH202000002
@RawMaterialDemandNum1007[String] = BCJH202000003
@RawMaterialDemandNum1008[String] = BCJH202000004
@RawMaterialDemandNum1009[String] = BCJH202000005
@RawMaterialDemandNum1010[String] = BCJH202000006
@RawMaterialDemandNum1011[String] = BCJH202000007
@RawMaterialDemandNum1012[String] = BCJH202000009
@RawMaterialDemandNum1013[String] = BCJH202000008


-----------------------------------------------------------------------------
2020-03-27 18:30:34
Text:	 SELECT   [TbSupplyList].[SteelsTypeCode] AS [RebarType],[TbSupplyList].[HasSupplierTotal] AS [TotalWeight] FROM [TbSupplyList]  WHERE (([TbSupplyList].[StateCode] <> @StateCode984) AND ([TbSupplyList].[BatchPlanNum] IN (@BatchPlanNum1014,@BatchPlanNum1015,@BatchPlanNum1016,@BatchPlanNum1017,@BatchPlanNum1018,@BatchPlanNum1019))) 	
Parameters:
@StateCode984[String] = 未供货
@BatchPlanNum1014[String] = PCJH202000002
@BatchPlanNum1015[String] = PCJH202000003
@BatchPlanNum1016[String] = PCJH202000004
@BatchPlanNum1017[String] = PCJH202000005
@BatchPlanNum1018[String] = PCJH202000006
@BatchPlanNum1019[String] = PCJH202000007


-----------------------------------------------------------------------------
2020-03-27 18:30:34
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE ((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode1020) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus1021)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode1020[String] = 6386683729561128960
@Examinestatus1021[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:30:34
Text:	 SELECT   * FROM [TbRawMaterialMonthDemandSupplyPlan]  WHERE [TbRawMaterialMonthDemandSupplyPlan].[DemandPlanCode] IN (@DemandPlanCode1022,@DemandPlanCode1023,@DemandPlanCode1024,@DemandPlanCode1025,@DemandPlanCode1026,@DemandPlanCode1027,@DemandPlanCode1028,@DemandPlanCode1029,@DemandPlanCode1030) 	
Parameters:
@DemandPlanCode1022[String] = XQJH202000002
@DemandPlanCode1023[String] = XQJH202000003
@DemandPlanCode1024[String] = XQJH202000004
@DemandPlanCode1025[String] = XQJH202000005
@DemandPlanCode1026[String] = XQJH202000006
@DemandPlanCode1027[String] = XQJH202000007
@DemandPlanCode1028[String] = XQJH202000008
@DemandPlanCode1029[String] = XQJH202000009
@DemandPlanCode1030[String] = XQJH202000010


-----------------------------------------------------------------------------
2020-03-27 18:30:34
Text:	 SELECT   [TbFactoryBatchNeedPlan].[RawMaterialDemandNum] AS [DemandPlanCode],[TbFactoryBatchNeedPlan].[BatchPlanNum],[TbFactoryBatchNeedPlan].[SteelsTypeCode] AS [RebarType],[TbFactoryBatchNeedPlan].[BatchPlanTotal] AS [TotalWeight] FROM [TbFactoryBatchNeedPlan]  WHERE (([TbFactoryBatchNeedPlan].[Examinestatus] = @Examinestatus1031) AND ([TbFactoryBatchNeedPlan].[RawMaterialDemandNum] IN (@RawMaterialDemandNum1032,@RawMaterialDemandNum1033,@RawMaterialDemandNum1034,@RawMaterialDemandNum1035,@RawMaterialDemandNum1036,@RawMaterialDemandNum1037,@RawMaterialDemandNum1038,@RawMaterialDemandNum1039,@RawMaterialDemandNum1040))) 	
Parameters:
@Examinestatus1031[String] = 审核完成
@RawMaterialDemandNum1032[String] = XQJH202000002
@RawMaterialDemandNum1033[String] = XQJH202000003
@RawMaterialDemandNum1034[String] = XQJH202000004
@RawMaterialDemandNum1035[String] = XQJH202000005
@RawMaterialDemandNum1036[String] = XQJH202000006
@RawMaterialDemandNum1037[String] = XQJH202000007
@RawMaterialDemandNum1038[String] = XQJH202000008
@RawMaterialDemandNum1039[String] = XQJH202000009
@RawMaterialDemandNum1040[String] = XQJH202000010


-----------------------------------------------------------------------------
2020-03-27 18:30:34
Text:	select * from (select cp2.CompanyCode,cp2.CompanyFullName from (select SiteCode from TbWorkOrder where 
            (CONVERT(varchar(7) ,InsertTime, 120)='2020-02' or CONVERT(varchar(7) ,InsertTime, 120)='2020-01' or CONVERT(varchar(7) ,InsertTime, 120)='2020-03') and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId) and (ISNULL(@ProcessFactoryCode,'')='' or ProcessFactoryCode=@ProcessFactoryCode)
            group by SiteCode) TbWO
            left join TbCompany cp on TBWO.SiteCode=cp.CompanyCode
            left join TbCompany cp2 on cp2.CompanyCode=cp.ParentCompanyCode
            group by cp2.CompanyCode,cp2.CompanyFullName
            union all
            select rmdp.WorkAreaCode,cp.CompanyFullName
            from TbRawMaterialMonthDemandPlan rmdp
            left join TbCompany cp on cp.CompanyCode=rmdp.WorkAreaCode
            where (rmdp.DemandMonth='2020-02' or rmdp.DemandMonth='2020-01' or rmdp.DemandMonth='2020-03') and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId) and (ISNULL(@ProcessFactoryCode,'')='' or ProcessFactoryCode=@ProcessFactoryCode)) TbGq group by TbGq.CompanyCode,TbGq.CompanyFullName	
Parameters:
@ProjectId[String] = 6245721945602523136
@ProcessFactoryCode[String] = 6386683729561128960


-----------------------------------------------------------------------------
2020-03-27 18:30:34
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:30:34
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:30:34
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE ((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode1041) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus1042)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode1041[String] = 6386683729561128960
@Examinestatus1042[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:30:34
Text:	 SELECT   * FROM [TbRawMaterialMonthDemandSupplyPlan]  WHERE [TbRawMaterialMonthDemandSupplyPlan].[DemandPlanCode] IN (@DemandPlanCode1043,@DemandPlanCode1044,@DemandPlanCode1045,@DemandPlanCode1046,@DemandPlanCode1047,@DemandPlanCode1048,@DemandPlanCode1049,@DemandPlanCode1050,@DemandPlanCode1051) 	
Parameters:
@DemandPlanCode1043[String] = XQJH202000002
@DemandPlanCode1044[String] = XQJH202000003
@DemandPlanCode1045[String] = XQJH202000004
@DemandPlanCode1046[String] = XQJH202000005
@DemandPlanCode1047[String] = XQJH202000006
@DemandPlanCode1048[String] = XQJH202000007
@DemandPlanCode1049[String] = XQJH202000008
@DemandPlanCode1050[String] = XQJH202000009
@DemandPlanCode1051[String] = XQJH202000010


-----------------------------------------------------------------------------
2020-03-27 18:30:34
Text:	 SELECT   [TbSupplyList].[BatchPlanTotal],[TbSupplyList].[HasSupplierTotal],[TbSupplyList].[StateCode],[TbSupplyList].[SteelsTypeCode],[TbSupplyList].[SupplyCompleteTime],[TbSupplyList].[SupplyDate] FROM [TbSupplyList]  WHERE ([TbSupplyList].[RawMaterialDemandNum] IN (@RawMaterialDemandNum1052,@RawMaterialDemandNum1053,@RawMaterialDemandNum1054,@RawMaterialDemandNum1055,@RawMaterialDemandNum1056,@RawMaterialDemandNum1057,@RawMaterialDemandNum1058,@RawMaterialDemandNum1059,@RawMaterialDemandNum1060,@RawMaterialDemandNum1061,@RawMaterialDemandNum1062,@RawMaterialDemandNum1063,@RawMaterialDemandNum1064,@RawMaterialDemandNum1065,@RawMaterialDemandNum1066,@RawMaterialDemandNum1067,@RawMaterialDemandNum1068)) 	
Parameters:
@RawMaterialDemandNum1052[String] = XQJH202000002
@RawMaterialDemandNum1053[String] = XQJH202000003
@RawMaterialDemandNum1054[String] = XQJH202000004
@RawMaterialDemandNum1055[String] = XQJH202000005
@RawMaterialDemandNum1056[String] = XQJH202000006
@RawMaterialDemandNum1057[String] = XQJH202000007
@RawMaterialDemandNum1058[String] = XQJH202000008
@RawMaterialDemandNum1059[String] = XQJH202000009
@RawMaterialDemandNum1060[String] = XQJH202000010
@RawMaterialDemandNum1061[String] = BCJH202000002
@RawMaterialDemandNum1062[String] = BCJH202000003
@RawMaterialDemandNum1063[String] = BCJH202000004
@RawMaterialDemandNum1064[String] = BCJH202000005
@RawMaterialDemandNum1065[String] = BCJH202000006
@RawMaterialDemandNum1066[String] = BCJH202000007
@RawMaterialDemandNum1067[String] = BCJH202000009
@RawMaterialDemandNum1068[String] = BCJH202000008


-----------------------------------------------------------------------------
2020-03-27 18:30:35
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:30:35
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:30:35
Text:	SELECT sm.MenuName,fwqi.EWContent,fwqi.EWUserCode,u.UserName,fwqi.EWFormDataCode,cp1.CompanyFullName as  FbName,cp2.CompanyFullName as GqName,fwqi.EWTime,sdd.DictionaryText as RebarType  
                   FROM (  
                    select ret.*
                    FROM ( 
                         SELECT *, row_number()over(partition BY EarlyWarningCode,EWFormDataCode ORDER BY EWNodeCode,EWTime desc) as group_idx 
                         FROM TbFormEarlyWarningNodeInfo fwqi
                         WHERE YEAR(fwqi.EWTime)= @Year and MONTH(fwqi.EWTime)= @Month AND fwqi.MenuCode='RawMonthDemandPlan' AND fwqi.EWStart=0
                    ) ret
                    WHERE ret.group_idx = 1
                   ) fwqi
                    left join TbSysMenu sm on fwqi.MenuCode=sm.MenuCode
                            left join TbCompany cp1 on fwqi.CompanyCode=cp1.CompanyCode
                            left join TbCompany cp2 on fwqi.WorkArea=cp2.CompanyCode
                            left join TbCompany cp3 on fwqi.SiteCode=cp3.CompanyCode
                            left join TbUser u on fwqi.EWUserCode=u.UserId
                            left join TbRawMaterialMonthDemandPlan rmp on fwqi.EWFormDataCode=rmp.ID
                            left join TbSysDictionaryData sdd on sdd.DictionaryCode=rmp.RebarType
                    where 1=1 and fwqi.ProjectId='6245721945602523136' and (fwqi.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') or fwqi.WorkArea in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688')) ORDER BY fwqi.EWTime DESC	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:30:35
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE ((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode1073) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus1074)) 	
Parameters:
@ProcessFactoryCode1073[String] = 6386683729561128960
@Examinestatus1074[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:30:35
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode1075,@OrderCode1076,@OrderCode1077,@OrderCode1078,@OrderCode1079,@OrderCode1080,@OrderCode1081,@OrderCode1082)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode1075[String] = JGDD202000001
@OrderCode1076[String] = JGDD202000002
@OrderCode1077[String] = JGDD202000003
@OrderCode1078[String] = JGDD202000004
@OrderCode1079[String] = JGDD202000005
@OrderCode1080[String] = JGDD202000006
@OrderCode1081[String] = JGDD202000008
@OrderCode1082[String] = JGDD202000009


-----------------------------------------------------------------------------
2020-03-27 18:30:35
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE (((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode1069)) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState1070,@ProcessingState1071,@ProcessingState1072))) 	
Parameters:
@ProcessFactoryCode1069[String] = 6386683729561128960
@ProcessingState1070[String] = Processing
@ProcessingState1071[String] = Received
@ProcessingState1072[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 18:30:35
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat1083) 	
Parameters:
@DaetailWorkStrat1083[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 18:30:35
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[OrderCode] IN (@OrderCode1084,@OrderCode1085,@OrderCode1086,@OrderCode1087,@OrderCode1088,@OrderCode1089,@OrderCode1090,@OrderCode1091,@OrderCode1092,@OrderCode1093,@OrderCode1094)) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime1095)))) 	
Parameters:
@OrderCode1084[String] = JGDD202000001
@OrderCode1085[String] = JGDD202000002
@OrderCode1086[String] = JGDD202000003
@OrderCode1087[String] = JGDD202000004
@OrderCode1088[String] = JGDD202000005
@OrderCode1089[String] = JGDD202000006
@OrderCode1090[String] = JGDD202000008
@OrderCode1091[String] = JGDD202000003
@OrderCode1092[String] = JGDD202000004
@OrderCode1093[String] = JGDD202000004
@OrderCode1094[String] = JGDD202000004
@DistributionTime1095[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 18:30:35
Text:	 SELECT count(*) as r_cnt FROM [TbDistributionPlanInfo] WHERE (([TbDistributionPlanInfo].[OrderCode] IN (@OrderCode1096,@OrderCode1097,@OrderCode1098,@OrderCode1099,@OrderCode1100,@OrderCode1101,@OrderCode1102)) AND ((DistributionStart='配送完成' and DATEPART(day,DeliveryCompleteTime)>DATEPART(day,DistributionTime)) or (DistributionStart='未配送' and DistributionTime>GETDATE())))	
Parameters:
@OrderCode1096[String] = JGDD202000001
@OrderCode1097[String] = JGDD202000002
@OrderCode1098[String] = JGDD202000003
@OrderCode1099[String] = JGDD202000004
@OrderCode1100[String] = JGDD202000005
@OrderCode1101[String] = JGDD202000006
@OrderCode1102[String] = JGDD202000008


-----------------------------------------------------------------------------
2020-03-27 18:30:35
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:30:35
Text:	--加急订单个数
                           select wo.OrderCode,wo.DistributionTime,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as ProcessFactoryName from TbWorkOrder wo
                           left join TbCompany cp1 on wo.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on wo.ProcessFactoryCode=cp2.CompanyCode
                           where UrgentDegree='Urgent'
                           and YEAR(wo.DistributionTime)= @Year and MONTH(wo.DistributionTime)= @Month  and wo.ProjectId='6245721945602523136' and wo.ProcessFactoryCode='6386683729561128960' and wo.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792')  ORDER BY wo.DistributionTime desc	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:30:35
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE (([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode1103) AND ([TbRawMaterialArchives].[RebarType] = @RebarType1104)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode1103[String] = 6386683729561128960
@RebarType1104[String] = BuildingSteel


-----------------------------------------------------------------------------
2020-03-27 18:30:35
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE (([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode1105) AND ([TbRawMaterialArchives].[RebarType] = @RebarType1106)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode1105[String] = 6386683729561128960
@RebarType1106[String] = SectionSteel


-----------------------------------------------------------------------------
2020-03-27 18:30:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025879437836288
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:30:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025879437836288
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:30:43
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode1115) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode1116,@SiteCode1117,@SiteCode1118,@SiteCode1119))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus1120)) 	
Parameters:
@ProcessFactoryCode1115[String] = 6386683729561128960
@SiteCode1116[String] = 6274027775095472128
@SiteCode1117[String] = 6274027929433276416
@SiteCode1118[String] = 6274028333340557312
@SiteCode1119[String] = 6417410523612188672
@Examinestatus1120[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:30:43
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode1121)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode1121[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:30:43
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE ((((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode1107)) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode1108,@SiteCode1109,@SiteCode1110,@SiteCode1111))) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState1112,@ProcessingState1113,@ProcessingState1114))) 	
Parameters:
@ProcessFactoryCode1107[String] = 6386683729561128960
@SiteCode1108[String] = 6274027775095472128
@SiteCode1109[String] = 6274027929433276416
@SiteCode1110[String] = 6274028333340557312
@SiteCode1111[String] = 6417410523612188672
@ProcessingState1112[String] = Processing
@ProcessingState1113[String] = Received
@ProcessingState1114[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 18:30:43
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat1122) 	
Parameters:
@DaetailWorkStrat1122[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 18:30:43
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[OrderCode] IN (@OrderCode1123)) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime1124)))) 	
Parameters:
@OrderCode1123[String] = JGDD202000001
@DistributionTime1124[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 18:30:43
Text:	 SELECT   [TbDistributionPlanInfo].[DistributionStart] FROM [TbDistributionPlanInfo]  WHERE ([TbDistributionPlanInfo].[OrderCode] IN (@OrderCode1125)) 	
Parameters:
@OrderCode1125[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:30:43
Text:	 SELECT   [TbDistributionEntOrder].* FROM [TbDistributionEntOrder] LEFT OUTER JOIN [TbDistributionEnt] ON ([TbDistributionEntOrder].[DistributionCode] = [TbDistributionEnt].[DistributionCode])  WHERE ([TbDistributionEntOrder].[OrderCode] IN (@OrderCode1126)) 	
Parameters:
@OrderCode1126[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:30:43
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:30:43
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:30:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025879437836288
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:30:43
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode1128) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode1129))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus1130)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode1128[String] = 6386683729561128960
@WorkAreaCode1129[String] = 6274025879437836288
@Examinestatus1130[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:30:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025879437836288
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:30:43
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE ((([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode1131) AND ([TbRawMaterialStockRecord].[WorkAreaCode] IN (@WorkAreaCode1132))) AND ([TbRawMaterialArchives].[RebarType] = @RebarType1133)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode1131[String] = 6386683729561128960
@WorkAreaCode1132[String] = 6274025879437836288
@RebarType1133[String] = BuildingSteel


-----------------------------------------------------------------------------
2020-03-27 18:30:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025879437836288
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:30:43
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE ((([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode1134) AND ([TbRawMaterialStockRecord].[WorkAreaCode] IN (@WorkAreaCode1135))) AND ([TbRawMaterialArchives].[RebarType] = @RebarType1136)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode1134[String] = 6386683729561128960
@WorkAreaCode1135[String] = 6274025879437836288
@RebarType1136[String] = SectionSteel


-----------------------------------------------------------------------------
2020-03-27 18:30:44
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025879437836288
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:30:44
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode1137) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode1138,@SiteCode1139,@SiteCode1140,@SiteCode1141))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus1142)) 	
Parameters:
@ProcessFactoryCode1137[String] = 6386683729561128960
@SiteCode1138[String] = 6274027775095472128
@SiteCode1139[String] = 6274027929433276416
@SiteCode1140[String] = 6274028333340557312
@SiteCode1141[String] = 6417410523612188672
@Examinestatus1142[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:30:44
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode1143)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode1143[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:30:44
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025879437836288
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:30:44
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025879437836288
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:30:44
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE (((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode1152) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode1153,@SiteCode1154,@SiteCode1155,@SiteCode1156))) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus1157)) 	
Parameters:
@ProcessFactoryCode1152[String] = 6386683729561128960
@SiteCode1153[String] = 6274027775095472128
@SiteCode1154[String] = 6274027929433276416
@SiteCode1155[String] = 6274028333340557312
@SiteCode1156[String] = 6417410523612188672
@Examinestatus1157[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:30:44
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode1158)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode1158[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:30:44
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE ((((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode1144)) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode1145,@SiteCode1146,@SiteCode1147,@SiteCode1148))) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState1149,@ProcessingState1150,@ProcessingState1151))) 	
Parameters:
@ProcessFactoryCode1144[String] = 6386683729561128960
@SiteCode1145[String] = 6274027775095472128
@SiteCode1146[String] = 6274027929433276416
@SiteCode1147[String] = 6274028333340557312
@SiteCode1148[String] = 6417410523612188672
@ProcessingState1149[String] = Processing
@ProcessingState1150[String] = Received
@ProcessingState1151[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 18:30:44
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat1159) 	
Parameters:
@DaetailWorkStrat1159[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 18:30:44
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[OrderCode] IN (@OrderCode1160)) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime1161)))) 	
Parameters:
@OrderCode1160[String] = JGDD202000001
@DistributionTime1161[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 18:30:44
Text:	 SELECT count(*) as r_cnt FROM [TbDistributionPlanInfo] WHERE (([TbDistributionPlanInfo].[OrderCode] IN (@OrderCode1162)) AND ((DistributionStart='配送完成' and DATEPART(day,DeliveryCompleteTime)>DATEPART(day,DistributionTime)) or (DistributionStart='未配送' and DistributionTime>GETDATE())))	
Parameters:
@OrderCode1162[String] = JGDD202000001


-----------------------------------------------------------------------------
2020-03-27 18:30:44
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025879437836288
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:30:44
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode1163) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode1164))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus1165)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode1163[String] = 6386683729561128960
@WorkAreaCode1164[String] = 6274025879437836288
@Examinestatus1165[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:30:45
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6274025879437836288
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:30:45
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE (((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode1166) AND ([TbRawMaterialMonthDemandPlan].[WorkAreaCode] IN (@WorkAreaCode1167))) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus1168)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode1166[String] = 6386683729561128960
@WorkAreaCode1167[String] = 6274025879437836288
@Examinestatus1168[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:30:45
Text:	 SELECT   [TbOrderProgress].[ProcessingState],[TbOrderProgress].[FinishProcessingDateTime],[TbOrderProgress].[DistributionTime],[TbOrderProgress].[SiteCode] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[SiteCode] IN (@SiteCode1169,@SiteCode1170,@SiteCode1171,@SiteCode1172,@SiteCode1173,@SiteCode1174,@SiteCode1175,@SiteCode1176,@SiteCode1177,@SiteCode1178,@SiteCode1179,@SiteCode1180,@SiteCode1181,@SiteCode1182,@SiteCode1183,@SiteCode1184,@SiteCode1185,@SiteCode1186,@SiteCode1187,@SiteCode1188,@SiteCode1189,@SiteCode1190,@SiteCode1191,@SiteCode1192,@SiteCode1193,@SiteCode1194,@SiteCode1195,@SiteCode1196,@SiteCode1197,@SiteCode1198,@SiteCode1199,@SiteCode1200,@SiteCode1201,@SiteCode1202,@SiteCode1203,@SiteCode1204,@SiteCode1205,@SiteCode1206,@SiteCode1207,@SiteCode1208,@SiteCode1209,@SiteCode1210,@SiteCode1211,@SiteCode1212,@SiteCode1213,@SiteCode1214,@SiteCode1215,@SiteCode1216,@SiteCode1217,@SiteCode1218,@SiteCode1219,@SiteCode1220,@SiteCode1221,@SiteCode1222,@SiteCode1223,@SiteCode1224,@SiteCode1225,@SiteCode1226,@SiteCode1227,@SiteCode1228,@SiteCode1229,@SiteCode1230,@SiteCode1231,@SiteCode1232,@SiteCode1233,@SiteCode1234,@SiteCode1235,@SiteCode1236,@SiteCode1237,@SiteCode1238,@SiteCode1239)) AND (YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=3)) 	
Parameters:
@SiteCode1169[String] = 6274027775095472128
@SiteCode1170[String] = 6274027929433276416
@SiteCode1171[String] = 6417410523612188672
@SiteCode1172[String] = 6274028333340557312
@SiteCode1173[String] = 6274028829845487616
@SiteCode1174[String] = 6274029086029381632
@SiteCode1175[String] = 6274029528142577664
@SiteCode1176[String] = 6274029966388625408
@SiteCode1177[String] = 6274030152053686272
@SiteCode1178[String] = 6274030373047369728
@SiteCode1179[String] = 6274030913332445184
@SiteCode1180[String] = 6267789807737372672
@SiteCode1181[String] = 6267790255894560768
@SiteCode1182[String] = 6267790460492709888
@SiteCode1183[String] = 6267790574804271104
@SiteCode1184[String] = 6267791036517449728
@SiteCode1185[String] = 6267791338536697856
@SiteCode1186[String] = 6267791654132908032
@SiteCode1187[String] = 6267790081113718784
@SiteCode1188[String] = 6267790783294734336
@SiteCode1189[String] = 6267791210027417600
@SiteCode1190[String] = 6267791528110850048
@SiteCode1191[String] = 6437059801301262336
@SiteCode1192[String] = 6308426901824208896
@SiteCode1193[String] = 6276140742482067456
@SiteCode1194[String] = 6276141050964738048
@SiteCode1195[String] = 6276141450283450368
@SiteCode1196[String] = 6276141737463250944
@SiteCode1197[String] = 6276141926932545536
@SiteCode1198[String] = 6267796592825204736
@SiteCode1199[String] = 6267796864196673536
@SiteCode1200[String] = 6267797037211713536
@SiteCode1201[String] = 6267797181319610368
@SiteCode1202[String] = 6276760608893304832
@SiteCode1203[String] = 6267798187931598848
@SiteCode1204[String] = 6267798388054425600
@SiteCode1205[String] = 6267749616851091456
@SiteCode1206[String] = 6267750471750909952
@SiteCode1207[String] = 6267750709144322048
@SiteCode1208[String] = 6267750895786655744
@SiteCode1209[String] = 6267751010588950528
@SiteCode1210[String] = 6267753037104676864
@SiteCode1211[String] = 6267754200801738752
@SiteCode1212[String] = 6267754324688896000
@SiteCode1213[String] = 6267797518566817792
@SiteCode1214[String] = 6267783175129268224
@SiteCode1215[String] = 6267783320914886656
@SiteCode1216[String] = 6267783444885929984
@SiteCode1217[String] = 6267783577954418688
@SiteCode1218[String] = 6267784612617912320
@SiteCode1219[String] = 6267785016667799552
@SiteCode1220[String] = 6267785185136214016
@SiteCode1221[String] = 6267785381991677952
@SiteCode1222[String] = 6267785590951903232
@SiteCode1223[String] = 6267785762842869760
@SiteCode1224[String] = 6267793585479876608
@SiteCode1225[String] = 6267793380881727488
@SiteCode1226[String] = 6437060915425845248
@SiteCode1227[String] = 6284878460246556672
@SiteCode1228[String] = 6284879065547538432
@SiteCode1229[String] = 6285119541664022528
@SiteCode1230[String] = 6285120302351384576
@SiteCode1231[String] = 6285181647230861312
@SiteCode1232[String] = 6285120520983674880
@SiteCode1233[String] = 6285120866493661184
@SiteCode1234[String] = 6285121357168508928
@SiteCode1235[String] = 6285122203776188416
@SiteCode1236[String] = 6437059163368595456
@SiteCode1237[String] = 6374383547544903680
@SiteCode1238[String] = 6374384032955899904
@SiteCode1239[String] = 6374384202665828352


-----------------------------------------------------------------------------
2020-03-27 18:30:46
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:30:46
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:33:32
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
left join TbFlowDefine d on p.FlowCode=d.FlowCode
where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
union all
select COUNT(1) as MsgCount from TbFlowPerformMessage m 
LEFT JOIN TbUser tu ON m.UserCode=tu.UserCode
where (m.usercode=@UserCode OR tu.UserId=@UserCode)and IsRead=-1
union all
select SUM(Tb.earlywarningcount) as earlywarningcount from (
select COUNT(1) as earlywarningcount from TbFlowEarlyWarningInfo where EarlyWarningBTUser=@UserCode and EarlyWarningStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)
union all
select COUNT(1) as earlywarningcount from TbFormEarlyWarningNodeInfo where EWUserCode=@UserCode and EWStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:34:06
Text:	select TbAll.EarlyWarningCode,TbAll.BranchCode,TbAll.BranchName,TbAll.WorkAreaCode,TbAll.WorkAreaName,TbAll.SiteCode,TbAll.SiteName,TbAll.ProjectId,TbAll.YjMonth,TbAll.MenuCode,TbAll.EWNodeCode,TbAll.EWNodeName,TbAll.PersonnelCode,TbAll.PersonnelSource,TbAll.BegEwTiemNew from (select Tb.*,case when Tb.EWTimeType='年' then DATEADD(YEAR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='月' then DATEADD(MONTH,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='天' then DATEADD(DAY,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='时' then DATEADD(HOUR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='分' then DATEADD(MINUTE,Tb.EWTime,Tb.BegEwTiem) end as BegEwTiemNew,TbYjInfo.EarlyWarningCode as YjCode from (select ewt.EarlyWarningCode,DATENAME(year,GETDATE())+'-'+ DATENAME(MONTH,GETDATE())+'-'+ CONVERT(varchar(20),ewt.EWBegDay)+' '+CONVERT(varchar(20),ewt.EWBegHour)+':'+CONVERT(varchar(20),ewt.EWBegMinute)+':00' as BegEwTiem,ewt.BranchCode,cp1.CompanyFullName as BranchName,ewt.WorkAreaCode,cp2.CompanyFullName as WorkAreaName,ewt.SiteCode,cp3.CompanyFullName as SiteName,ewt.ProjectId,MONTH(GETDATE()) as YjMonth,ewt.MenuCode,ewn.EWNodeCode,ewn.EWNodeName,ewn.EWTimeType,ewn.EWTime,ewnp.PersonnelCode,ewnp.PersonnelSource,ewnp.DeptId,ewnp.RoleId from TbFormEarlyWarningBegTime ewt 
left join TbFormEarlyWarningNode ewn on ewt.EarlyWarningCode=ewn.EarlyWarningCode and ewt.ProjectId=ewn.ProjectId and ewt.MenuCode=ewn.MenuCode
left join TbFormEarlyWarningNodePersonnel ewnp on ewn.EarlyWarningCode=ewnp.EarlyWarningCode and ewn.EWNodeCode=ewnp.EWNodeCode and  ewn.MenuCode=ewnp.MenuCode and ewn.ProjectId=ewnp.ProjectId
left join TbCompany cp1 on ewt.BranchCode=cp1.CompanyCode
left join TbCompany cp2 on ewt.WorkAreaCode=cp2.CompanyCode
left join TbCompany cp3 on ewt.SiteCode=cp3.CompanyCode
where ewt.MenuCode='RawMonthDemandPlan') Tb 
left join (select EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId from TbFormEarlyWarningNodeInfo ewni
where ewni.EWFormDataCode=MONTH(GETDATE()) group by EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId) TbYjInfo on Tb.EarlyWarningCode=TbYjInfo.EarlyWarningCode and Tb.EWNodeCode=TbYjInfo.EWNodeCode and Tb.MenuCode=TbYjInfo.MenuCode and  Tb.YjMonth=TbYjInfo.EWFormDataCode and Tb.WorkAreaCode=TbYjInfo.WorkArea and Tb.ProjectId=TbYjInfo.ProjectId
where GETDATE()>=BegEwTiem and Tb.WorkAreaCode not in(select rmdp.WorkAreaCode from TbRawMaterialMonthDemandPlan rmdp where MONTH(InsertTime)=MONTH(GETDATE())
group by rmdp.WorkAreaCode)) TbAll where TbAll.YjCode is null and TbAll.PersonnelCode is not null and GETDATE()>=TbAll.BegEwTiemNew	


-----------------------------------------------------------------------------
2020-03-27 18:36:32
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
left join TbFlowDefine d on p.FlowCode=d.FlowCode
where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
union all
select COUNT(1) as MsgCount from TbFlowPerformMessage m 
LEFT JOIN TbUser tu ON m.UserCode=tu.UserCode
where (m.usercode=@UserCode OR tu.UserId=@UserCode)and IsRead=-1
union all
select SUM(Tb.earlywarningcount) as earlywarningcount from (
select COUNT(1) as earlywarningcount from TbFlowEarlyWarningInfo where EarlyWarningBTUser=@UserCode and EarlyWarningStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)
union all
select COUNT(1) as earlywarningcount from TbFormEarlyWarningNodeInfo where EWUserCode=@UserCode and EWStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:37:31
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6337324142387400704','6352967650544590848') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6487716734823440384


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
left join TbFlowDefine d on p.FlowCode=d.FlowCode
where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
union all
select COUNT(1) as MsgCount from TbFlowPerformMessage m 
LEFT JOIN TbUser tu ON m.UserCode=tu.UserCode
where (m.usercode=@UserCode OR tu.UserId=@UserCode)and IsRead=-1
union all
select SUM(Tb.earlywarningcount) as earlywarningcount from (
select COUNT(1) as earlywarningcount from TbFlowEarlyWarningInfo where EarlyWarningBTUser=@UserCode and EarlyWarningStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)
union all
select COUNT(1) as earlywarningcount from TbFormEarlyWarningNodeInfo where EWUserCode=@UserCode and EWStart=0 and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	SELECT MaterialName FROM TbRawMaterialArchives
                                GROUP BY MaterialName	


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	SELECT MaterialName FROM TbRawMaterialArchives
                                GROUP BY MaterialName	


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	select isnull(sum(TbCF.Capacity),0) as Capacity,isnull(sum(TbCF.WeightSmallPlan),0) as WeightSmallPlan,isnull(cast(sum(TbCF.WeightSmallPlan)/sum(TbCF.Capacity)*100 as decimal(18,2)),0) as ActualLoadNew from (select cf.Capacity,Tb1.WeightSmallPlan,cf.ProcessFactoryCode from TbCapacityFilling cf  
left join(
select SUM(Tb.WeightSmallPlan) as WeightSmallPlan,Tb.ProcessFactoryCode from (
                            select isnull(SUM(wod.WeightSmallPlan),0) as WeightSmallPlan,wo.ProcessFactoryCode from TbWorkOrder wo
                            left join TbWorkOrderDetail wod on wo.OrderCode=wod.OrderCode
                            where (ISNULL(@ProcessFactoryCode,'')='' or wo.ProcessFactoryCode=@ProcessFactoryCode)
                            and CONVERT(varchar(7), wo.DistributionTime, 120)=@month
                            and wod.RevokeStart='正常' and wo.ProcessingState!='ConfirmWork' and wo.ProcessingState!='Finishing'  group by wo.ProcessFactoryCode
                            union all
                            select isnull(sum(opd.NoCompleted),0) as NoCompleted,op.ProcessFactoryCode from TbOrderProgress op
                            left join TbOrderProgressDetail opd on op.OrderCode=opd.OrderCode 
                            where (ISNULL(@ProcessFactoryCode,'')='' or op.ProcessFactoryCode=@ProcessFactoryCode)
                            and CONVERT(varchar(7), op.DistributionTime, 120)=CONVERT(varchar(4),YEAR(DATEADD(MONTH,-1,@month+'-01')))+'-'+Right(100+Month(DATEADD(MONTH,-1,@month+'-01')),2)
                            and opd.RevokeStart='正常'  group by op.ProcessFactoryCode)Tb  group by Tb.ProcessFactoryCode
) Tb1 on cf.ProcessFactoryCode=Tb1.ProcessFactoryCode 
where cf.CapacityMonth=@month
and (ISNULL(@ProcessFactoryCode,'')='' or cf.ProcessFactoryCode=@ProcessFactoryCode)) TbCF where (ISNULL(@ProcessFactoryCode,'')='' or TbCF.ProcessFactoryCode=@ProcessFactoryCode)	
Parameters:
@ProcessFactoryCode[String] = 6386683729561128960
@month[String] = 2020-03


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	
                        select fewoi.DataCode as OddNumbers,
                         fewoi.EarlyWarningContent,
                         fewoi.EWFormDataCode,
                         CONVERT(varchar(100), fewoi.EarlyWarningTime, 120) as EarlyWarningTime,
                         EWFormCode,sm.MenuName,fn.FlowNodeName,cp1.CompanyFullName as BranchName,
                         cp2.CompanyFullName as WorkAreaName,cp3.CompanyFullName as SiteName,cp4.CompanyFullName as ProcessFactoryName,
                         u1.UserName as FlowSpUserName,u2.UserName as FlowYjUserName 
                        FROM (
                        select*
                           FROM ( 
                        		SELECT a.*, row_number()over(partition BY a.FlowCode ORDER BY a.FlowNodeCode,a.EarlyWarningTime desc) as group_idx 
                        		FROM TbFlowEarlyWarningOtherInfo  a
                        		INNER JOIN  TbFlowEarlyWarningInfo b ON a.FlowCode=b.FlowCode 
                        		AND a.EWFormDataCode=b.EWFormDataCode AND a.FlowNodeCode=b.FlowNodeCode 
                        		WHERE YEAR(a.EarlyWarningTime)= @Year and MONTH(a.EarlyWarningTime)= @Month AND b.EarlyWarningStart=0
                           ) ret
                        WHERE ret.group_idx =1
                        ) fewoi
                        left join TbFlowNode fn on fewoi.FlowCode=fn.FlowCode and fewoi.FlowNodeCode=fn.FlowNodeCode
                        left join TbSysMenu sm on fewoi.EWFormCode=sm.MenuCode
                        left join TbCompany cp1 on fewoi.BranchCode=cp1.CompanyCode
                        left join TbCompany cp2 on fewoi.WorkAreaCode=cp2.CompanyCode
                        left join TbCompany cp3 on fewoi.SiteCode=cp3.CompanyCode
                        left join TbCompany cp4 on fewoi.ProcessFactoryCode=cp4.CompanyCode
                        left join TbUser u1 on fewoi.FlowSpUserCode=u1.UserId
                        left join TbUser u2 on fewoi.FlowYjUserCode=u2.UserId where 1=1 and fewoi.ProjectId='6245721945602523136' and fewoi.ProcessFactoryCode='6386683729561128960' and (fewoi.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') or fewoi.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688')) ORDER BY fewoi.EarlyWarningTime desc	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	--配送超期
                           select dpi.OrderCode,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as ProcessFactoryName,dpi.DistributionTime,dpi.DeliveryCompleteTime,dpi.Remark from TbDistributionPlanInfo dpi
                           left join TbCompany cp1 on dpi.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on dpi.ProcessFactoryCode=cp2.CompanyCode
                           where YEAR(dpi.DistributionTime)= @Year and MONTH(dpi.DistributionTime)= @Month
                           and (dpi.DeliveryCompleteTime>dpi.DistributionTime or (GETDATE()>dpi.DistributionTime and dpi.DeliveryCompleteTime is null))  and dpi.ProjectId='6245721945602523136' and dpi.ProcessFactoryCode='6386683729561128960' and dpi.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') ORDER BY dpi.DistributionTime desc	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	select TbYj.*,cp1.CompanyFullName as SiteName,tcr.EnterSpaceTime,tcr.StartDischargeTime,tcr.EndDischargeTime,disEnt.ProcessFactoryCode,cp.CompanyFullName as ProcessFactoryName from (select min(EwTime) as EwTime,MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId from TbFormEarlyWarningNodeInfo where  MenuCode='SiteDischargeCargo' 
						   group by MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId) TbYj
						   left join TbTransportCarReport tcr on TbYj.EWFormDataCode=tcr.DisEntOrderId
                           left join TbDistributionEnt disEnt on tcr.DistributionCode=disEnt.DistributionCode
                           left join TbCompany cp on disEnt.ProcessFactoryCode=cp.CompanyCode
                           left join TbCompany cp1 on TbYj.SiteCode=cp1.CompanyCode
						   where YEAR(TbYj.EWTime)= @Year and MONTH(TbYj.EWTime)= @Month  and TbYj.ProjectId='6245721945602523136' and disEnt.ProcessFactoryCode='6386683729561128960' and TbYj.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') ORDER BY tcr.EnterSpaceTime desc	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	select TbYj.*,cp1.CompanyFullName as SiteName,sfs.DistributionCode,sdc.DistributionTime,sfs.SigninTime,sfs.ProcessFactoryCode,cp.CompanyFullName as ProcessFactoryName from (select min(EwTime) as EwTime,MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId from TbFormEarlyWarningNodeInfo where  MenuCode='SemiFinishedSign' 
						   group by MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId) TbYj
						   left join TbSemiFinishedSign sfs on TbYj.EWFormDataCode=sfs.ID
                           left join TbSiteDischargeCargo sdc on sfs.DistributionCode=sdc.DistributionCode and sfs.DischargeCargoCode=sdc.DischargeCargoCode
                           left join TbCompany cp on sfs.ProcessFactoryCode=cp.CompanyCode
                           left join TbCompany cp1 on TbYj.SiteCode=cp1.CompanyCode
						   where YEAR(TbYj.EWTime)= @Year and MONTH(TbYj.EWTime)= @Month and TbYj.ProjectId='6245721945602523136' and sfs.ProcessFactoryCode='6386683729561128960' and TbYj.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792')	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE ((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode1244) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus1245)) 	
Parameters:
@ProcessFactoryCode1244[String] = 6386683729561128960
@Examinestatus1245[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode1246,@OrderCode1247,@OrderCode1248,@OrderCode1249,@OrderCode1250,@OrderCode1251,@OrderCode1252,@OrderCode1253)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode1246[String] = JGDD202000001
@OrderCode1247[String] = JGDD202000002
@OrderCode1248[String] = JGDD202000003
@OrderCode1249[String] = JGDD202000004
@OrderCode1250[String] = JGDD202000005
@OrderCode1251[String] = JGDD202000006
@OrderCode1252[String] = JGDD202000008
@OrderCode1253[String] = JGDD202000009


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE (((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode1240)) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState1241,@ProcessingState1242,@ProcessingState1243))) 	
Parameters:
@ProcessFactoryCode1240[String] = 6386683729561128960
@ProcessingState1241[String] = Processing
@ProcessingState1242[String] = Received
@ProcessingState1243[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat1254) 	
Parameters:
@DaetailWorkStrat1254[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[OrderCode] IN (@OrderCode1255,@OrderCode1256,@OrderCode1257,@OrderCode1258,@OrderCode1259,@OrderCode1260,@OrderCode1261,@OrderCode1262,@OrderCode1263,@OrderCode1264,@OrderCode1265)) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime1266)))) 	
Parameters:
@OrderCode1255[String] = JGDD202000001
@OrderCode1256[String] = JGDD202000002
@OrderCode1257[String] = JGDD202000003
@OrderCode1258[String] = JGDD202000004
@OrderCode1259[String] = JGDD202000005
@OrderCode1260[String] = JGDD202000006
@OrderCode1261[String] = JGDD202000008
@OrderCode1262[String] = JGDD202000003
@OrderCode1263[String] = JGDD202000004
@OrderCode1264[String] = JGDD202000004
@OrderCode1265[String] = JGDD202000004
@DistributionTime1266[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	 SELECT   [TbDistributionPlanInfo].[DistributionStart] FROM [TbDistributionPlanInfo]  WHERE ([TbDistributionPlanInfo].[OrderCode] IN (@OrderCode1267,@OrderCode1268,@OrderCode1269,@OrderCode1270,@OrderCode1271,@OrderCode1272,@OrderCode1273)) 	
Parameters:
@OrderCode1267[String] = JGDD202000001
@OrderCode1268[String] = JGDD202000002
@OrderCode1269[String] = JGDD202000003
@OrderCode1270[String] = JGDD202000004
@OrderCode1271[String] = JGDD202000005
@OrderCode1272[String] = JGDD202000006
@OrderCode1273[String] = JGDD202000008


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	 SELECT   [TbDistributionEntOrder].* FROM [TbDistributionEntOrder] LEFT OUTER JOIN [TbDistributionEnt] ON ([TbDistributionEntOrder].[DistributionCode] = [TbDistributionEnt].[DistributionCode])  WHERE ([TbDistributionEntOrder].[OrderCode] IN (@OrderCode1274,@OrderCode1275,@OrderCode1276,@OrderCode1277,@OrderCode1278,@OrderCode1279,@OrderCode1280)) 	
Parameters:
@OrderCode1274[String] = JGDD202000001
@OrderCode1275[String] = JGDD202000002
@OrderCode1276[String] = JGDD202000003
@OrderCode1277[String] = JGDD202000004
@OrderCode1278[String] = JGDD202000005
@OrderCode1279[String] = JGDD202000006
@OrderCode1280[String] = JGDD202000008


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE ((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode1281) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus1282)) 	
Parameters:
@ProcessFactoryCode1281[String] = 6386683729561128960
@Examinestatus1282[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode1283,@OrderCode1284,@OrderCode1285,@OrderCode1286,@OrderCode1287,@OrderCode1288,@OrderCode1289,@OrderCode1290)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode1283[String] = JGDD202000001
@OrderCode1284[String] = JGDD202000002
@OrderCode1285[String] = JGDD202000003
@OrderCode1286[String] = JGDD202000004
@OrderCode1287[String] = JGDD202000005
@OrderCode1288[String] = JGDD202000006
@OrderCode1289[String] = JGDD202000008
@OrderCode1290[String] = JGDD202000009


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	--加工进度滞后
                           select op.OrderCode,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as ProcessFactoryName,op.DistributionTime,op.FinishProcessingDateTime from TbOrderProgress op 
                           left join TbCompany cp1 on op.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on op.ProcessFactoryCode=cp2.CompanyCode
                           where YEAR(op.DistributionTime)= @Year and MONTH(op.DistributionTime)= @Month
                           and (op.FinishProcessingDateTime>op.DistributionTime or (GETDATE()>op.DistributionTime and op.FinishProcessingDateTime is null))  and op.ProjectId='6245721945602523136' and op.ProcessFactoryCode='6386683729561128960' and op.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') ORDER BY op.DistributionTime desc	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:37:32
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:37:33
Text:	 SELECT   [TbOrderProgress].[ProcessingState],[TbOrderProgress].[FinishProcessingDateTime],[TbOrderProgress].[DistributionTime],[TbOrderProgress].[SiteCode] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[SiteCode] IN (@SiteCode1291,@SiteCode1292,@SiteCode1293,@SiteCode1294,@SiteCode1295,@SiteCode1296,@SiteCode1297,@SiteCode1298,@SiteCode1299,@SiteCode1300,@SiteCode1301,@SiteCode1302,@SiteCode1303,@SiteCode1304,@SiteCode1305,@SiteCode1306,@SiteCode1307,@SiteCode1308,@SiteCode1309,@SiteCode1310,@SiteCode1311,@SiteCode1312,@SiteCode1313,@SiteCode1314,@SiteCode1315,@SiteCode1316,@SiteCode1317,@SiteCode1318,@SiteCode1319,@SiteCode1320,@SiteCode1321,@SiteCode1322,@SiteCode1323,@SiteCode1324,@SiteCode1325,@SiteCode1326,@SiteCode1327,@SiteCode1328,@SiteCode1329,@SiteCode1330,@SiteCode1331,@SiteCode1332,@SiteCode1333,@SiteCode1334,@SiteCode1335,@SiteCode1336,@SiteCode1337,@SiteCode1338,@SiteCode1339,@SiteCode1340,@SiteCode1341,@SiteCode1342,@SiteCode1343,@SiteCode1344,@SiteCode1345,@SiteCode1346,@SiteCode1347,@SiteCode1348,@SiteCode1349,@SiteCode1350,@SiteCode1351,@SiteCode1352,@SiteCode1353,@SiteCode1354,@SiteCode1355,@SiteCode1356,@SiteCode1357,@SiteCode1358,@SiteCode1359,@SiteCode1360,@SiteCode1361)) AND (YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=3)) 	
Parameters:
@SiteCode1291[String] = 6274027775095472128
@SiteCode1292[String] = 6274027929433276416
@SiteCode1293[String] = 6417410523612188672
@SiteCode1294[String] = 6274028333340557312
@SiteCode1295[String] = 6274028829845487616
@SiteCode1296[String] = 6274029086029381632
@SiteCode1297[String] = 6274029528142577664
@SiteCode1298[String] = 6274029966388625408
@SiteCode1299[String] = 6274030152053686272
@SiteCode1300[String] = 6274030373047369728
@SiteCode1301[String] = 6274030913332445184
@SiteCode1302[String] = 6267789807737372672
@SiteCode1303[String] = 6267790255894560768
@SiteCode1304[String] = 6267790460492709888
@SiteCode1305[String] = 6267790574804271104
@SiteCode1306[String] = 6267791036517449728
@SiteCode1307[String] = 6267791338536697856
@SiteCode1308[String] = 6267791654132908032
@SiteCode1309[String] = 6267790081113718784
@SiteCode1310[String] = 6267790783294734336
@SiteCode1311[String] = 6267791210027417600
@SiteCode1312[String] = 6267791528110850048
@SiteCode1313[String] = 6437059801301262336
@SiteCode1314[String] = 6308426901824208896
@SiteCode1315[String] = 6276140742482067456
@SiteCode1316[String] = 6276141050964738048
@SiteCode1317[String] = 6276141450283450368
@SiteCode1318[String] = 6276141737463250944
@SiteCode1319[String] = 6276141926932545536
@SiteCode1320[String] = 6267796592825204736
@SiteCode1321[String] = 6267796864196673536
@SiteCode1322[String] = 6267797037211713536
@SiteCode1323[String] = 6267797181319610368
@SiteCode1324[String] = 6276760608893304832
@SiteCode1325[String] = 6267798187931598848
@SiteCode1326[String] = 6267798388054425600
@SiteCode1327[String] = 6267749616851091456
@SiteCode1328[String] = 6267750471750909952
@SiteCode1329[String] = 6267750709144322048
@SiteCode1330[String] = 6267750895786655744
@SiteCode1331[String] = 6267751010588950528
@SiteCode1332[String] = 6267753037104676864
@SiteCode1333[String] = 6267754200801738752
@SiteCode1334[String] = 6267754324688896000
@SiteCode1335[String] = 6267797518566817792
@SiteCode1336[String] = 6267783175129268224
@SiteCode1337[String] = 6267783320914886656
@SiteCode1338[String] = 6267783444885929984
@SiteCode1339[String] = 6267783577954418688
@SiteCode1340[String] = 6267784612617912320
@SiteCode1341[String] = 6267785016667799552
@SiteCode1342[String] = 6267785185136214016
@SiteCode1343[String] = 6267785381991677952
@SiteCode1344[String] = 6267785590951903232
@SiteCode1345[String] = 6267785762842869760
@SiteCode1346[String] = 6267793585479876608
@SiteCode1347[String] = 6267793380881727488
@SiteCode1348[String] = 6437060915425845248
@SiteCode1349[String] = 6284878460246556672
@SiteCode1350[String] = 6284879065547538432
@SiteCode1351[String] = 6285119541664022528
@SiteCode1352[String] = 6285120302351384576
@SiteCode1353[String] = 6285181647230861312
@SiteCode1354[String] = 6285120520983674880
@SiteCode1355[String] = 6285120866493661184
@SiteCode1356[String] = 6285121357168508928
@SiteCode1357[String] = 6285122203776188416
@SiteCode1358[String] = 6437059163368595456
@SiteCode1359[String] = 6374383547544903680
@SiteCode1360[String] = 6374384032955899904
@SiteCode1361[String] = 6374384202665828352


-----------------------------------------------------------------------------
2020-03-27 18:37:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:37:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:37:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:37:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:37:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:37:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:37:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:37:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:37:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:37:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:37:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:37:33
Text:	SELECT 
                            '审批超时' as YjTypeName,COUNT(1) as YjNum
                            FROM (
									SELECT a.*, row_number()over(partition BY a.FlowCode ORDER BY a.FlowNodeCode,a.EarlyWarningTime desc) as group_idx 
									FROM TbFlowEarlyWarningOtherInfo  a
									INNER JOIN  TbFlowEarlyWarningInfo b ON a.FlowCode=b.FlowCode 
									AND a.EWFormDataCode=b.EWFormDataCode AND a.FlowNodeCode=b.FlowNodeCode 
									WHERE  b.EarlyWarningStart=0 AND YEAR(a.EarlyWarningTime)= @Year and MONTH(a.EarlyWarningTime)= @Month  and a.ProjectId='6245721945602523136' and a.ProcessFactoryCode='6386683729561128960' and (a.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') or a.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688'))
							   ) Tb1
                            WHERE Tb1.group_idx =1
                           union all
                            select '未报月度需求计划' as YjTypeName,COUNT(1)as YjNum
                             FROM ( 
                                  SELECT *, row_number()over(partition BY EarlyWarningCode,EWFormDataCode ORDER BY EWNodeCode,EWTime desc) as group_idx 
                                  FROM TbFormEarlyWarningNodeInfo fwqi
                                  WHERE fwqi.MenuCode='RawMonthDemandPlan' AND fwqi.EWStart=0 AND YEAR(fwqi.EWTime)= @Year and MONTH(fwqi.EWTime)= @Month  and fwqi.ProjectId='6245721945602523136' and (fwqi.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') or fwqi.WorkArea in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688'))  
                             ) Tb2
                             WHERE Tb2.group_idx =1
                           union all
                           select '原材料供货超时' as YjTypeName,COUNT(1) as YjNum from (
                           select BatchPlanNum,cp1.CompanyFullName as BranchName,cp2.CompanyFullName as WorkAreaName,cp3.CompanyFullName as SiteName,cp4.CompanyFullName as ProcessFactoryName,sup.SupplyDate,sup.SupplyCompleteTime,sup.ProjectId from TbSupplyList sup
                           left join TbCompany cp1 on cp1.CompanyCode=sup.BranchCode
                           left join TbCompany cp2 on cp2.CompanyCode=sup.WorkAreaCode
                           left join TbCompany cp3 on cp3.CompanyCode=sup.SiteCode
                           left join TbCompany cp4 on cp4.CompanyCode=sup.ProcessFactoryCode
                           where (sup.SupplyCompleteTime>sup.SupplyDate or (GETDATE()>sup.SupplyDate and sup.SupplyCompleteTime is null))
						   and YEAR(sup.SupplyDate)= @Year and MONTH(sup.SupplyDate)= @Month  and sup.ProjectId='6245721945602523136' and sup.ProcessFactoryCode='6386683729561128960' and (sup.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') or sup.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688'))) Tb3
                           union all
                           select '加急订单' as YjTypeName,COUNT(1) as YjNum from (--加急订单个数
                           select wo.OrderCode,wo.DistributionTime,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as ProcessFactoryName from TbWorkOrder wo
                           left join TbCompany cp1 on wo.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on wo.ProcessFactoryCode=cp2.CompanyCode
                           where UrgentDegree='Urgent' 
						   and YEAR(wo.DistributionTime)= @Year and MONTH(wo.DistributionTime)= @Month  and wo.ProjectId='6245721945602523136' and wo.ProcessFactoryCode='6386683729561128960' and wo.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') ) Tb4
                           union all
                           select '加工进度滞后' as YjTypeName,COUNT(1) as YjNum from (--加工进度滞后
                           select op.OrderCode,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as ProcessFactoryName,op.DistributionTime,op.FinishProcessingDateTime from TbOrderProgress op 
                           left join TbCompany cp1 on op.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on op.ProcessFactoryCode=cp2.CompanyCode
                           where YEAR(op.DistributionTime)= @Year and MONTH(op.DistributionTime)= @Month
                           and (op.FinishProcessingDateTime>op.DistributionTime or (GETDATE()>op.DistributionTime and op.FinishProcessingDateTime is null))  and op.ProjectId='6245721945602523136' and op.ProcessFactoryCode='6386683729561128960' and op.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') ) Tb5
                           union all
                           select '接收配送超期' as YjTypeName,COUNT(1) as YjNum from (--配送超期
                           select dpi.OrderCode,cp1.CompanyFullName as SIteName,cp2.CompanyFullName as ProcessFactoryName,dpi.DistributionTime,dpi.DeliveryCompleteTime from TbDistributionPlanInfo dpi
                           left join TbCompany cp1 on dpi.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on dpi.ProcessFactoryCode=cp2.CompanyCode
                           where YEAR(dpi.DistributionTime)= @Year and MONTH(dpi.DistributionTime)= @Month
                           and (dpi.DeliveryCompleteTime>dpi.DistributionTime or (GETDATE()>dpi.DistributionTime and dpi.DeliveryCompleteTime is null))  and dpi.ProjectId='6245721945602523136' and dpi.ProcessFactoryCode='6386683729561128960' and dpi.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') ) Tb6 
                           union all
                           select '卸货超时' as YjTypeName,COUNT(1) as YjNum from(--卸货超时
                           select TbYj.*,cp1.CompanyFullName as SiteName,tcr.EnterSpaceTime,tcr.StartDischargeTime,tcr.EndDischargeTime,disEnt.ProcessFactoryCode,cp.CompanyFullName as ProcessFactoryName from (select min(EwTime) as EwTime,MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId from TbFormEarlyWarningNodeInfo where  MenuCode='SiteDischargeCargo' 
						   group by MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId) TbYj
						   left join TbTransportCarReport tcr on TbYj.EWFormDataCode=tcr.DisEntOrderId
                           left join TbDistributionEnt disEnt on tcr.DistributionCode=disEnt.DistributionCode
                           left join TbCompany cp on disEnt.ProcessFactoryCode=cp.CompanyCode
                           left join TbCompany cp1 on TbYj.SiteCode=cp1.CompanyCode
						   where YEAR(TbYj.EWTime)= @Year and MONTH(TbYj.EWTime)= @Month  and TbYj.ProjectId='6245721945602523136' and disEnt.ProcessFactoryCode='6386683729561128960' and TbYj.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') ) Tb7
                           union all
                           select '签收超时' as YjTypeName,COUNT(1) as YjNum from (select TbYj.*,cp1.CompanyFullName as SiteName,sfs.DistributionCode,sdc.DistributionTime,sfs.SigninTime,sfs.ProcessFactoryCode,cp.CompanyFullName as ProcessFactoryName from (select min(EwTime) as EwTime,MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId from TbFormEarlyWarningNodeInfo where  MenuCode='SemiFinishedSign' 
						   group by MenuCode,EWFormDataCode,CompanyCode,WorkArea,SiteCode,ProjectId) TbYj
						   left join TbSemiFinishedSign sfs on TbYj.EWFormDataCode=sfs.ID
                           left join TbSiteDischargeCargo sdc on sfs.DistributionCode=sdc.DistributionCode and sfs.DischargeCargoCode=sdc.DischargeCargoCode
                           left join TbCompany cp on sfs.ProcessFactoryCode=cp.CompanyCode
                           left join TbCompany cp1 on TbYj.SiteCode=cp1.CompanyCode
						   where YEAR(TbYj.EWTime)= @Year and MONTH(TbYj.EWTime)= @Month  and TbYj.ProjectId='6245721945602523136' and sfs.ProcessFactoryCode='6386683729561128960' and TbYj.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') ) Tb8	
Parameters:
@Year[String] = 2020
@Month[String] = 03


-----------------------------------------------------------------------------
2020-03-27 18:37:34
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE ((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode1363) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus1364)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode1363[String] = 6386683729561128960
@Examinestatus1364[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:37:34
Text:	 SELECT   * FROM [TbRawMaterialMonthDemandSupplyPlan]  WHERE [TbRawMaterialMonthDemandSupplyPlan].[DemandPlanCode] IN (@DemandPlanCode1365,@DemandPlanCode1366,@DemandPlanCode1367,@DemandPlanCode1368,@DemandPlanCode1369,@DemandPlanCode1370,@DemandPlanCode1371,@DemandPlanCode1372,@DemandPlanCode1373) 	
Parameters:
@DemandPlanCode1365[String] = XQJH202000002
@DemandPlanCode1366[String] = XQJH202000003
@DemandPlanCode1367[String] = XQJH202000004
@DemandPlanCode1368[String] = XQJH202000005
@DemandPlanCode1369[String] = XQJH202000006
@DemandPlanCode1370[String] = XQJH202000007
@DemandPlanCode1371[String] = XQJH202000008
@DemandPlanCode1372[String] = XQJH202000009
@DemandPlanCode1373[String] = XQJH202000010


-----------------------------------------------------------------------------
2020-03-27 18:37:34
Text:	 SELECT   [TbFactoryBatchNeedPlan].[RawMaterialDemandNum] AS [DemandPlanCode],[TbFactoryBatchNeedPlan].[BatchPlanNum],[TbFactoryBatchNeedPlan].[SteelsTypeCode] AS [RebarType],[TbFactoryBatchNeedPlan].[BatchPlanTotal] AS [TotalWeight] FROM [TbFactoryBatchNeedPlan]  WHERE (([TbFactoryBatchNeedPlan].[Examinestatus] = @Examinestatus1374) AND ([TbFactoryBatchNeedPlan].[RawMaterialDemandNum] IN (@RawMaterialDemandNum1375,@RawMaterialDemandNum1376,@RawMaterialDemandNum1377,@RawMaterialDemandNum1378,@RawMaterialDemandNum1379,@RawMaterialDemandNum1380,@RawMaterialDemandNum1381,@RawMaterialDemandNum1382,@RawMaterialDemandNum1383,@RawMaterialDemandNum1384,@RawMaterialDemandNum1385,@RawMaterialDemandNum1386,@RawMaterialDemandNum1387,@RawMaterialDemandNum1388,@RawMaterialDemandNum1389,@RawMaterialDemandNum1390,@RawMaterialDemandNum1391))) 	
Parameters:
@Examinestatus1374[String] = 审核完成
@RawMaterialDemandNum1375[String] = XQJH202000002
@RawMaterialDemandNum1376[String] = XQJH202000003
@RawMaterialDemandNum1377[String] = XQJH202000004
@RawMaterialDemandNum1378[String] = XQJH202000005
@RawMaterialDemandNum1379[String] = XQJH202000006
@RawMaterialDemandNum1380[String] = XQJH202000007
@RawMaterialDemandNum1381[String] = XQJH202000008
@RawMaterialDemandNum1382[String] = XQJH202000009
@RawMaterialDemandNum1383[String] = XQJH202000010
@RawMaterialDemandNum1384[String] = BCJH202000002
@RawMaterialDemandNum1385[String] = BCJH202000003
@RawMaterialDemandNum1386[String] = BCJH202000004
@RawMaterialDemandNum1387[String] = BCJH202000005
@RawMaterialDemandNum1388[String] = BCJH202000006
@RawMaterialDemandNum1389[String] = BCJH202000007
@RawMaterialDemandNum1390[String] = BCJH202000009
@RawMaterialDemandNum1391[String] = BCJH202000008


-----------------------------------------------------------------------------
2020-03-27 18:37:34
Text:	 SELECT   [TbSupplyList].[SteelsTypeCode] AS [RebarType],[TbSupplyList].[HasSupplierTotal] AS [TotalWeight] FROM [TbSupplyList]  WHERE (([TbSupplyList].[StateCode] <> @StateCode1362) AND ([TbSupplyList].[BatchPlanNum] IN (@BatchPlanNum1392,@BatchPlanNum1393,@BatchPlanNum1394,@BatchPlanNum1395,@BatchPlanNum1396,@BatchPlanNum1397))) 	
Parameters:
@StateCode1362[String] = 未供货
@BatchPlanNum1392[String] = PCJH202000002
@BatchPlanNum1393[String] = PCJH202000003
@BatchPlanNum1394[String] = PCJH202000004
@BatchPlanNum1395[String] = PCJH202000005
@BatchPlanNum1396[String] = PCJH202000006
@BatchPlanNum1397[String] = PCJH202000007


-----------------------------------------------------------------------------
2020-03-27 18:37:34
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE (([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode1398) AND ([TbRawMaterialArchives].[RebarType] = @RebarType1399)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode1398[String] = 6386683729561128960
@RebarType1399[String] = BuildingSteel


-----------------------------------------------------------------------------
2020-03-27 18:37:34
Text:	 SELECT   sum([TbRawMaterialStockRecord].[UseCount]) AS [UseCount],sum([TbRawMaterialStockRecord].[LockCount]) AS [LockCount] FROM [TbRawMaterialStockRecord] LEFT OUTER JOIN [TbStorage] ON ([TbRawMaterialStockRecord].[StorageCode] = [TbStorage].[StorageCode]) LEFT OUTER JOIN [TbRawMaterialArchives] ON ([TbRawMaterialStockRecord].[MaterialCode] = [TbRawMaterialArchives].[MaterialCode])  WHERE (([TbStorage].[ProcessFactoryCode] = @ProcessFactoryCode1400) AND ([TbRawMaterialArchives].[RebarType] = @RebarType1401)) GROUP BY [TbRawMaterialStockRecord].[MaterialCode] 	
Parameters:
@ProcessFactoryCode1400[String] = 6386683729561128960
@RebarType1401[String] = SectionSteel


-----------------------------------------------------------------------------
2020-03-27 18:37:34
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType 
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T 
                                        left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:37:34
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.*,tpc.ProjectId FROM T 
                                     left join TbProjectCompany tpc on T.CompanyCode=tpc.CompanyCode where tpc.ProjectId=@ProjectId and T.OrgType!=1 order by T.id asc;	
Parameters:
@CompanyCode[String] = 6247574415609954304
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-03-27 18:37:34
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE ((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode1402) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus1403)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode1402[String] = 6386683729561128960
@Examinestatus1403[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:37:34
Text:	 SELECT   * FROM [TbRawMaterialMonthDemandSupplyPlan]  WHERE [TbRawMaterialMonthDemandSupplyPlan].[DemandPlanCode] IN (@DemandPlanCode1404,@DemandPlanCode1405,@DemandPlanCode1406,@DemandPlanCode1407,@DemandPlanCode1408,@DemandPlanCode1409,@DemandPlanCode1410,@DemandPlanCode1411,@DemandPlanCode1412) 	
Parameters:
@DemandPlanCode1404[String] = XQJH202000002
@DemandPlanCode1405[String] = XQJH202000003
@DemandPlanCode1406[String] = XQJH202000004
@DemandPlanCode1407[String] = XQJH202000005
@DemandPlanCode1408[String] = XQJH202000006
@DemandPlanCode1409[String] = XQJH202000007
@DemandPlanCode1410[String] = XQJH202000008
@DemandPlanCode1411[String] = XQJH202000009
@DemandPlanCode1412[String] = XQJH202000010


-----------------------------------------------------------------------------
2020-03-27 18:37:34
Text:	 SELECT   [TbSupplyList].[BatchPlanTotal],[TbSupplyList].[HasSupplierTotal],[TbSupplyList].[StateCode],[TbSupplyList].[SteelsTypeCode],[TbSupplyList].[SupplyCompleteTime],[TbSupplyList].[SupplyDate] FROM [TbSupplyList]  WHERE ([TbSupplyList].[RawMaterialDemandNum] IN (@RawMaterialDemandNum1413,@RawMaterialDemandNum1414,@RawMaterialDemandNum1415,@RawMaterialDemandNum1416,@RawMaterialDemandNum1417,@RawMaterialDemandNum1418,@RawMaterialDemandNum1419,@RawMaterialDemandNum1420,@RawMaterialDemandNum1421,@RawMaterialDemandNum1422,@RawMaterialDemandNum1423,@RawMaterialDemandNum1424,@RawMaterialDemandNum1425,@RawMaterialDemandNum1426,@RawMaterialDemandNum1427,@RawMaterialDemandNum1428,@RawMaterialDemandNum1429)) 	
Parameters:
@RawMaterialDemandNum1413[String] = XQJH202000002
@RawMaterialDemandNum1414[String] = XQJH202000003
@RawMaterialDemandNum1415[String] = XQJH202000004
@RawMaterialDemandNum1416[String] = XQJH202000005
@RawMaterialDemandNum1417[String] = XQJH202000006
@RawMaterialDemandNum1418[String] = XQJH202000007
@RawMaterialDemandNum1419[String] = XQJH202000008
@RawMaterialDemandNum1420[String] = XQJH202000009
@RawMaterialDemandNum1421[String] = XQJH202000010
@RawMaterialDemandNum1422[String] = BCJH202000002
@RawMaterialDemandNum1423[String] = BCJH202000003
@RawMaterialDemandNum1424[String] = BCJH202000004
@RawMaterialDemandNum1425[String] = BCJH202000005
@RawMaterialDemandNum1426[String] = BCJH202000006
@RawMaterialDemandNum1427[String] = BCJH202000007
@RawMaterialDemandNum1428[String] = BCJH202000009
@RawMaterialDemandNum1429[String] = BCJH202000008


-----------------------------------------------------------------------------
2020-03-27 18:37:34
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:37:35
Text:	--加急订单个数
                           select wo.OrderCode,wo.DistributionTime,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as ProcessFactoryName from TbWorkOrder wo
                           left join TbCompany cp1 on wo.SiteCode=cp1.CompanyCode
                           left join TbCompany cp2 on wo.ProcessFactoryCode=cp2.CompanyCode
                           where UrgentDegree='Urgent'
                           and YEAR(wo.DistributionTime)= @Year and MONTH(wo.DistributionTime)= @Month  and wo.ProjectId='6245721945602523136' and wo.ProcessFactoryCode='6386683729561128960' and wo.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792')  ORDER BY wo.DistributionTime desc	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:37:35
Text:	 SELECT   [TbWorkOrder].[WeightTotal],[TbWorkOrder].[OrderCode],[TbWorkOrder].[DistributionTime] FROM [TbWorkOrder]  WHERE ((([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode1434) AND (YEAR(DistributionTime)=2020)) AND ([TbWorkOrder].[Examinestatus] = @Examinestatus1435)) 	
Parameters:
@ProcessFactoryCode1434[String] = 6386683729561128960
@Examinestatus1435[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:37:35
Text:	 SELECT   [TbWorkOrderDetail].[WeightSmallPlan],[TbWorkOrderDetail].[FinishTime],[TbWorkOrderDetail].[OrderCode] FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[OrderCode] IN (@OrderCode1436,@OrderCode1437,@OrderCode1438,@OrderCode1439,@OrderCode1440,@OrderCode1441,@OrderCode1442,@OrderCode1443)) AND (YEAR(FinishTime)=2020)) 	
Parameters:
@OrderCode1436[String] = JGDD202000001
@OrderCode1437[String] = JGDD202000002
@OrderCode1438[String] = JGDD202000003
@OrderCode1439[String] = JGDD202000004
@OrderCode1440[String] = JGDD202000005
@OrderCode1441[String] = JGDD202000006
@OrderCode1442[String] = JGDD202000008
@OrderCode1443[String] = JGDD202000009


-----------------------------------------------------------------------------
2020-03-27 18:37:35
Text:	 SELECT   [TbWorkOrder].[OrderCode] FROM [TbWorkOrder]  WHERE (((YEAR(DistributionTime)=2020 and MONTH(DistributionTime)=2) AND ([TbWorkOrder].[ProcessFactoryCode] = @ProcessFactoryCode1430)) AND ([TbWorkOrder].[ProcessingState] IN (@ProcessingState1431,@ProcessingState1432,@ProcessingState1433))) 	
Parameters:
@ProcessFactoryCode1430[String] = 6386683729561128960
@ProcessingState1431[String] = Processing
@ProcessingState1432[String] = Received
@ProcessingState1433[String] = AlreadyReceived


-----------------------------------------------------------------------------
2020-03-27 18:37:35
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (1=2) AND ([TbWorkOrderDetail].[DaetailWorkStrat] = @DaetailWorkStrat1444) 	
Parameters:
@DaetailWorkStrat1444[String] = 未加工


-----------------------------------------------------------------------------
2020-03-27 18:37:35
Text:	 SELECT   [TbOrderProgress].[WeightTotal] AS [TotalWeight] FROM [TbOrderProgress]  WHERE (([TbOrderProgress].[OrderCode] IN (@OrderCode1445,@OrderCode1446,@OrderCode1447,@OrderCode1448,@OrderCode1449,@OrderCode1450,@OrderCode1451,@OrderCode1452,@OrderCode1453,@OrderCode1454,@OrderCode1455)) AND ((([TbOrderProgress].[FinishProcessingDateTime] is not null ) AND ([TbOrderProgress].[DistributionTime] < [TbOrderProgress].[FinishProcessingDateTime])) OR (([TbOrderProgress].[FinishProcessingDateTime] is null ) AND ([TbOrderProgress].[DistributionTime] < @DistributionTime1456)))) 	
Parameters:
@OrderCode1445[String] = JGDD202000001
@OrderCode1446[String] = JGDD202000002
@OrderCode1447[String] = JGDD202000003
@OrderCode1448[String] = JGDD202000004
@OrderCode1449[String] = JGDD202000005
@OrderCode1450[String] = JGDD202000006
@OrderCode1451[String] = JGDD202000008
@OrderCode1452[String] = JGDD202000003
@OrderCode1453[String] = JGDD202000004
@OrderCode1454[String] = JGDD202000004
@OrderCode1455[String] = JGDD202000004
@DistributionTime1456[DateTime] = 2020/3/27 0:00:00


-----------------------------------------------------------------------------
2020-03-27 18:37:35
Text:	 SELECT count(*) as r_cnt FROM [TbDistributionPlanInfo] WHERE (([TbDistributionPlanInfo].[OrderCode] IN (@OrderCode1457,@OrderCode1458,@OrderCode1459,@OrderCode1460,@OrderCode1461,@OrderCode1462,@OrderCode1463)) AND ((DistributionStart='配送完成' and DATEPART(day,DeliveryCompleteTime)>DATEPART(day,DistributionTime)) or (DistributionStart='未配送' and DistributionTime>GETDATE())))	
Parameters:
@OrderCode1457[String] = JGDD202000001
@OrderCode1458[String] = JGDD202000002
@OrderCode1459[String] = JGDD202000003
@OrderCode1460[String] = JGDD202000004
@OrderCode1461[String] = JGDD202000005
@OrderCode1462[String] = JGDD202000006
@OrderCode1463[String] = JGDD202000008


-----------------------------------------------------------------------------
2020-03-27 18:37:35
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:37:35
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:37:35
Text:	--原材料供货超时
                           select BatchPlanNum,cp1.CompanyFullName as BranchName,cp2.CompanyFullName as WorkAreaName,cp3.CompanyFullName as SiteName,cp4.CompanyFullName as ProcessFactoryName,sup.SupplyDate,sup.SupplyCompleteTime,sup.ProjectId,sup.Remarks from TbSupplyList sup
                           left join TbCompany cp1 on cp1.CompanyCode=sup.BranchCode
                           left join TbCompany cp2 on cp2.CompanyCode=sup.WorkAreaCode
                           left join TbCompany cp3 on cp3.CompanyCode=sup.SiteCode
                           left join TbCompany cp4 on cp4.CompanyCode=sup.ProcessFactoryCode
                           where YEAR(sup.SupplyDate)= @Year and MONTH(sup.SupplyDate)= @Month
                           and (sup.SupplyCompleteTime>sup.SupplyDate or (GETDATE()>sup.SupplyDate and sup.SupplyCompleteTime is null))  and sup.ProjectId='6245721945602523136' and sup.ProcessFactoryCode='6386683729561128960' and (sup.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') or sup.WorkAreaCode in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688'))	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:37:35
Text:	 SELECT   [TbRawMaterialMonthDemandPlan].[WorkAreaCode],[TbRawMaterialMonthDemandPlan].[DemandPlanCode],[TbRawMaterialMonthDemandPlan].[RebarType],[TbRawMaterialMonthDemandPlan].[PlanTotal] AS [TotalWeight] FROM [TbRawMaterialMonthDemandPlan]  WHERE ((([TbRawMaterialMonthDemandPlan].[ProcessFactoryCode] = @ProcessFactoryCode1464) AND ([TbRawMaterialMonthDemandPlan].[Examinestatus] = @Examinestatus1465)) AND (YEAR(DeliveryDate)=2020 and MONTH(DeliveryDate)=3)) 	
Parameters:
@ProcessFactoryCode1464[String] = 6386683729561128960
@Examinestatus1465[String] = 审核完成


-----------------------------------------------------------------------------
2020-03-27 18:37:35
Text:	 SELECT   * FROM [TbRawMaterialMonthDemandSupplyPlan]  WHERE [TbRawMaterialMonthDemandSupplyPlan].[DemandPlanCode] IN (@DemandPlanCode1466,@DemandPlanCode1467,@DemandPlanCode1468,@DemandPlanCode1469,@DemandPlanCode1470,@DemandPlanCode1471,@DemandPlanCode1472,@DemandPlanCode1473,@DemandPlanCode1474) 	
Parameters:
@DemandPlanCode1466[String] = XQJH202000002
@DemandPlanCode1467[String] = XQJH202000003
@DemandPlanCode1468[String] = XQJH202000004
@DemandPlanCode1469[String] = XQJH202000005
@DemandPlanCode1470[String] = XQJH202000006
@DemandPlanCode1471[String] = XQJH202000007
@DemandPlanCode1472[String] = XQJH202000008
@DemandPlanCode1473[String] = XQJH202000009
@DemandPlanCode1474[String] = XQJH202000010


-----------------------------------------------------------------------------
2020-03-27 18:37:35
Text:	 SELECT   [TbFactoryBatchNeedPlan].[RawMaterialDemandNum] AS [DemandPlanCode],[TbFactoryBatchNeedPlan].[BatchPlanNum],[TbFactoryBatchNeedPlan].[SteelsTypeCode] AS [RebarType],[TbFactoryBatchNeedPlan].[BatchPlanTotal] AS [TotalWeight] FROM [TbFactoryBatchNeedPlan]  WHERE (([TbFactoryBatchNeedPlan].[Examinestatus] = @Examinestatus1475) AND ([TbFactoryBatchNeedPlan].[RawMaterialDemandNum] IN (@RawMaterialDemandNum1476,@RawMaterialDemandNum1477,@RawMaterialDemandNum1478,@RawMaterialDemandNum1479,@RawMaterialDemandNum1480,@RawMaterialDemandNum1481,@RawMaterialDemandNum1482,@RawMaterialDemandNum1483,@RawMaterialDemandNum1484))) 	
Parameters:
@Examinestatus1475[String] = 审核完成
@RawMaterialDemandNum1476[String] = XQJH202000002
@RawMaterialDemandNum1477[String] = XQJH202000003
@RawMaterialDemandNum1478[String] = XQJH202000004
@RawMaterialDemandNum1479[String] = XQJH202000005
@RawMaterialDemandNum1480[String] = XQJH202000006
@RawMaterialDemandNum1481[String] = XQJH202000007
@RawMaterialDemandNum1482[String] = XQJH202000008
@RawMaterialDemandNum1483[String] = XQJH202000009
@RawMaterialDemandNum1484[String] = XQJH202000010


-----------------------------------------------------------------------------
2020-03-27 18:37:35
Text:	select * from (select cp2.CompanyCode,cp2.CompanyFullName from (select SiteCode from TbWorkOrder where 
            (CONVERT(varchar(7) ,InsertTime, 120)='2020-02' or CONVERT(varchar(7) ,InsertTime, 120)='2020-01' or CONVERT(varchar(7) ,InsertTime, 120)='2020-03') and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId) and (ISNULL(@ProcessFactoryCode,'')='' or ProcessFactoryCode=@ProcessFactoryCode)
            group by SiteCode) TbWO
            left join TbCompany cp on TBWO.SiteCode=cp.CompanyCode
            left join TbCompany cp2 on cp2.CompanyCode=cp.ParentCompanyCode
            group by cp2.CompanyCode,cp2.CompanyFullName
            union all
            select rmdp.WorkAreaCode,cp.CompanyFullName
            from TbRawMaterialMonthDemandPlan rmdp
            left join TbCompany cp on cp.CompanyCode=rmdp.WorkAreaCode
            where (rmdp.DemandMonth='2020-02' or rmdp.DemandMonth='2020-01' or rmdp.DemandMonth='2020-03') and (ISNULL(@ProjectId,'')='' or ProjectId=@ProjectId) and (ISNULL(@ProcessFactoryCode,'')='' or ProcessFactoryCode=@ProcessFactoryCode)) TbGq group by TbGq.CompanyCode,TbGq.CompanyFullName	
Parameters:
@ProjectId[String] = 6245721945602523136
@ProcessFactoryCode[String] = 6386683729561128960


-----------------------------------------------------------------------------
2020-03-27 18:37:35
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-03-27 18:37:36
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-03-27 18:37:36
Text:	SELECT sm.MenuName,fwqi.EWContent,fwqi.EWUserCode,u.UserName,fwqi.EWFormDataCode,cp1.CompanyFullName as  FbName,cp2.CompanyFullName as GqName,fwqi.EWTime,sdd.DictionaryText as RebarType  
                   FROM (  
                    select ret.*
                    FROM ( 
                         SELECT *, row_number()over(partition BY EarlyWarningCode,EWFormDataCode ORDER BY EWNodeCode,EWTime desc) as group_idx 
                         FROM TbFormEarlyWarningNodeInfo fwqi
                         WHERE YEAR(fwqi.EWTime)= @Year and MONTH(fwqi.EWTime)= @Month AND fwqi.MenuCode='RawMonthDemandPlan' AND fwqi.EWStart=0
                    ) ret
                    WHERE ret.group_idx = 1
                   ) fwqi
                    left join TbSysMenu sm on fwqi.MenuCode=sm.MenuCode
                            left join TbCompany cp1 on fwqi.CompanyCode=cp1.CompanyCode
                            left join TbCompany cp2 on fwqi.WorkArea=cp2.CompanyCode
                            left join TbCompany cp3 on fwqi.SiteCode=cp3.CompanyCode
                            left join TbUser u on fwqi.EWUserCode=u.UserId
                            left join TbRawMaterialMonthDemandPlan rmp on fwqi.EWFormDataCode=rmp.ID
                            left join TbSysDictionaryData sdd on sdd.DictionaryCode=rmp.RebarType
                    where 1=1 and fwqi.ProjectId='6245721945602523136' and (fwqi.SiteCode in('6437060915425845248','6374383547544903680','6374384032955899904','6374384202665828352','6285121357168508928','6285122203776188416','6437059163368595456','6285120520983674880','6285120866493661184','6285119541664022528','6285120302351384576','6285181647230861312','6284878460246556672','6284879065547538432','6276140742482067456','6276141050964738048','6276141450283450368','6276141737463250944','6276141926932545536','6308426901824208896','6274028829845487616','6274029086029381632','6274029528142577664','6274029966388625408','6274030152053686272','6274030373047369728','6274030913332445184','6274027775095472128','6274027929433276416','6274028333340557312','6417410523612188672','6267798187931598848','6267798388054425600','6276760608893304832','6267797181319610368','6267796592825204736','6267796864196673536','6267797037211713536','6267793380881727488','6267793585479876608','6437059801301262336','6267790081113718784','6267790783294734336','6267791210027417600','6267791528110850048','6267791338536697856','6267791654132908032','6267791036517449728','6267789807737372672','6267790255894560768','6267790460492709888','6267790574804271104','6267785016667799552','6267785185136214016','6267785381991677952','6267785590951903232','6267785762842869760','6267783175129268224','6267783320914886656','6267783444885929984','6267783577954418688','6267784612617912320','6267749616851091456','6267750471750909952','6267750709144322048','6267750895786655744','6267751010588950528','6267753037104676864','6267754200801738752','6267754324688896000','6267797518566817792') or fwqi.WorkArea in('6437060719774142464','6374290292257988608','6284877407262343168','6284877502225580032','6284877579233001472','6284877692479209472','6276140381243441152','6274025879437836288','6274026095054422016','6267795908742610944','6267796061088120832','6267796277275131904','6267793241479839744','6267788080908861440','6267788261163270144','6267788390918258688','6267788788836073472','6437059457770987520','6267782749348691968','6267782939208056832','6267743715289202688')) ORDER BY fwqi.EWTime DESC	
Parameters:
@Year[String] = 2020
@Month[String] = 3


-----------------------------------------------------------------------------
2020-03-27 18:39:06
Text:	select TbAll.EarlyWarningCode,TbAll.BranchCode,TbAll.BranchName,TbAll.WorkAreaCode,TbAll.WorkAreaName,TbAll.SiteCode,TbAll.SiteName,TbAll.ProjectId,TbAll.YjMonth,TbAll.MenuCode,TbAll.EWNodeCode,TbAll.EWNodeName,TbAll.PersonnelCode,TbAll.PersonnelSource,TbAll.BegEwTiemNew from (select Tb.*,case when Tb.EWTimeType='年' then DATEADD(YEAR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='月' then DATEADD(MONTH,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='天' then DATEADD(DAY,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='时' then DATEADD(HOUR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='分' then DATEADD(MINUTE,Tb.EWTime,Tb.BegEwTiem) end as BegEwTiemNew,TbYjInfo.EarlyWarningCode as YjCode from (select ewt.EarlyWarningCode,DATENAME(year,GETDATE())+'-'+ DATENAME(MONTH,GETDATE())+'-'+ CONVERT(varchar(20),ewt.EWBegDay)+' '+CONVERT(varchar(20),ewt.EWBegHour)+':'+CONVERT(varchar(20),ewt.EWBegMinute)+':00' as BegEwTiem,ewt.BranchCode,cp1.CompanyFullName as BranchName,ewt.WorkAreaCode,cp2.CompanyFullName as WorkAreaName,ewt.SiteCode,cp3.CompanyFullName as SiteName,ewt.ProjectId,MONTH(GETDATE()) as YjMonth,ewt.MenuCode,ewn.EWNodeCode,ewn.EWNodeName,ewn.EWTimeType,ewn.EWTime,ewnp.PersonnelCode,ewnp.PersonnelSource,ewnp.DeptId,ewnp.RoleId from TbFormEarlyWarningBegTime ewt 
left join TbFormEarlyWarningNode ewn on ewt.EarlyWarningCode=ewn.EarlyWarningCode and ewt.ProjectId=ewn.ProjectId and ewt.MenuCode=ewn.MenuCode
left join TbFormEarlyWarningNodePersonnel ewnp on ewn.EarlyWarningCode=ewnp.EarlyWarningCode and ewn.EWNodeCode=ewnp.EWNodeCode and  ewn.MenuCode=ewnp.MenuCode and ewn.ProjectId=ewnp.ProjectId
left join TbCompany cp1 on ewt.BranchCode=cp1.CompanyCode
left join TbCompany cp2 on ewt.WorkAreaCode=cp2.CompanyCode
left join TbCompany cp3 on ewt.SiteCode=cp3.CompanyCode
where ewt.MenuCode='RawMonthDemandPlan') Tb 
left join (select EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId from TbFormEarlyWarningNodeInfo ewni
where ewni.EWFormDataCode=MONTH(GETDATE()) group by EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId) TbYjInfo on Tb.EarlyWarningCode=TbYjInfo.EarlyWarningCode and Tb.EWNodeCode=TbYjInfo.EWNodeCode and Tb.MenuCode=TbYjInfo.MenuCode and  Tb.YjMonth=TbYjInfo.EWFormDataCode and Tb.WorkAreaCode=TbYjInfo.WorkArea and Tb.ProjectId=TbYjInfo.ProjectId
where GETDATE()>=BegEwTiem and Tb.WorkAreaCode not in(select rmdp.WorkAreaCode from TbRawMaterialMonthDemandPlan rmdp where MONTH(InsertTime)=MONTH(GETDATE())
group by rmdp.WorkAreaCode)) TbAll where TbAll.YjCode is null and TbAll.PersonnelCode is not null and GETDATE()>=TbAll.BegEwTiemNew	


-----------------------------------------------------------------------------
2020-03-27 18:44:06
Text:	select TbAll.EarlyWarningCode,TbAll.BranchCode,TbAll.BranchName,TbAll.WorkAreaCode,TbAll.WorkAreaName,TbAll.SiteCode,TbAll.SiteName,TbAll.ProjectId,TbAll.YjMonth,TbAll.MenuCode,TbAll.EWNodeCode,TbAll.EWNodeName,TbAll.PersonnelCode,TbAll.PersonnelSource,TbAll.BegEwTiemNew from (select Tb.*,case when Tb.EWTimeType='年' then DATEADD(YEAR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='月' then DATEADD(MONTH,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='天' then DATEADD(DAY,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='时' then DATEADD(HOUR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='分' then DATEADD(MINUTE,Tb.EWTime,Tb.BegEwTiem) end as BegEwTiemNew,TbYjInfo.EarlyWarningCode as YjCode from (select ewt.EarlyWarningCode,DATENAME(year,GETDATE())+'-'+ DATENAME(MONTH,GETDATE())+'-'+ CONVERT(varchar(20),ewt.EWBegDay)+' '+CONVERT(varchar(20),ewt.EWBegHour)+':'+CONVERT(varchar(20),ewt.EWBegMinute)+':00' as BegEwTiem,ewt.BranchCode,cp1.CompanyFullName as BranchName,ewt.WorkAreaCode,cp2.CompanyFullName as WorkAreaName,ewt.SiteCode,cp3.CompanyFullName as SiteName,ewt.ProjectId,MONTH(GETDATE()) as YjMonth,ewt.MenuCode,ewn.EWNodeCode,ewn.EWNodeName,ewn.EWTimeType,ewn.EWTime,ewnp.PersonnelCode,ewnp.PersonnelSource,ewnp.DeptId,ewnp.RoleId from TbFormEarlyWarningBegTime ewt 
left join TbFormEarlyWarningNode ewn on ewt.EarlyWarningCode=ewn.EarlyWarningCode and ewt.ProjectId=ewn.ProjectId and ewt.MenuCode=ewn.MenuCode
left join TbFormEarlyWarningNodePersonnel ewnp on ewn.EarlyWarningCode=ewnp.EarlyWarningCode and ewn.EWNodeCode=ewnp.EWNodeCode and  ewn.MenuCode=ewnp.MenuCode and ewn.ProjectId=ewnp.ProjectId
left join TbCompany cp1 on ewt.BranchCode=cp1.CompanyCode
left join TbCompany cp2 on ewt.WorkAreaCode=cp2.CompanyCode
left join TbCompany cp3 on ewt.SiteCode=cp3.CompanyCode
where ewt.MenuCode='RawMonthDemandPlan') Tb 
left join (select EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId from TbFormEarlyWarningNodeInfo ewni
where ewni.EWFormDataCode=MONTH(GETDATE()) group by EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId) TbYjInfo on Tb.EarlyWarningCode=TbYjInfo.EarlyWarningCode and Tb.EWNodeCode=TbYjInfo.EWNodeCode and Tb.MenuCode=TbYjInfo.MenuCode and  Tb.YjMonth=TbYjInfo.EWFormDataCode and Tb.WorkAreaCode=TbYjInfo.WorkArea and Tb.ProjectId=TbYjInfo.ProjectId
where GETDATE()>=BegEwTiem and Tb.WorkAreaCode not in(select rmdp.WorkAreaCode from TbRawMaterialMonthDemandPlan rmdp where MONTH(InsertTime)=MONTH(GETDATE())
group by rmdp.WorkAreaCode)) TbAll where TbAll.YjCode is null and TbAll.PersonnelCode is not null and GETDATE()>=TbAll.BegEwTiemNew	


-----------------------------------------------------------------------------
2020-03-27 18:49:06
Text:	select TbAll.EarlyWarningCode,TbAll.BranchCode,TbAll.BranchName,TbAll.WorkAreaCode,TbAll.WorkAreaName,TbAll.SiteCode,TbAll.SiteName,TbAll.ProjectId,TbAll.YjMonth,TbAll.MenuCode,TbAll.EWNodeCode,TbAll.EWNodeName,TbAll.PersonnelCode,TbAll.PersonnelSource,TbAll.BegEwTiemNew from (select Tb.*,case when Tb.EWTimeType='年' then DATEADD(YEAR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='月' then DATEADD(MONTH,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='天' then DATEADD(DAY,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='时' then DATEADD(HOUR,Tb.EWTime,Tb.BegEwTiem) when Tb.EWTimeType='分' then DATEADD(MINUTE,Tb.EWTime,Tb.BegEwTiem) end as BegEwTiemNew,TbYjInfo.EarlyWarningCode as YjCode from (select ewt.EarlyWarningCode,DATENAME(year,GETDATE())+'-'+ DATENAME(MONTH,GETDATE())+'-'+ CONVERT(varchar(20),ewt.EWBegDay)+' '+CONVERT(varchar(20),ewt.EWBegHour)+':'+CONVERT(varchar(20),ewt.EWBegMinute)+':00' as BegEwTiem,ewt.BranchCode,cp1.CompanyFullName as BranchName,ewt.WorkAreaCode,cp2.CompanyFullName as WorkAreaName,ewt.SiteCode,cp3.CompanyFullName as SiteName,ewt.ProjectId,MONTH(GETDATE()) as YjMonth,ewt.MenuCode,ewn.EWNodeCode,ewn.EWNodeName,ewn.EWTimeType,ewn.EWTime,ewnp.PersonnelCode,ewnp.PersonnelSource,ewnp.DeptId,ewnp.RoleId from TbFormEarlyWarningBegTime ewt 
left join TbFormEarlyWarningNode ewn on ewt.EarlyWarningCode=ewn.EarlyWarningCode and ewt.ProjectId=ewn.ProjectId and ewt.MenuCode=ewn.MenuCode
left join TbFormEarlyWarningNodePersonnel ewnp on ewn.EarlyWarningCode=ewnp.EarlyWarningCode and ewn.EWNodeCode=ewnp.EWNodeCode and  ewn.MenuCode=ewnp.MenuCode and ewn.ProjectId=ewnp.ProjectId
left join TbCompany cp1 on ewt.BranchCode=cp1.CompanyCode
left join TbCompany cp2 on ewt.WorkAreaCode=cp2.CompanyCode
left join TbCompany cp3 on ewt.SiteCode=cp3.CompanyCode
where ewt.MenuCode='RawMonthDemandPlan') Tb 
left join (select EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId from TbFormEarlyWarningNodeInfo ewni
where ewni.EWFormDataCode=MONTH(GETDATE()) group by EWFormDataCode,ewni.EWNodeCode,ewni.WorkArea,ewni.EarlyWarningCode,ewni.MenuCode,ewni.ProjectId) TbYjInfo on Tb.EarlyWarningCode=TbYjInfo.EarlyWarningCode and Tb.EWNodeCode=TbYjInfo.EWNodeCode and Tb.MenuCode=TbYjInfo.MenuCode and  Tb.YjMonth=TbYjInfo.EWFormDataCode and Tb.WorkAreaCode=TbYjInfo.WorkArea and Tb.ProjectId=TbYjInfo.ProjectId
where GETDATE()>=BegEwTiem and Tb.WorkAreaCode not in(select rmdp.WorkAreaCode from TbRawMaterialMonthDemandPlan rmdp where MONTH(InsertTime)=MONTH(GETDATE())
group by rmdp.WorkAreaCode)) TbAll where TbAll.YjCode is null and TbAll.PersonnelCode is not null and GETDATE()>=TbAll.BegEwTiemNew	


-----------------------------------------------------------------------------
